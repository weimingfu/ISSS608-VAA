<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Fu Weiming">
<meta name="dcterms.date" content="2024-03-09">

<title>Prototyping Modules for Visual Analytics Shiny Application</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="../../site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/Site_logo.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03a/Hands-on_Ex03a.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03b/Hands-on_Ex03b.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04a/Hands-on_Ex04a.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04b/Hands-on_Ex04b.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04c/Hands-on_Ex04c.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4c</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04d/Hands-on_Ex04d.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4d</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05a/Hands-on_Ex05a.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05b/Hands-on_Ex05b.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05c/Hands-on_Ex05c.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5c</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05d/Hands-on_Ex05d.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5d</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05e/Hands-on_Ex05e.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5e</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07a/Hands-on_Ex07a.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 7a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07b/Hands-on_Ex07b.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 7b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07c/Hands-on_Ex07c.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 7c</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex09.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 9</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex07.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 7</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-Home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html" rel="" target="">
 <span class="dropdown-text">Take-Home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html" rel="" target="">
 <span class="dropdown-text">Take-Home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html" rel="" target="">
 <span class="dropdown-text">Take-Home Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex04/Take-home_Ex04.html" rel="" target="">
 <span class="dropdown-text">Take-Home Exercise 4</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-project" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Project</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-project">    
        <li class="dropdown-header">Coming Soon</li>
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target=""><i class="bi bi-house-door" role="img">
</i> 
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target=""><i class="bi bi-patch-question" role="img">
</i> 
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1 Overview</a>
  <ul class="collapse">
  <li><a href="#setting-the-scene" id="toc-setting-the-scene" class="nav-link" data-scroll-target="#setting-the-scene">1.1 Setting the scene</a></li>
  <li><a href="#the-task" id="toc-the-task" class="nav-link" data-scroll-target="#the-task">1.2 The task</a></li>
  <li><a href="#problem-statement-of-group-project" id="toc-problem-statement-of-group-project" class="nav-link" data-scroll-target="#problem-statement-of-group-project">1.3 Problem statement of group project</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">1.4 The Data</a></li>
  </ul></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">2 Data Preparation</a>
  <ul class="collapse">
  <li><a href="#loading-r-packages" id="toc-loading-r-packages" class="nav-link" data-scroll-target="#loading-r-packages">2.1 <strong>Loading R packages</strong></a></li>
  <li><a href="#importing-data" id="toc-importing-data" class="nav-link" data-scroll-target="#importing-data">2.2 Importing data</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">2.3 Data Wrangling</a></li>
  </ul></li>
  <li><a href="#prototyping" id="toc-prototyping" class="nav-link" data-scroll-target="#prototyping">3 Prototyping</a>
  <ul class="collapse">
  <li><a href="#further-data-wrangling-for-nowcasting-forecasting" id="toc-further-data-wrangling-for-nowcasting-forecasting" class="nav-link" data-scroll-target="#further-data-wrangling-for-nowcasting-forecasting">3.1 Further data wrangling for nowcasting / forecasting</a></li>
  <li><a href="#prototype-of-random-forest-model" id="toc-prototype-of-random-forest-model" class="nav-link" data-scroll-target="#prototype-of-random-forest-model">3.2 Prototype of Random Forest model</a></li>
  <li><a href="#prototype-of-gradient-boost-model" id="toc-prototype-of-gradient-boost-model" class="nav-link" data-scroll-target="#prototype-of-gradient-boost-model">3.3 Prototype of Gradient Boost Model</a></li>
  <li><a href="#prototype-of-prophet-model" id="toc-prototype-of-prophet-model" class="nav-link" data-scroll-target="#prototype-of-prophet-model">3.4 Prototype of Prophet Model</a></li>
  </ul></li>
  <li><a href="#ui-design" id="toc-ui-design" class="nav-link" data-scroll-target="#ui-design">4 UI Design</a>
  <ul class="collapse">
  <li><a href="#storyboard-and-ui-design-for-random-forest-module" id="toc-storyboard-and-ui-design-for-random-forest-module" class="nav-link" data-scroll-target="#storyboard-and-ui-design-for-random-forest-module">4.1 Storyboard and UI Design for Random Forest module</a></li>
  <li><a href="#storyboard-and-ui-design-for-gradient-boost-module" id="toc-storyboard-and-ui-design-for-gradient-boost-module" class="nav-link" data-scroll-target="#storyboard-and-ui-design-for-gradient-boost-module">4.2 Storyboard and UI Design for Gradient Boost module</a></li>
  <li><a href="#storyboard-and-ui-design-for-prophet-module" id="toc-storyboard-and-ui-design-for-prophet-module" class="nav-link" data-scroll-target="#storyboard-and-ui-design-for-prophet-module">4.3 Storyboard and UI Design for Prophet module</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">5 Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Prototyping Modules for Visual Analytics Shiny Application</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li></ul></div></div>
<p class="subtitle lead">Take-home Exercise 4</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Fu Weiming </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 9, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">March 13, 2024</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>1 Overview</h1>
<hr>
<section id="setting-the-scene" class="level2">
<h2 class="anchored" data-anchor-id="setting-the-scene">1.1 Setting the scene</h2>
<p>This exercise serves as a prototype for one of the modules, i.e.&nbsp;the nowcasting / forecasting models, used in the group’s proposed Shiny application for the Visual Analytics Project. Prototyping of the Shiny App has the following benefits:</p>
<ul>
<li>Validate the feasibility and effectiveness of your ideas or analytical approaches</li>
<li>Gather feedback from stakeholders or end-users early in the development process</li>
<li>Iteratively update the prototype, adding new features, improving usability, and refining visualizations until the desired outcome is achieved</li>
<li>Facilitates collaboration among team members or stakeholders</li>
<li>Identify and address potential issues early in the development process</li>
</ul>
</section>
<section id="the-task" class="level2">
<h2 class="anchored" data-anchor-id="the-task">1.2 The task</h2>
<p>As part of this prototyping exercise, the following objectives are fulfilled:</p>
<ul>
<li>Identified and evaluated the necessary R packages in R CRAN</li>
<li>Prepared and tested the R codes for the models</li>
<li>Determined the parameters and outputs that will be exposed on the Shiny applications</li>
<li>Selected the appropriate Shiny UI components for exposing the parameters</li>
</ul>
</section>
<section id="problem-statement-of-group-project" class="level2">
<h2 class="anchored" data-anchor-id="problem-statement-of-group-project">1.3 Problem statement of group project</h2>
<p>Forecasting Singapore’s private housing index is beset with difficulties, arising from the complex interplay among several factors such as economic indicators, employment trends, policy changes, and current market sentiments. The intricacy is further intensified by the delayed nature of crucial indices and indicators, which are commonly released with a substantial time delay, usually spanning from one to three months. These delays impede the capacity to accurately predict private house price changes, as the most up-to-date data required for precise forecasts is not easily accessible.</p>
<p>To tackle this problem, it is necessary to utlilise nowcasting models that can precisely forecast the future direction of the Singapore private housing market. The objective is to utilize these models to provide stakeholders, including homebuyers, sellers, investors, and policy makers, with timely and convenient access to predictive data via visual analytics.</p>
</section>
<section id="the-data" class="level2">
<h2 class="anchored" data-anchor-id="the-data">1.4 The Data</h2>
<p>This study will utilize datasets obtained from official government portals and CEIC, encompassing a range of economic indicators:</p>
<ul>
<li><strong>Singapore Private Residential Property Price Index</strong>: A quarterly index tracking changes from March 1975 to June 2023.</li>
<li><strong>Singapore Domestic Interest Rates</strong>: The daily SORA Index data spanning from Jul 2005 to January 2024.</li>
<li><strong>Straits Times Index (STI)</strong>: Daily STI values from April 1985 to January 2024, reflecting stock market trends.</li>
<li><strong>Prices of Raw Materials</strong>: Monthly indices for cement, steel bars, granite, concreting sand, and ready-mixed concrete, providing insight into construction cost dynamics.</li>
<li><strong>Unemployment Rate</strong>: Quarterly data on the percentage of unemployed individuals from March 1992 to December 2023, offering a measure of labor market health.</li>
</ul>
<p>As SORA rates are only available from Jul 2005 onwards, the period of analysis and modelling of the private residential property price index will be done from 2005 onwards, since we expect interest rates to have an impact on the price index.</p>
</section>
</section>
<section id="data-preparation" class="level1">
<h1>2 Data Preparation</h1>
<hr>
<section id="loading-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="loading-r-packages">2.1 <strong>Loading R packages</strong></h2>
<p>The&nbsp;<code>pacman::p_load()</code>&nbsp;function is used to install and load the required R packages into the R environment, as below.</p>
<ul>
<li><a href="https://www.tidyverse.org/">tidyverse</a>: collection of R packages designed for data science</li>
<li><a href="https://cran.r-project.org/web/packages/randomForest/">randomForest</a>: an R library for classification and regression based on a forest of trees using random inputs</li>
<li><a href="https://plotly.com/r/">plotly</a>: an R graphing library for plotting interactive, publication-quality graphs</li>
<li><a href="https://cran.r-project.org/web/packages/gbm/">gbm</a>: an R library for Freund and Schapire’s AdaBoost algorithm and Friedman’s gradient boosting machine</li>
<li><a href="https://cran.r-project.org/web/packages/prophet/index.html">prophet</a>: an R library that implements a procedure for forecasting time series data based on an additive model developed by Facebook</li>
<li><a href="https://cran.r-project.org/web/packages/knitr/">knitr</a>: an R package for dynamic report generation</li>
<li><a href="https://cran.r-project.org/web/packages/patchwork/">patchwork</a>: an R package for preparing composite figure created using ggplot2</li>
</ul>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, randomForest, plotly, gbm, prophet, knitr, patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="importing-data" class="level2">
<h2 class="anchored" data-anchor-id="importing-data">2.2 Importing data</h2>
<p>The following code chunks uses read_csv to read the time series values of the different datasets listed in 1.4.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ppi <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/PPI_private_housing.csv'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'Date'</span>, <span class="st">'PR_All'</span>, <span class="st">'PR_Landed'</span>, <span class="st">'PR_NL_ALL'</span>, <span class="st">'PR_NL_CCR'</span>, <span class="st">'PR_NL_RCR'</span>, <span class="st">'PR_NL_OCR'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date, <span class="at">format =</span> <span class="st">'%d/%m/%Y'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">year</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Year =</span> Date) <span class="sc">%&gt;%</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.factor</span>(Year))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>material_price <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/Construction Materials prices.csv'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'Date'</span>, <span class="st">'Cement'</span>, <span class="st">'SteelBar'</span>, <span class="st">'Granite'</span>, <span class="st">'ConcretingSand'</span>, <span class="st">'ReadyMixConcrete'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date, <span class="at">format =</span> <span class="st">'%d/%m/%Y'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.factor</span>(Year)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">as.factor</span>(Month))</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>sti <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/Index FTSE Strait Times.csv'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'Date'</span>, <span class="st">'Index'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date, <span class="at">format =</span> <span class="st">'%d/%m/%Y'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">day</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.factor</span>(Year)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">as.factor</span>(Month))</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>tbillbond <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/Treasury_Bill_Bond_ rates.csv'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'Date'</span>, <span class="st">'Bill1Yr'</span>, <span class="st">'Bond2Yr'</span>, <span class="st">'Bond5Yr'</span>, <span class="st">'Bond10Yr'</span>, <span class="st">'Bond15Yr'</span>, <span class="st">'Bond20Yr'</span>,<span class="st">'Bond30Yr'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date, <span class="at">format =</span> <span class="st">'%d/%m/%Y'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">day</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.factor</span>(Year)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">as.factor</span>(Month)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Bond15Yr, <span class="sc">-</span>Bond20Yr, <span class="sc">-</span>Bond30Yr)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>sora <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'data/Singapore Overnight Rate Average SORA Daily.csv'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'Date'</span>, <span class="st">'Rate'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date, <span class="at">format =</span> <span class="st">'%d/%m/%Y'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">day</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.factor</span>(Year)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">as.factor</span>(Month))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling">2.3 Data Wrangling</h2>
<p>The following code chunks are used to compute the change over a (quarterly) period (for SORA and Bond/Bill rates) and percentage change (for the property price indices, STI and prices of raw materials).</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Property Price Index</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Raw material pricess</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Straits Times Index</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Bill and Bond rates</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">SORA rate</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>The code chunk computes percentage change in property price index per quarter.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ppi_quarter <span class="ot">&lt;-</span> ppi <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PCChange_PR_All</span><span class="st">`</span> <span class="ot">=</span> (PR_All <span class="sc">-</span> <span class="fu">lag</span>(PR_All))<span class="sc">/</span><span class="fu">lag</span>(PR_All)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PCChange_PR_Landed</span><span class="st">`</span> <span class="ot">=</span> (PR_Landed <span class="sc">-</span> <span class="fu">lag</span>(PR_Landed))<span class="sc">/</span><span class="fu">lag</span>(PR_Landed)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PCChange_PR_NL_ALL</span><span class="st">`</span> <span class="ot">=</span> (PR_NL_ALL <span class="sc">-</span> <span class="fu">lag</span>(PR_NL_ALL))<span class="sc">/</span><span class="fu">lag</span>(PR_NL_ALL)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PCChange_PR_NL_CCR</span><span class="st">`</span> <span class="ot">=</span> (PR_NL_CCR <span class="sc">-</span> <span class="fu">lag</span>(PR_NL_CCR))<span class="sc">/</span><span class="fu">lag</span>(PR_NL_CCR)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PCChange_PR_NL_RCR</span><span class="st">`</span> <span class="ot">=</span> (PR_NL_RCR <span class="sc">-</span> <span class="fu">lag</span>(PR_NL_RCR))<span class="sc">/</span><span class="fu">lag</span>(PR_NL_RCR)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PCChange_PR_NL_OCR</span><span class="st">`</span> <span class="ot">=</span> (PR_NL_OCR <span class="sc">-</span> <span class="fu">lag</span>(PR_NL_OCR))<span class="sc">/</span><span class="fu">lag</span>(PR_NL_OCR)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    Month <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">'Q1'</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    Month <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">'Q2'</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    Month <span class="sc">==</span> <span class="dv">9</span> <span class="sc">~</span> <span class="st">'Q3'</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    Month <span class="sc">==</span> <span class="dv">12</span> <span class="sc">~</span> <span class="st">'Q4'</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Month) <span class="sc">%&gt;%</span> </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">'Year'</span>,<span class="st">'Quarter'</span>,<span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>The code chunk computes average monthly / quarterly values and percentage change in raw material prices per month / quarter.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># material price_month - percentage change computations</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>material_price_month <span class="ot">&lt;-</span> material_price <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PCChange_Cement</span><span class="st">`</span> <span class="ot">=</span> (Cement <span class="sc">-</span> <span class="fu">lag</span>(Cement))<span class="sc">/</span><span class="fu">lag</span>(Cement)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PCChange_SteelBar</span><span class="st">`</span> <span class="ot">=</span> (SteelBar <span class="sc">-</span> <span class="fu">lag</span>(SteelBar))<span class="sc">/</span><span class="fu">lag</span>(SteelBar)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PCChange_Granite</span><span class="st">`</span> <span class="ot">=</span> (Granite <span class="sc">-</span> <span class="fu">lag</span>(Granite))<span class="sc">/</span><span class="fu">lag</span>(Granite)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PCChange_ConcretingSand</span><span class="st">`</span> <span class="ot">=</span> (ConcretingSand <span class="sc">-</span> <span class="fu">lag</span>(ConcretingSand))<span class="sc">/</span><span class="fu">lag</span>(ConcretingSand)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PCChange_ReadyMixConcrete</span><span class="st">`</span> <span class="ot">=</span> (ReadyMixConcrete <span class="sc">-</span> <span class="fu">lag</span>(ReadyMixConcrete))<span class="sc">/</span><span class="fu">lag</span>(ReadyMixConcrete)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date) <span class="sc">%&gt;%</span> </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Month, <span class="fu">everything</span>())</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># material price_quarter_avg - percentage change computations</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>material_price_quarter_avg <span class="ot">&lt;-</span> material_price <span class="sc">%&gt;%</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">2</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">~</span> <span class="st">'Q1'</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">4</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">5</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">~</span> <span class="st">'Q2'</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">7</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">8</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">9</span>) <span class="sc">~</span> <span class="st">'Q3'</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">10</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">11</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">12</span>) <span class="sc">~</span> <span class="st">'Q4'</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Month) <span class="sc">%&gt;%</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Quarter) <span class="sc">%&gt;%</span> </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span> </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PCChange_Cement</span><span class="st">`</span> <span class="ot">=</span> (Cement <span class="sc">-</span> <span class="fu">lag</span>(Cement))<span class="sc">/</span><span class="fu">lag</span>(Cement)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PCChange_SteelBar</span><span class="st">`</span> <span class="ot">=</span> (SteelBar <span class="sc">-</span> <span class="fu">lag</span>(SteelBar))<span class="sc">/</span><span class="fu">lag</span>(SteelBar)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PCChange_Granite</span><span class="st">`</span> <span class="ot">=</span> (Granite <span class="sc">-</span> <span class="fu">lag</span>(Granite))<span class="sc">/</span><span class="fu">lag</span>(Granite)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PCChange_ConcretingSand</span><span class="st">`</span> <span class="ot">=</span> (ConcretingSand <span class="sc">-</span> <span class="fu">lag</span>(ConcretingSand))<span class="sc">/</span><span class="fu">lag</span>(ConcretingSand)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PCChange_ReadyMixConcrete</span><span class="st">`</span> <span class="ot">=</span> (ReadyMixConcrete <span class="sc">-</span> <span class="fu">lag</span>(ReadyMixConcrete))<span class="sc">/</span><span class="fu">lag</span>(ReadyMixConcrete)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Quarter, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>The code chunk computes average monthly / quarterly values and percentage change in Straits Times Index per month / quarter.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sti_month_avg - percentage change computations</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>sti_month_avg <span class="ot">&lt;-</span> sti <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Month) <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PCChange_Index</span><span class="st">`</span> <span class="ot">=</span> (Index <span class="sc">-</span> <span class="fu">lag</span>(Index))<span class="sc">/</span><span class="fu">lag</span>(Index)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Month, <span class="fu">everything</span>())</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># sti_quarter_avg - percentage change computations</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>sti_quarter_avg <span class="ot">&lt;-</span> sti <span class="sc">%&gt;%</span> </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter =</span> <span class="fu">case_when</span>(</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">2</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">~</span> <span class="st">'Q1'</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">4</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">5</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">~</span> <span class="st">'Q2'</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">7</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">8</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">9</span>) <span class="sc">~</span> <span class="st">'Q3'</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">10</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">11</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">12</span>) <span class="sc">~</span> <span class="st">'Q4'</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Month, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Quarter) <span class="sc">%&gt;%</span> </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span>         </span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PCChange_Index</span><span class="st">`</span> <span class="ot">=</span> (Index <span class="sc">-</span> <span class="fu">lag</span>(Index))<span class="sc">/</span><span class="fu">lag</span>(Index)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Quarter, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p>The code chunk computes average monthly / quarterly values and change in rates per month / quarter.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tbillbond_month - rate change computations</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>tbillbond_month_avg <span class="ot">&lt;-</span> tbillbond <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Month) <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bill1Yr</span><span class="st">`</span> <span class="ot">=</span> Bill1Yr <span class="sc">-</span> <span class="fu">lag</span>(Bill1Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond2Yr</span><span class="st">`</span> <span class="ot">=</span> Bond2Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond2Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond5Yr</span><span class="st">`</span> <span class="ot">=</span> Bond5Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond5Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond10Yr</span><span class="st">`</span> <span class="ot">=</span> Bond10Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond10Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span> </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Month, <span class="fu">everything</span>())</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># tbillbond_quarter_avg - percentage change computations</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>tbillbond_quarter_avg <span class="ot">&lt;-</span> tbillbond <span class="sc">%&gt;%</span> </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter =</span> <span class="fu">case_when</span>(</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">2</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">~</span> <span class="st">'Q1'</span>,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">4</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">5</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">~</span> <span class="st">'Q2'</span>,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">7</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">8</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">9</span>) <span class="sc">~</span> <span class="st">'Q3'</span>,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">10</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">11</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">12</span>) <span class="sc">~</span> <span class="st">'Q4'</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Month, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span> </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Quarter) <span class="sc">%&gt;%</span> </span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bill1Yr</span><span class="st">`</span> <span class="ot">=</span> Bill1Yr <span class="sc">-</span> <span class="fu">lag</span>(Bill1Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond2Yr</span><span class="st">`</span> <span class="ot">=</span> Bond2Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond2Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond5Yr</span><span class="st">`</span> <span class="ot">=</span> Bond5Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond5Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond10Yr</span><span class="st">`</span> <span class="ot">=</span> Bond10Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond10Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Quarter, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<p>The code chunk computes average monthly / quarterly values and change in SORA per month / quarter.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sora_month - percentage change computations</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>sora_month_avg <span class="ot">&lt;-</span> sora <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Month) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Rate</span><span class="st">`</span> <span class="ot">=</span> Rate <span class="sc">-</span> <span class="fu">lag</span>(Rate)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span> </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Month, <span class="fu">everything</span>())</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># sora_quarter_avg - percentage change computations</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>sora_quarter_avg <span class="ot">&lt;-</span> sora <span class="sc">%&gt;%</span> </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">2</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">~</span> <span class="st">'Q1'</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">4</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">5</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">~</span> <span class="st">'Q2'</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">7</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">8</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">9</span>) <span class="sc">~</span> <span class="st">'Q3'</span>,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">10</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">11</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">12</span>) <span class="sc">~</span> <span class="st">'Q4'</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Month, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Quarter) <span class="sc">%&gt;%</span> </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Rate</span><span class="st">`</span> <span class="ot">=</span> Rate <span class="sc">-</span> <span class="fu">lag</span>(Rate)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Quarter, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>The following code chunks combines all the separate datasets into 2 datasets, one for monthly frequency data (excludes property price indices as they are released every quarter), and another for quarterly frequency.&nbsp;These 2 datasets will be used as the datasets for the various modules in the group project.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># put all monthly data into 1 dataset</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>data_by_month <span class="ot">&lt;-</span> material_price_month <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(sti_month_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Month"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(tbillbond_month_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Month"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(sora_month_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Month"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MonthLabel =</span> <span class="fu">paste0</span>(Month, <span class="st">'M'</span>, <span class="fu">as.character</span>(Year))) <span class="sc">%&gt;%</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(<span class="st">'01-'</span>, Month, <span class="st">'-'</span>, Year), <span class="at">format=</span><span class="st">"%d-%m-%Y"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, MonthLabel, <span class="fu">everything</span>(), <span class="sc">-</span>Year, <span class="sc">-</span>Month)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># put all quarter data into 1 dataset</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>data_by_quarter <span class="ot">&lt;-</span> ppi_quarter <span class="sc">%&gt;%</span> </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(material_price_quarter_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Quarter"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(sti_quarter_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Quarter"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(tbillbond_quarter_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Quarter"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(sora_quarter_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Quarter"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">QuarterLabel =</span> <span class="fu">paste0</span>(Quarter, <span class="fu">as.character</span>(Year)))  <span class="sc">%&gt;%</span> </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">paste0</span>(Year, <span class="st">'-'</span>, <span class="fu">ifelse</span>(Quarter <span class="sc">==</span> <span class="st">"Q1"</span>, <span class="st">"03"</span>, </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">ifelse</span>(Quarter <span class="sc">==</span> <span class="st">"Q2"</span>, <span class="st">"06"</span>,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>                                             <span class="fu">ifelse</span>(Quarter <span class="sc">==</span> <span class="st">"Q3"</span>, <span class="st">"09"</span>, <span class="st">"12"</span>))), <span class="st">"-01"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, QuarterLabel, <span class="fu">everything</span>(), <span class="sc">-</span>Year, <span class="sc">-</span>Quarter)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code chunk below provides a summary of the datasets:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Quarterly</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Monthly</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>The code chunk shows a sample of the dataset.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(data_by_quarter, <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 1%">
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 2%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Date</th>
<th style="text-align: left;">QuarterLabel</th>
<th style="text-align: right;">PR_All</th>
<th style="text-align: right;">PR_Landed</th>
<th style="text-align: right;">PR_NL_ALL</th>
<th style="text-align: right;">PR_NL_CCR</th>
<th style="text-align: right;">PR_NL_RCR</th>
<th style="text-align: right;">PR_NL_OCR</th>
<th style="text-align: right;">PCChange_PR_All</th>
<th style="text-align: right;">PCChange_PR_Landed</th>
<th style="text-align: right;">PCChange_PR_NL_ALL</th>
<th style="text-align: right;">PCChange_PR_NL_CCR</th>
<th style="text-align: right;">PCChange_PR_NL_RCR</th>
<th style="text-align: right;">PCChange_PR_NL_OCR</th>
<th style="text-align: right;">Cement</th>
<th style="text-align: right;">SteelBar</th>
<th style="text-align: right;">Granite</th>
<th style="text-align: right;">ConcretingSand</th>
<th style="text-align: right;">ReadyMixConcrete</th>
<th style="text-align: right;">PCChange_Cement</th>
<th style="text-align: right;">PCChange_SteelBar</th>
<th style="text-align: right;">PCChange_Granite</th>
<th style="text-align: right;">PCChange_ConcretingSand</th>
<th style="text-align: right;">PCChange_ReadyMixConcrete</th>
<th style="text-align: right;">Index</th>
<th style="text-align: right;">PCChange_Index</th>
<th style="text-align: right;">Bill1Yr</th>
<th style="text-align: right;">Bond2Yr</th>
<th style="text-align: right;">Bond5Yr</th>
<th style="text-align: right;">Bond10Yr</th>
<th style="text-align: right;">Change_Bill1Yr</th>
<th style="text-align: right;">Change_Bond2Yr</th>
<th style="text-align: right;">Change_Bond5Yr</th>
<th style="text-align: right;">Change_Bond10Yr</th>
<th style="text-align: right;">Rate</th>
<th style="text-align: right;">Change_Rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2005-09-01</td>
<td style="text-align: left;">Q32005</td>
<td style="text-align: right;">83.3</td>
<td style="text-align: right;">84.8</td>
<td style="text-align: right;">83.1</td>
<td style="text-align: right;">79.7</td>
<td style="text-align: right;">94.1</td>
<td style="text-align: right;">83.6</td>
<td style="text-align: right;">1.215067</td>
<td style="text-align: right;">0.8323424</td>
<td style="text-align: right;">1.465202</td>
<td style="text-align: right;">2.310655</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">85.74000</td>
<td style="text-align: right;">725.0000</td>
<td style="text-align: right;">17.16667</td>
<td style="text-align: right;">12.38000</td>
<td style="text-align: right;">72.82000</td>
<td style="text-align: right;">0.3902896</td>
<td style="text-align: right;">-2.874903</td>
<td style="text-align: right;">8.3298275</td>
<td style="text-align: right;">5.033937</td>
<td style="text-align: right;">1.0874092</td>
<td style="text-align: right;">2294.478</td>
<td style="text-align: right;">5.5941065</td>
<td style="text-align: right;">1.986308</td>
<td style="text-align: right;">2.061692</td>
<td style="text-align: right;">2.369385</td>
<td style="text-align: right;">2.777538</td>
<td style="text-align: right;">-0.0382955</td>
<td style="text-align: right;">-0.0006886</td>
<td style="text-align: right;">-0.0588694</td>
<td style="text-align: right;">-0.0496044</td>
<td style="text-align: right;">1.892952</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005-12-01</td>
<td style="text-align: left;">Q42005</td>
<td style="text-align: right;">84.5</td>
<td style="text-align: right;">85.6</td>
<td style="text-align: right;">84.4</td>
<td style="text-align: right;">81.5</td>
<td style="text-align: right;">94.1</td>
<td style="text-align: right;">84.3</td>
<td style="text-align: right;">1.440576</td>
<td style="text-align: right;">0.9433962</td>
<td style="text-align: right;">1.564380</td>
<td style="text-align: right;">2.258469</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.8373206</td>
<td style="text-align: right;">86.11000</td>
<td style="text-align: right;">713.1300</td>
<td style="text-align: right;">16.70000</td>
<td style="text-align: right;">12.62333</td>
<td style="text-align: right;">72.99000</td>
<td style="text-align: right;">0.4315372</td>
<td style="text-align: right;">-1.637241</td>
<td style="text-align: right;">-2.7184466</td>
<td style="text-align: right;">1.965536</td>
<td style="text-align: right;">0.2334523</td>
<td style="text-align: right;">2292.180</td>
<td style="text-align: right;">-0.1001599</td>
<td style="text-align: right;">2.571581</td>
<td style="text-align: right;">2.554839</td>
<td style="text-align: right;">2.938871</td>
<td style="text-align: right;">3.152258</td>
<td style="text-align: right;">0.5852730</td>
<td style="text-align: right;">0.4931464</td>
<td style="text-align: right;">0.5694864</td>
<td style="text-align: right;">0.3747196</td>
<td style="text-align: right;">2.579068</td>
<td style="text-align: right;">0.6861154</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2006-03-01</td>
<td style="text-align: left;">Q12006</td>
<td style="text-align: right;">85.8</td>
<td style="text-align: right;">86.8</td>
<td style="text-align: right;">85.7</td>
<td style="text-align: right;">82.5</td>
<td style="text-align: right;">94.4</td>
<td style="text-align: right;">84.5</td>
<td style="text-align: right;">1.538461</td>
<td style="text-align: right;">1.4018692</td>
<td style="text-align: right;">1.540284</td>
<td style="text-align: right;">1.226994</td>
<td style="text-align: right;">0.3188098</td>
<td style="text-align: right;">0.2372479</td>
<td style="text-align: right;">87.44333</td>
<td style="text-align: right;">690.2100</td>
<td style="text-align: right;">15.92000</td>
<td style="text-align: right;">13.67000</td>
<td style="text-align: right;">72.93333</td>
<td style="text-align: right;">1.5484071</td>
<td style="text-align: right;">-3.214000</td>
<td style="text-align: right;">-4.6706587</td>
<td style="text-align: right;">8.291524</td>
<td style="text-align: right;">-0.0776362</td>
<td style="text-align: right;">2449.376</td>
<td style="text-align: right;">6.8578995</td>
<td style="text-align: right;">2.837705</td>
<td style="text-align: right;">2.846393</td>
<td style="text-align: right;">3.212459</td>
<td style="text-align: right;">3.396557</td>
<td style="text-align: right;">0.2661243</td>
<td style="text-align: right;">0.2915547</td>
<td style="text-align: right;">0.2735880</td>
<td style="text-align: right;">0.2442993</td>
<td style="text-align: right;">3.123131</td>
<td style="text-align: right;">0.5440634</td>
</tr>
<tr class="even">
<td style="text-align: left;">2006-06-01</td>
<td style="text-align: left;">Q22006</td>
<td style="text-align: right;">87.3</td>
<td style="text-align: right;">88.2</td>
<td style="text-align: right;">87.2</td>
<td style="text-align: right;">86.3</td>
<td style="text-align: right;">94.4</td>
<td style="text-align: right;">85.8</td>
<td style="text-align: right;">1.748252</td>
<td style="text-align: right;">1.6129032</td>
<td style="text-align: right;">1.750292</td>
<td style="text-align: right;">4.606061</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.5384615</td>
<td style="text-align: right;">87.89000</td>
<td style="text-align: right;">741.2933</td>
<td style="text-align: right;">15.93667</td>
<td style="text-align: right;">14.17000</td>
<td style="text-align: right;">73.20000</td>
<td style="text-align: right;">0.5108070</td>
<td style="text-align: right;">7.401129</td>
<td style="text-align: right;">0.1046901</td>
<td style="text-align: right;">3.657644</td>
<td style="text-align: right;">0.3656307</td>
<td style="text-align: right;">2479.048</td>
<td style="text-align: right;">1.2114177</td>
<td style="text-align: right;">2.913226</td>
<td style="text-align: right;">2.991613</td>
<td style="text-align: right;">3.255000</td>
<td style="text-align: right;">3.505323</td>
<td style="text-align: right;">0.0755209</td>
<td style="text-align: right;">0.1452195</td>
<td style="text-align: right;">0.0425410</td>
<td style="text-align: right;">0.1087652</td>
<td style="text-align: right;">3.116852</td>
<td style="text-align: right;">-0.0062795</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2006-09-01</td>
<td style="text-align: left;">Q32006</td>
<td style="text-align: right;">89.6</td>
<td style="text-align: right;">89.2</td>
<td style="text-align: right;">90.0</td>
<td style="text-align: right;">90.9</td>
<td style="text-align: right;">94.8</td>
<td style="text-align: right;">86.5</td>
<td style="text-align: right;">2.634593</td>
<td style="text-align: right;">1.1337868</td>
<td style="text-align: right;">3.211009</td>
<td style="text-align: right;">5.330243</td>
<td style="text-align: right;">0.4237288</td>
<td style="text-align: right;">0.8158508</td>
<td style="text-align: right;">88.18667</td>
<td style="text-align: right;">748.6667</td>
<td style="text-align: right;">16.35000</td>
<td style="text-align: right;">14.69333</td>
<td style="text-align: right;">73.90000</td>
<td style="text-align: right;">0.3375431</td>
<td style="text-align: right;">0.994658</td>
<td style="text-align: right;">2.5935997</td>
<td style="text-align: right;">3.693249</td>
<td style="text-align: right;">0.9562842</td>
<td style="text-align: right;">2462.789</td>
<td style="text-align: right;">-0.6558311</td>
<td style="text-align: right;">3.088437</td>
<td style="text-align: right;">3.055625</td>
<td style="text-align: right;">3.281719</td>
<td style="text-align: right;">3.438125</td>
<td style="text-align: right;">0.1752117</td>
<td style="text-align: right;">0.0640121</td>
<td style="text-align: right;">0.0267188</td>
<td style="text-align: right;">-0.0671976</td>
<td style="text-align: right;">3.231783</td>
<td style="text-align: right;">0.1149312</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The code chunk provides a summary of the dataset.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">summary</span>(data_by_quarter))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 0%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Date</th>
<th style="text-align: left;">QuarterLabel</th>
<th style="text-align: left;">PR_All</th>
<th style="text-align: left;">PR_Landed</th>
<th style="text-align: left;">PR_NL_ALL</th>
<th style="text-align: left;">PR_NL_CCR</th>
<th style="text-align: left;">PR_NL_RCR</th>
<th style="text-align: left;">PR_NL_OCR</th>
<th style="text-align: left;">PCChange_PR_All</th>
<th style="text-align: left;">PCChange_PR_Landed</th>
<th style="text-align: left;">PCChange_PR_NL_ALL</th>
<th style="text-align: left;">PCChange_PR_NL_CCR</th>
<th style="text-align: left;">PCChange_PR_NL_RCR</th>
<th style="text-align: left;">PCChange_PR_NL_OCR</th>
<th style="text-align: left;">Cement</th>
<th style="text-align: left;">SteelBar</th>
<th style="text-align: left;">Granite</th>
<th style="text-align: left;">ConcretingSand</th>
<th style="text-align: left;">ReadyMixConcrete</th>
<th style="text-align: left;">PCChange_Cement</th>
<th style="text-align: left;">PCChange_SteelBar</th>
<th style="text-align: left;">PCChange_Granite</th>
<th style="text-align: left;">PCChange_ConcretingSand</th>
<th style="text-align: left;">PCChange_ReadyMixConcrete</th>
<th style="text-align: left;">Index</th>
<th style="text-align: left;">PCChange_Index</th>
<th style="text-align: left;">Bill1Yr</th>
<th style="text-align: left;">Bond2Yr</th>
<th style="text-align: left;">Bond5Yr</th>
<th style="text-align: left;">Bond10Yr</th>
<th style="text-align: left;">Change_Bill1Yr</th>
<th style="text-align: left;">Change_Bond2Yr</th>
<th style="text-align: left;">Change_Bond5Yr</th>
<th style="text-align: left;">Change_Bond10Yr</th>
<th style="text-align: left;">Rate</th>
<th style="text-align: left;">Change_Rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Min. :2005-09-01</td>
<td style="text-align: left;">Length:74</td>
<td style="text-align: left;">Min. : 83.3</td>
<td style="text-align: left;">Min. : 84.8</td>
<td style="text-align: left;">Min. : 83.1</td>
<td style="text-align: left;">Min. : 79.7</td>
<td style="text-align: left;">Min. : 94.1</td>
<td style="text-align: left;">Min. : 83.6</td>
<td style="text-align: left;">Min. :-14.0893</td>
<td style="text-align: left;">Min. :-9.1735</td>
<td style="text-align: left;">Min. :-15.1104</td>
<td style="text-align: left;">Min. :-16.2479</td>
<td style="text-align: left;">Min. :-16.9435</td>
<td style="text-align: left;">Min. :-7.3216</td>
<td style="text-align: left;">Min. : 75.37</td>
<td style="text-align: left;">Min. : 416.2</td>
<td style="text-align: left;">Min. :14.83</td>
<td style="text-align: left;">Min. :12.38</td>
<td style="text-align: left;">Min. : 72.82</td>
<td style="text-align: left;">Min. :-8.2837</td>
<td style="text-align: left;">Min. :-32.9593</td>
<td style="text-align: left;">Min. :-41.6501</td>
<td style="text-align: left;">Min. :-20.8906</td>
<td style="text-align: left;">Min. :-19.4708</td>
<td style="text-align: left;">Min. :1674</td>
<td style="text-align: left;">Min. :-33.7447</td>
<td style="text-align: left;">Min. :0.2477</td>
<td style="text-align: left;">Min. :0.1787</td>
<td style="text-align: left;">Min. :0.3778</td>
<td style="text-align: left;">Min. :0.8854</td>
<td style="text-align: left;">Min. :-0.99239</td>
<td style="text-align: left;">Min. :-0.89210</td>
<td style="text-align: left;">Min. :-0.825660</td>
<td style="text-align: left;">Min. :-0.686901</td>
<td style="text-align: left;">Min. :0.04001</td>
<td style="text-align: left;">Min. :-0.705511</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">1st Qu.:2010-03-24</td>
<td style="text-align: left;">Class :character</td>
<td style="text-align: left;">1st Qu.:128.1</td>
<td style="text-align: left;">1st Qu.:130.4</td>
<td style="text-align: left;">1st Qu.:129.4</td>
<td style="text-align: left;">1st Qu.:126.6</td>
<td style="text-align: left;">1st Qu.:134.4</td>
<td style="text-align: left;">1st Qu.:127.5</td>
<td style="text-align: left;">1st Qu.: -0.4112</td>
<td style="text-align: left;">1st Qu.:-0.8242</td>
<td style="text-align: left;">1st Qu.: -0.2894</td>
<td style="text-align: left;">1st Qu.: -0.5599</td>
<td style="text-align: left;">1st Qu.: -0.5996</td>
<td style="text-align: left;">1st Qu.:-0.1181</td>
<td style="text-align: left;">1st Qu.: 85.90</td>
<td style="text-align: left;">1st Qu.: 717.2</td>
<td style="text-align: left;">1st Qu.:17.68</td>
<td style="text-align: left;">1st Qu.:21.73</td>
<td style="text-align: left;">1st Qu.: 90.61</td>
<td style="text-align: left;">1st Qu.:-1.0824</td>
<td style="text-align: left;">1st Qu.: -3.6214</td>
<td style="text-align: left;">1st Qu.: -3.6486</td>
<td style="text-align: left;">1st Qu.: -2.9350</td>
<td style="text-align: left;">1st Qu.: -1.5607</td>
<td style="text-align: left;">1st Qu.:2839</td>
<td style="text-align: left;">1st Qu.: -1.5478</td>
<td style="text-align: left;">1st Qu.:0.3574</td>
<td style="text-align: left;">1st Qu.:0.4398</td>
<td style="text-align: left;">1st Qu.:1.0908</td>
<td style="text-align: left;">1st Qu.:1.8475</td>
<td style="text-align: left;">1st Qu.:-0.06383</td>
<td style="text-align: left;">1st Qu.:-0.07722</td>
<td style="text-align: left;">1st Qu.:-0.108647</td>
<td style="text-align: left;">1st Qu.:-0.165335</td>
<td style="text-align: left;">1st Qu.:0.11305</td>
<td style="text-align: left;">1st Qu.:-0.035194</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Median :2014-10-16</td>
<td style="text-align: left;">Mode :character</td>
<td style="text-align: left;">Median :146.2</td>
<td style="text-align: left;">Median :164.3</td>
<td style="text-align: left;">Median :140.9</td>
<td style="text-align: left;">Median :132.7</td>
<td style="text-align: left;">Median :147.4</td>
<td style="text-align: left;">Median :158.1</td>
<td style="text-align: left;">Median : 0.7929</td>
<td style="text-align: left;">Median : 0.9589</td>
<td style="text-align: left;">Median : 0.7262</td>
<td style="text-align: left;">Median : 0.6098</td>
<td style="text-align: left;">Median : 0.4096</td>
<td style="text-align: left;">Median : 1.0051</td>
<td style="text-align: left;">Median : 93.42</td>
<td style="text-align: left;">Median : 774.1</td>
<td style="text-align: left;">Median :19.45</td>
<td style="text-align: left;">Median :23.82</td>
<td style="text-align: left;">Median :101.28</td>
<td style="text-align: left;">Median : 0.2793</td>
<td style="text-align: left;">Median : -1.0407</td>
<td style="text-align: left;">Median : 0.1429</td>
<td style="text-align: left;">Median : -0.2193</td>
<td style="text-align: left;">Median : -0.1701</td>
<td style="text-align: left;">Median :3118</td>
<td style="text-align: left;">Median : 1.1822</td>
<td style="text-align: left;">Median :0.9521</td>
<td style="text-align: left;">Median :1.0306</td>
<td style="text-align: left;">Median :1.5938</td>
<td style="text-align: left;">Median :2.3358</td>
<td style="text-align: left;">Median : 0.01834</td>
<td style="text-align: left;">Median : 0.01397</td>
<td style="text-align: left;">Median :-0.005920</td>
<td style="text-align: left;">Median :-0.035819</td>
<td style="text-align: left;">Median :0.23987</td>
<td style="text-align: left;">Median : 0.007276</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Mean :2014-10-16</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Mean :141.6</td>
<td style="text-align: left;">Mean :156.2</td>
<td style="text-align: left;">Mean :138.2</td>
<td style="text-align: left;">Mean :128.0</td>
<td style="text-align: left;">Mean :145.6</td>
<td style="text-align: left;">Mean :154.0</td>
<td style="text-align: left;">Mean : 1.2792</td>
<td style="text-align: left;">Mean : 1.4486</td>
<td style="text-align: left;">Mean : 1.2393</td>
<td style="text-align: left;">Mean : 0.9463</td>
<td style="text-align: left;">Mean : 1.1859</td>
<td style="text-align: left;">Mean : 1.5301</td>
<td style="text-align: left;">Mean : 95.15</td>
<td style="text-align: left;">Mean : 821.7</td>
<td style="text-align: left;">Mean :20.05</td>
<td style="text-align: left;">Mean :25.02</td>
<td style="text-align: left;">Mean :101.87</td>
<td style="text-align: left;">Mean : 0.4298</td>
<td style="text-align: left;">Mean : 0.6331</td>
<td style="text-align: left;">Mean : 1.0694</td>
<td style="text-align: left;">Mean : 2.1542</td>
<td style="text-align: left;">Mean : 0.9889</td>
<td style="text-align: left;">Mean :3000</td>
<td style="text-align: left;">Mean : 0.8111</td>
<td style="text-align: left;">Mean :1.2597</td>
<td style="text-align: left;">Mean :1.2811</td>
<td style="text-align: left;">Mean :1.6769</td>
<td style="text-align: left;">Mean :2.2965</td>
<td style="text-align: left;">Mean : 0.02373</td>
<td style="text-align: left;">Mean : 0.01914</td>
<td style="text-align: left;">Mean : 0.008438</td>
<td style="text-align: left;">Mean : 0.003687</td>
<td style="text-align: left;">Mean :0.91064</td>
<td style="text-align: left;">Mean : 0.024368</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">3rd Qu.:2019-05-09</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">3rd Qu.:152.8</td>
<td style="text-align: left;">3rd Qu.:175.4</td>
<td style="text-align: left;">3rd Qu.:148.1</td>
<td style="text-align: left;">3rd Qu.:137.9</td>
<td style="text-align: left;">3rd Qu.:154.1</td>
<td style="text-align: left;">3rd Qu.:171.5</td>
<td style="text-align: left;">3rd Qu.: 2.7872</td>
<td style="text-align: left;">3rd Qu.: 3.6142</td>
<td style="text-align: left;">3rd Qu.: 2.4387</td>
<td style="text-align: left;">3rd Qu.: 2.2673</td>
<td style="text-align: left;">3rd Qu.: 2.5677</td>
<td style="text-align: left;">3rd Qu.: 2.1980</td>
<td style="text-align: left;">3rd Qu.:101.22</td>
<td style="text-align: left;">3rd Qu.: 916.2</td>
<td style="text-align: left;">3rd Qu.:21.50</td>
<td style="text-align: left;">3rd Qu.:28.06</td>
<td style="text-align: left;">3rd Qu.:111.22</td>
<td style="text-align: left;">3rd Qu.: 1.8847</td>
<td style="text-align: left;">3rd Qu.: 4.5361</td>
<td style="text-align: left;">3rd Qu.: 3.5446</td>
<td style="text-align: left;">3rd Qu.: 3.4565</td>
<td style="text-align: left;">3rd Qu.: 1.2220</td>
<td style="text-align: left;">3rd Qu.:3240</td>
<td style="text-align: left;">3rd Qu.: 4.1286</td>
<td style="text-align: left;">3rd Qu.:1.9434</td>
<td style="text-align: left;">3rd Qu.:1.9508</td>
<td style="text-align: left;">3rd Qu.:2.2000</td>
<td style="text-align: left;">3rd Qu.:2.7364</td>
<td style="text-align: left;">3rd Qu.: 0.11291</td>
<td style="text-align: left;">3rd Qu.: 0.12024</td>
<td style="text-align: left;">3rd Qu.: 0.164240</td>
<td style="text-align: left;">3rd Qu.: 0.205671</td>
<td style="text-align: left;">3rd Qu.:1.48863</td>
<td style="text-align: left;">3rd Qu.: 0.096097</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Max. :2023-12-01</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Max. :201.5</td>
<td style="text-align: left;">Max. :233.2</td>
<td style="text-align: left;">Max. :194.2</td>
<td style="text-align: left;">Max. :148.1</td>
<td style="text-align: left;">Max. :213.9</td>
<td style="text-align: left;">Max. :248.1</td>
<td style="text-align: left;">Max. : 15.7398</td>
<td style="text-align: left;">Max. :14.9003</td>
<td style="text-align: left;">Max. : 15.9496</td>
<td style="text-align: left;">Max. : 15.1899</td>
<td style="text-align: left;">Max. : 18.5146</td>
<td style="text-align: left;">Max. :16.0696</td>
<td style="text-align: left;">Max. :125.91</td>
<td style="text-align: left;">Max. :1626.9</td>
<td style="text-align: left;">Max. :41.82</td>
<td style="text-align: left;">Max. :57.45</td>
<td style="text-align: left;">Max. :168.80</td>
<td style="text-align: left;">Max. :13.9593</td>
<td style="text-align: left;">Max. : 32.9525</td>
<td style="text-align: left;">Max. :101.2698</td>
<td style="text-align: left;">Max. :115.1042</td>
<td style="text-align: left;">Max. : 61.3151</td>
<td style="text-align: left;">Max. :3600</td>
<td style="text-align: left;">Max. : 27.1185</td>
<td style="text-align: left;">Max. :3.9295</td>
<td style="text-align: left;">Max. :3.5476</td>
<td style="text-align: left;">Max. :3.2817</td>
<td style="text-align: left;">Max. :3.5053</td>
<td style="text-align: left;">Max. : 1.13440</td>
<td style="text-align: left;">Max. : 0.95915</td>
<td style="text-align: left;">Max. : 0.881261</td>
<td style="text-align: left;">Max. : 0.818961</td>
<td style="text-align: left;">Max. :3.67181</td>
<td style="text-align: left;">Max. : 1.269015</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA’s :1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>The code chunk shows a sample of the dataset.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(data_by_month, <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Date</th>
<th style="text-align: left;">MonthLabel</th>
<th style="text-align: right;">Cement</th>
<th style="text-align: right;">SteelBar</th>
<th style="text-align: right;">Granite</th>
<th style="text-align: right;">ConcretingSand</th>
<th style="text-align: right;">ReadyMixConcrete</th>
<th style="text-align: right;">PCChange_Cement</th>
<th style="text-align: right;">PCChange_SteelBar</th>
<th style="text-align: right;">PCChange_Granite</th>
<th style="text-align: right;">PCChange_ConcretingSand</th>
<th style="text-align: right;">PCChange_ReadyMixConcrete</th>
<th style="text-align: right;">Index</th>
<th style="text-align: right;">PCChange_Index</th>
<th style="text-align: right;">Bill1Yr</th>
<th style="text-align: right;">Bond2Yr</th>
<th style="text-align: right;">Bond5Yr</th>
<th style="text-align: right;">Bond10Yr</th>
<th style="text-align: right;">Change_Bill1Yr</th>
<th style="text-align: right;">Change_Bond2Yr</th>
<th style="text-align: right;">Change_Bond5Yr</th>
<th style="text-align: right;">Change_Bond10Yr</th>
<th style="text-align: right;">Rate</th>
<th style="text-align: right;">Change_Rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2005-07-01</td>
<td style="text-align: left;">7M2005</td>
<td style="text-align: right;">85.33</td>
<td style="text-align: right;">717.50</td>
<td style="text-align: right;">17.3</td>
<td style="text-align: right;">12.09</td>
<td style="text-align: right;">72.48</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-1.7970792</td>
<td style="text-align: right;">5.616606</td>
<td style="text-align: right;">2.1114865</td>
<td style="text-align: right;">0.3739094</td>
<td style="text-align: right;">2270.400</td>
<td style="text-align: right;">3.0120877</td>
<td style="text-align: right;">1.921905</td>
<td style="text-align: right;">1.971429</td>
<td style="text-align: right;">2.270952</td>
<td style="text-align: right;">2.671429</td>
<td style="text-align: right;">-0.0903680</td>
<td style="text-align: right;">-0.0349351</td>
<td style="text-align: right;">0.0050433</td>
<td style="text-align: right;">0.0518831</td>
<td style="text-align: right;">1.759686</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005-08-01</td>
<td style="text-align: left;">8M2005</td>
<td style="text-align: right;">85.78</td>
<td style="text-align: right;">727.50</td>
<td style="text-align: right;">17.3</td>
<td style="text-align: right;">12.46</td>
<td style="text-align: right;">72.99</td>
<td style="text-align: right;">0.5273644</td>
<td style="text-align: right;">1.3937282</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">3.0603805</td>
<td style="text-align: right;">0.7036424</td>
<td style="text-align: right;">2308.880</td>
<td style="text-align: right;">1.6948568</td>
<td style="text-align: right;">1.922727</td>
<td style="text-align: right;">2.041818</td>
<td style="text-align: right;">2.345455</td>
<td style="text-align: right;">2.773636</td>
<td style="text-align: right;">0.0008225</td>
<td style="text-align: right;">0.0703896</td>
<td style="text-align: right;">0.0745022</td>
<td style="text-align: right;">0.1022078</td>
<td style="text-align: right;">1.782736</td>
<td style="text-align: right;">0.0230506</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2005-09-01</td>
<td style="text-align: left;">9M2005</td>
<td style="text-align: right;">86.11</td>
<td style="text-align: right;">730.00</td>
<td style="text-align: right;">16.9</td>
<td style="text-align: right;">12.59</td>
<td style="text-align: right;">72.99</td>
<td style="text-align: right;">0.3847051</td>
<td style="text-align: right;">0.3436426</td>
<td style="text-align: right;">-2.312139</td>
<td style="text-align: right;">1.0433387</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">2303.061</td>
<td style="text-align: right;">-0.2519916</td>
<td style="text-align: right;">2.111364</td>
<td style="text-align: right;">2.167727</td>
<td style="text-align: right;">2.487273</td>
<td style="text-align: right;">2.882727</td>
<td style="text-align: right;">0.1886364</td>
<td style="text-align: right;">0.1259091</td>
<td style="text-align: right;">0.1418182</td>
<td style="text-align: right;">0.1090909</td>
<td style="text-align: right;">2.130377</td>
<td style="text-align: right;">0.3476409</td>
</tr>
<tr class="even">
<td style="text-align: left;">2005-10-01</td>
<td style="text-align: left;">10M2005</td>
<td style="text-align: right;">86.11</td>
<td style="text-align: right;">724.38</td>
<td style="text-align: right;">16.7</td>
<td style="text-align: right;">12.59</td>
<td style="text-align: right;">72.99</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-0.7698630</td>
<td style="text-align: right;">-1.183432</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">2273.094</td>
<td style="text-align: right;">-1.3012052</td>
<td style="text-align: right;">2.240476</td>
<td style="text-align: right;">2.304286</td>
<td style="text-align: right;">2.658095</td>
<td style="text-align: right;">2.928095</td>
<td style="text-align: right;">0.1291126</td>
<td style="text-align: right;">0.1365584</td>
<td style="text-align: right;">0.1708225</td>
<td style="text-align: right;">0.0453680</td>
<td style="text-align: right;">2.180767</td>
<td style="text-align: right;">0.0503894</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2005-11-01</td>
<td style="text-align: left;">11M2005</td>
<td style="text-align: right;">86.11</td>
<td style="text-align: right;">713.13</td>
<td style="text-align: right;">16.7</td>
<td style="text-align: right;">12.64</td>
<td style="text-align: right;">72.99</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-1.5530523</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.3971406</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">2276.015</td>
<td style="text-align: right;">0.1285117</td>
<td style="text-align: right;">2.651500</td>
<td style="text-align: right;">2.665500</td>
<td style="text-align: right;">3.075500</td>
<td style="text-align: right;">3.238500</td>
<td style="text-align: right;">0.4110238</td>
<td style="text-align: right;">0.3612143</td>
<td style="text-align: right;">0.4174048</td>
<td style="text-align: right;">0.3104048</td>
<td style="text-align: right;">2.675800</td>
<td style="text-align: right;">0.4950333</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The code chunk provides a summary of the dataset.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">summary</span>(data_by_quarter))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 0%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Date</th>
<th style="text-align: left;">QuarterLabel</th>
<th style="text-align: left;">PR_All</th>
<th style="text-align: left;">PR_Landed</th>
<th style="text-align: left;">PR_NL_ALL</th>
<th style="text-align: left;">PR_NL_CCR</th>
<th style="text-align: left;">PR_NL_RCR</th>
<th style="text-align: left;">PR_NL_OCR</th>
<th style="text-align: left;">PCChange_PR_All</th>
<th style="text-align: left;">PCChange_PR_Landed</th>
<th style="text-align: left;">PCChange_PR_NL_ALL</th>
<th style="text-align: left;">PCChange_PR_NL_CCR</th>
<th style="text-align: left;">PCChange_PR_NL_RCR</th>
<th style="text-align: left;">PCChange_PR_NL_OCR</th>
<th style="text-align: left;">Cement</th>
<th style="text-align: left;">SteelBar</th>
<th style="text-align: left;">Granite</th>
<th style="text-align: left;">ConcretingSand</th>
<th style="text-align: left;">ReadyMixConcrete</th>
<th style="text-align: left;">PCChange_Cement</th>
<th style="text-align: left;">PCChange_SteelBar</th>
<th style="text-align: left;">PCChange_Granite</th>
<th style="text-align: left;">PCChange_ConcretingSand</th>
<th style="text-align: left;">PCChange_ReadyMixConcrete</th>
<th style="text-align: left;">Index</th>
<th style="text-align: left;">PCChange_Index</th>
<th style="text-align: left;">Bill1Yr</th>
<th style="text-align: left;">Bond2Yr</th>
<th style="text-align: left;">Bond5Yr</th>
<th style="text-align: left;">Bond10Yr</th>
<th style="text-align: left;">Change_Bill1Yr</th>
<th style="text-align: left;">Change_Bond2Yr</th>
<th style="text-align: left;">Change_Bond5Yr</th>
<th style="text-align: left;">Change_Bond10Yr</th>
<th style="text-align: left;">Rate</th>
<th style="text-align: left;">Change_Rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Min. :2005-09-01</td>
<td style="text-align: left;">Length:74</td>
<td style="text-align: left;">Min. : 83.3</td>
<td style="text-align: left;">Min. : 84.8</td>
<td style="text-align: left;">Min. : 83.1</td>
<td style="text-align: left;">Min. : 79.7</td>
<td style="text-align: left;">Min. : 94.1</td>
<td style="text-align: left;">Min. : 83.6</td>
<td style="text-align: left;">Min. :-14.0893</td>
<td style="text-align: left;">Min. :-9.1735</td>
<td style="text-align: left;">Min. :-15.1104</td>
<td style="text-align: left;">Min. :-16.2479</td>
<td style="text-align: left;">Min. :-16.9435</td>
<td style="text-align: left;">Min. :-7.3216</td>
<td style="text-align: left;">Min. : 75.37</td>
<td style="text-align: left;">Min. : 416.2</td>
<td style="text-align: left;">Min. :14.83</td>
<td style="text-align: left;">Min. :12.38</td>
<td style="text-align: left;">Min. : 72.82</td>
<td style="text-align: left;">Min. :-8.2837</td>
<td style="text-align: left;">Min. :-32.9593</td>
<td style="text-align: left;">Min. :-41.6501</td>
<td style="text-align: left;">Min. :-20.8906</td>
<td style="text-align: left;">Min. :-19.4708</td>
<td style="text-align: left;">Min. :1674</td>
<td style="text-align: left;">Min. :-33.7447</td>
<td style="text-align: left;">Min. :0.2477</td>
<td style="text-align: left;">Min. :0.1787</td>
<td style="text-align: left;">Min. :0.3778</td>
<td style="text-align: left;">Min. :0.8854</td>
<td style="text-align: left;">Min. :-0.99239</td>
<td style="text-align: left;">Min. :-0.89210</td>
<td style="text-align: left;">Min. :-0.825660</td>
<td style="text-align: left;">Min. :-0.686901</td>
<td style="text-align: left;">Min. :0.04001</td>
<td style="text-align: left;">Min. :-0.705511</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">1st Qu.:2010-03-24</td>
<td style="text-align: left;">Class :character</td>
<td style="text-align: left;">1st Qu.:128.1</td>
<td style="text-align: left;">1st Qu.:130.4</td>
<td style="text-align: left;">1st Qu.:129.4</td>
<td style="text-align: left;">1st Qu.:126.6</td>
<td style="text-align: left;">1st Qu.:134.4</td>
<td style="text-align: left;">1st Qu.:127.5</td>
<td style="text-align: left;">1st Qu.: -0.4112</td>
<td style="text-align: left;">1st Qu.:-0.8242</td>
<td style="text-align: left;">1st Qu.: -0.2894</td>
<td style="text-align: left;">1st Qu.: -0.5599</td>
<td style="text-align: left;">1st Qu.: -0.5996</td>
<td style="text-align: left;">1st Qu.:-0.1181</td>
<td style="text-align: left;">1st Qu.: 85.90</td>
<td style="text-align: left;">1st Qu.: 717.2</td>
<td style="text-align: left;">1st Qu.:17.68</td>
<td style="text-align: left;">1st Qu.:21.73</td>
<td style="text-align: left;">1st Qu.: 90.61</td>
<td style="text-align: left;">1st Qu.:-1.0824</td>
<td style="text-align: left;">1st Qu.: -3.6214</td>
<td style="text-align: left;">1st Qu.: -3.6486</td>
<td style="text-align: left;">1st Qu.: -2.9350</td>
<td style="text-align: left;">1st Qu.: -1.5607</td>
<td style="text-align: left;">1st Qu.:2839</td>
<td style="text-align: left;">1st Qu.: -1.5478</td>
<td style="text-align: left;">1st Qu.:0.3574</td>
<td style="text-align: left;">1st Qu.:0.4398</td>
<td style="text-align: left;">1st Qu.:1.0908</td>
<td style="text-align: left;">1st Qu.:1.8475</td>
<td style="text-align: left;">1st Qu.:-0.06383</td>
<td style="text-align: left;">1st Qu.:-0.07722</td>
<td style="text-align: left;">1st Qu.:-0.108647</td>
<td style="text-align: left;">1st Qu.:-0.165335</td>
<td style="text-align: left;">1st Qu.:0.11305</td>
<td style="text-align: left;">1st Qu.:-0.035194</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Median :2014-10-16</td>
<td style="text-align: left;">Mode :character</td>
<td style="text-align: left;">Median :146.2</td>
<td style="text-align: left;">Median :164.3</td>
<td style="text-align: left;">Median :140.9</td>
<td style="text-align: left;">Median :132.7</td>
<td style="text-align: left;">Median :147.4</td>
<td style="text-align: left;">Median :158.1</td>
<td style="text-align: left;">Median : 0.7929</td>
<td style="text-align: left;">Median : 0.9589</td>
<td style="text-align: left;">Median : 0.7262</td>
<td style="text-align: left;">Median : 0.6098</td>
<td style="text-align: left;">Median : 0.4096</td>
<td style="text-align: left;">Median : 1.0051</td>
<td style="text-align: left;">Median : 93.42</td>
<td style="text-align: left;">Median : 774.1</td>
<td style="text-align: left;">Median :19.45</td>
<td style="text-align: left;">Median :23.82</td>
<td style="text-align: left;">Median :101.28</td>
<td style="text-align: left;">Median : 0.2793</td>
<td style="text-align: left;">Median : -1.0407</td>
<td style="text-align: left;">Median : 0.1429</td>
<td style="text-align: left;">Median : -0.2193</td>
<td style="text-align: left;">Median : -0.1701</td>
<td style="text-align: left;">Median :3118</td>
<td style="text-align: left;">Median : 1.1822</td>
<td style="text-align: left;">Median :0.9521</td>
<td style="text-align: left;">Median :1.0306</td>
<td style="text-align: left;">Median :1.5938</td>
<td style="text-align: left;">Median :2.3358</td>
<td style="text-align: left;">Median : 0.01834</td>
<td style="text-align: left;">Median : 0.01397</td>
<td style="text-align: left;">Median :-0.005920</td>
<td style="text-align: left;">Median :-0.035819</td>
<td style="text-align: left;">Median :0.23987</td>
<td style="text-align: left;">Median : 0.007276</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Mean :2014-10-16</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Mean :141.6</td>
<td style="text-align: left;">Mean :156.2</td>
<td style="text-align: left;">Mean :138.2</td>
<td style="text-align: left;">Mean :128.0</td>
<td style="text-align: left;">Mean :145.6</td>
<td style="text-align: left;">Mean :154.0</td>
<td style="text-align: left;">Mean : 1.2792</td>
<td style="text-align: left;">Mean : 1.4486</td>
<td style="text-align: left;">Mean : 1.2393</td>
<td style="text-align: left;">Mean : 0.9463</td>
<td style="text-align: left;">Mean : 1.1859</td>
<td style="text-align: left;">Mean : 1.5301</td>
<td style="text-align: left;">Mean : 95.15</td>
<td style="text-align: left;">Mean : 821.7</td>
<td style="text-align: left;">Mean :20.05</td>
<td style="text-align: left;">Mean :25.02</td>
<td style="text-align: left;">Mean :101.87</td>
<td style="text-align: left;">Mean : 0.4298</td>
<td style="text-align: left;">Mean : 0.6331</td>
<td style="text-align: left;">Mean : 1.0694</td>
<td style="text-align: left;">Mean : 2.1542</td>
<td style="text-align: left;">Mean : 0.9889</td>
<td style="text-align: left;">Mean :3000</td>
<td style="text-align: left;">Mean : 0.8111</td>
<td style="text-align: left;">Mean :1.2597</td>
<td style="text-align: left;">Mean :1.2811</td>
<td style="text-align: left;">Mean :1.6769</td>
<td style="text-align: left;">Mean :2.2965</td>
<td style="text-align: left;">Mean : 0.02373</td>
<td style="text-align: left;">Mean : 0.01914</td>
<td style="text-align: left;">Mean : 0.008438</td>
<td style="text-align: left;">Mean : 0.003687</td>
<td style="text-align: left;">Mean :0.91064</td>
<td style="text-align: left;">Mean : 0.024368</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">3rd Qu.:2019-05-09</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">3rd Qu.:152.8</td>
<td style="text-align: left;">3rd Qu.:175.4</td>
<td style="text-align: left;">3rd Qu.:148.1</td>
<td style="text-align: left;">3rd Qu.:137.9</td>
<td style="text-align: left;">3rd Qu.:154.1</td>
<td style="text-align: left;">3rd Qu.:171.5</td>
<td style="text-align: left;">3rd Qu.: 2.7872</td>
<td style="text-align: left;">3rd Qu.: 3.6142</td>
<td style="text-align: left;">3rd Qu.: 2.4387</td>
<td style="text-align: left;">3rd Qu.: 2.2673</td>
<td style="text-align: left;">3rd Qu.: 2.5677</td>
<td style="text-align: left;">3rd Qu.: 2.1980</td>
<td style="text-align: left;">3rd Qu.:101.22</td>
<td style="text-align: left;">3rd Qu.: 916.2</td>
<td style="text-align: left;">3rd Qu.:21.50</td>
<td style="text-align: left;">3rd Qu.:28.06</td>
<td style="text-align: left;">3rd Qu.:111.22</td>
<td style="text-align: left;">3rd Qu.: 1.8847</td>
<td style="text-align: left;">3rd Qu.: 4.5361</td>
<td style="text-align: left;">3rd Qu.: 3.5446</td>
<td style="text-align: left;">3rd Qu.: 3.4565</td>
<td style="text-align: left;">3rd Qu.: 1.2220</td>
<td style="text-align: left;">3rd Qu.:3240</td>
<td style="text-align: left;">3rd Qu.: 4.1286</td>
<td style="text-align: left;">3rd Qu.:1.9434</td>
<td style="text-align: left;">3rd Qu.:1.9508</td>
<td style="text-align: left;">3rd Qu.:2.2000</td>
<td style="text-align: left;">3rd Qu.:2.7364</td>
<td style="text-align: left;">3rd Qu.: 0.11291</td>
<td style="text-align: left;">3rd Qu.: 0.12024</td>
<td style="text-align: left;">3rd Qu.: 0.164240</td>
<td style="text-align: left;">3rd Qu.: 0.205671</td>
<td style="text-align: left;">3rd Qu.:1.48863</td>
<td style="text-align: left;">3rd Qu.: 0.096097</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Max. :2023-12-01</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Max. :201.5</td>
<td style="text-align: left;">Max. :233.2</td>
<td style="text-align: left;">Max. :194.2</td>
<td style="text-align: left;">Max. :148.1</td>
<td style="text-align: left;">Max. :213.9</td>
<td style="text-align: left;">Max. :248.1</td>
<td style="text-align: left;">Max. : 15.7398</td>
<td style="text-align: left;">Max. :14.9003</td>
<td style="text-align: left;">Max. : 15.9496</td>
<td style="text-align: left;">Max. : 15.1899</td>
<td style="text-align: left;">Max. : 18.5146</td>
<td style="text-align: left;">Max. :16.0696</td>
<td style="text-align: left;">Max. :125.91</td>
<td style="text-align: left;">Max. :1626.9</td>
<td style="text-align: left;">Max. :41.82</td>
<td style="text-align: left;">Max. :57.45</td>
<td style="text-align: left;">Max. :168.80</td>
<td style="text-align: left;">Max. :13.9593</td>
<td style="text-align: left;">Max. : 32.9525</td>
<td style="text-align: left;">Max. :101.2698</td>
<td style="text-align: left;">Max. :115.1042</td>
<td style="text-align: left;">Max. : 61.3151</td>
<td style="text-align: left;">Max. :3600</td>
<td style="text-align: left;">Max. : 27.1185</td>
<td style="text-align: left;">Max. :3.9295</td>
<td style="text-align: left;">Max. :3.5476</td>
<td style="text-align: left;">Max. :3.2817</td>
<td style="text-align: left;">Max. :3.5053</td>
<td style="text-align: left;">Max. : 1.13440</td>
<td style="text-align: left;">Max. : 0.95915</td>
<td style="text-align: left;">Max. : 0.881261</td>
<td style="text-align: left;">Max. : 0.818961</td>
<td style="text-align: left;">Max. :3.67181</td>
<td style="text-align: left;">Max. : 1.269015</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA’s :1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="prototyping" class="level1">
<h1>3 Prototyping</h1>
<section id="further-data-wrangling-for-nowcasting-forecasting" class="level2">
<h2 class="anchored" data-anchor-id="further-data-wrangling-for-nowcasting-forecasting">3.1 Further data wrangling for nowcasting / forecasting</h2>
<p>The following code chunks splits the dataset according to actual values (i.e.&nbsp;actual indices and rates) or derived values (i.e.&nbsp;the change in values over a time period), and also calculates the time-lagged sequence of the dependent variables (i.e.&nbsp;the respective property price indices for overall and specific segments) for up to 4 periods (i.e.&nbsp;4 quarters or a year).</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The user of the Shiny App will be <strong>allowed to choose which property price index time series to use</strong> for the prediction, as well as whether to use actual values or derived values for the prediction. The different property price index time series that are available are:</p>
<ul>
<li>Private Residential Property Price Index (Overall) - Variable: PR_All</li>
<li>Private Residential Property Price Index (Landed) - Variable: PR_Landed</li>
<li>Private Residential Property Price Index (Non-Landed) - Variable: PR_NL_ALL</li>
<li>Private Residential Property Price Index (Non-landed, Core Central Region) - Variable: PR_NL_CCR</li>
<li>Private Residential Property Price Index (Non-landed, Rest of Central Region) - Variable: PR_NL_RCR</li>
<li>Private Residential Property Price Index (Non-landed, Outside of Central Region) - Variable: PR_NL_OCR</li>
</ul>
</div>
</div>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare dataset for actual values + lagged values (up to 4 lagged periods per dependent variable)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>data_quarter_actual <span class="ot">&lt;-</span> data_by_quarter <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, QuarterLabel, Cement, SteelBar, Granite, ConcretingSand, ReadyMixConcrete, Index, Bill1Yr, Bond2Yr, Bond5Yr, Bond10Yr, Rate, PR_All, PR_Landed, PR_NL_ALL, PR_NL_CCR, PR_NL_RCR, PR_NL_OCR) <span class="sc">%&gt;%</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PR_All_Lag_1 =</span> <span class="fu">lag</span>(PR_All, <span class="dv">1</span>), <span class="at">PR_All_Lag_2 =</span> <span class="fu">lag</span>(PR_All, <span class="dv">2</span>), <span class="at">PR_All_Lag_3 =</span> <span class="fu">lag</span>(PR_All, <span class="dv">3</span>), <span class="at">PR_All_Lag_4 =</span> <span class="fu">lag</span>(PR_All, <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PR_Landed_Lag_1 =</span> <span class="fu">lag</span>(PR_Landed, <span class="dv">1</span>), <span class="at">PR_Landed_Lag_2 =</span> <span class="fu">lag</span>(PR_Landed, <span class="dv">2</span>), <span class="at">PR_Landed_Lag_3 =</span> <span class="fu">lag</span>(PR_Landed, <span class="dv">3</span>), <span class="at">PR_Landed_Lag_4 =</span> <span class="fu">lag</span>(PR_Landed, <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PR_NL_ALL_Lag_1 =</span> <span class="fu">lag</span>(PR_NL_ALL, <span class="dv">1</span>), <span class="at">PR_NL_ALL_Lag_2 =</span> <span class="fu">lag</span>(PR_NL_ALL, <span class="dv">2</span>), <span class="at">PR_NL_ALL_Lag_3 =</span> <span class="fu">lag</span>(PR_NL_ALL, <span class="dv">3</span>), <span class="at">PR_NL_ALL_Lag_4 =</span> <span class="fu">lag</span>(PR_NL_ALL, <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PR_NL_CCR_Lag_1 =</span> <span class="fu">lag</span>(PR_NL_CCR, <span class="dv">1</span>), <span class="at">PR_NL_CCR_Lag_2 =</span> <span class="fu">lag</span>(PR_NL_CCR, <span class="dv">2</span>), <span class="at">PR_NL_CCR_Lag_3 =</span> <span class="fu">lag</span>(PR_NL_CCR, <span class="dv">3</span>), <span class="at">PR_NL_CCR_Lag_4 =</span> <span class="fu">lag</span>(PR_NL_CCR, <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PR_NL_RCR_Lag_1 =</span> <span class="fu">lag</span>(PR_NL_RCR, <span class="dv">1</span>), <span class="at">PR_NL_RCR_Lag_2 =</span> <span class="fu">lag</span>(PR_NL_RCR, <span class="dv">2</span>), <span class="at">PR_NL_RCR_Lag_3 =</span> <span class="fu">lag</span>(PR_NL_RCR, <span class="dv">3</span>), <span class="at">PR_NL_RCR_Lag_4 =</span> <span class="fu">lag</span>(PR_NL_RCR, <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PR_NL_OCR_Lag_1 =</span> <span class="fu">lag</span>(PR_NL_OCR, <span class="dv">1</span>), <span class="at">PR_NL_OCR_Lag_2 =</span> <span class="fu">lag</span>(PR_NL_OCR, <span class="dv">2</span>), <span class="at">PR_NL_OCR_Lag_3 =</span> <span class="fu">lag</span>(PR_NL_OCR, <span class="dv">3</span>), <span class="at">PR_NL_OCR_Lag_4 =</span> <span class="fu">lag</span>(PR_NL_OCR, <span class="dv">4</span>))</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>data_quarter_diff <span class="ot">&lt;-</span> data_by_quarter <span class="sc">%&gt;%</span> </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, QuarterLabel, PCChange_Cement, PCChange_SteelBar, PCChange_Granite, PCChange_ConcretingSand, PCChange_ReadyMixConcrete, PCChange_Index, Change_Bill1Yr, Change_Bond2Yr, Change_Bond5Yr, Change_Bond10Yr, Change_Rate, PCChange_PR_All, PCChange_PR_Landed, PCChange_PR_NL_ALL, PCChange_PR_NL_CCR, PCChange_PR_NL_RCR, PCChange_PR_NL_OCR) <span class="sc">%&gt;%</span> </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">"Date"</span>, <span class="st">"QuarterLabel"</span>, <span class="st">"Cement"</span>, <span class="st">"SteelBar"</span>, <span class="st">"Granite"</span>, <span class="st">"ConcretingSand"</span>, <span class="st">"ReadyMixConcrete"</span>, <span class="st">"Index"</span>, <span class="st">"Bill1Yr"</span>, <span class="st">"Bond2Yr"</span>, <span class="st">"Bond5Yr"</span>, <span class="st">"Bond10Yr"</span>, <span class="st">"Rate"</span>, <span class="st">"PR_All"</span>, <span class="st">"PR_Landed"</span>, <span class="st">"PR_NL_ALL"</span>, <span class="st">"PR_NL_CCR"</span>, <span class="st">"PR_NL_RCR"</span>, <span class="st">"PR_NL_OCR"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PR_All_Lag_1 =</span> <span class="fu">lag</span>(PR_All, <span class="dv">1</span>), <span class="at">PR_All_Lag_2 =</span> <span class="fu">lag</span>(PR_All, <span class="dv">2</span>), <span class="at">PR_All_Lag_3 =</span> <span class="fu">lag</span>(PR_All, <span class="dv">3</span>), <span class="at">PR_All_Lag_4 =</span> <span class="fu">lag</span>(PR_All, <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PR_Landed_Lag_1 =</span> <span class="fu">lag</span>(PR_Landed, <span class="dv">1</span>), <span class="at">PR_Landed_Lag_2 =</span> <span class="fu">lag</span>(PR_Landed, <span class="dv">2</span>), <span class="at">PR_Landed_Lag_3 =</span> <span class="fu">lag</span>(PR_Landed, <span class="dv">3</span>), <span class="at">PR_Landed_Lag_4 =</span> <span class="fu">lag</span>(PR_Landed, <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PR_NL_ALL_Lag_1 =</span> <span class="fu">lag</span>(PR_NL_ALL, <span class="dv">1</span>), <span class="at">PR_NL_ALL_Lag_2 =</span> <span class="fu">lag</span>(PR_NL_ALL, <span class="dv">2</span>), <span class="at">PR_NL_ALL_Lag_3 =</span> <span class="fu">lag</span>(PR_NL_ALL, <span class="dv">3</span>), <span class="at">PR_NL_ALL_Lag_4 =</span> <span class="fu">lag</span>(PR_NL_ALL, <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PR_NL_CCR_Lag_1 =</span> <span class="fu">lag</span>(PR_NL_CCR, <span class="dv">1</span>), <span class="at">PR_NL_CCR_Lag_2 =</span> <span class="fu">lag</span>(PR_NL_CCR, <span class="dv">2</span>), <span class="at">PR_NL_CCR_Lag_3 =</span> <span class="fu">lag</span>(PR_NL_CCR, <span class="dv">3</span>), <span class="at">PR_NL_CCR_Lag_4 =</span> <span class="fu">lag</span>(PR_NL_CCR, <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PR_NL_RCR_Lag_1 =</span> <span class="fu">lag</span>(PR_NL_RCR, <span class="dv">1</span>), <span class="at">PR_NL_RCR_Lag_2 =</span> <span class="fu">lag</span>(PR_NL_RCR, <span class="dv">2</span>), <span class="at">PR_NL_RCR_Lag_3 =</span> <span class="fu">lag</span>(PR_NL_RCR, <span class="dv">3</span>), <span class="at">PR_NL_RCR_Lag_4 =</span> <span class="fu">lag</span>(PR_NL_RCR, <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PR_NL_OCR_Lag_1 =</span> <span class="fu">lag</span>(PR_NL_OCR, <span class="dv">1</span>), <span class="at">PR_NL_OCR_Lag_2 =</span> <span class="fu">lag</span>(PR_NL_OCR, <span class="dv">2</span>), <span class="at">PR_NL_OCR_Lag_3 =</span> <span class="fu">lag</span>(PR_NL_OCR, <span class="dv">3</span>), <span class="at">PR_NL_OCR_Lag_4 =</span> <span class="fu">lag</span>(PR_NL_OCR, <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code chunk below shows the function used to compute index values when percentage change in property price index value is predicted.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>recover_actual <span class="ot">&lt;-</span> <span class="cf">function</span>(predict_diff, start) {</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  index <span class="ot">=</span> start</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(predict_diff)) {</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    index <span class="ot">=</span> (<span class="dv">1</span> <span class="sc">+</span> predict_diff<span class="sc">$</span>Predicted[i]<span class="sc">/</span><span class="dv">100</span>) <span class="sc">*</span> index</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    predict_diff<span class="sc">$</span>Predicted[i] <span class="ot">=</span> index</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(predict_diff)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Functions is a useful way of abstracting portions of similar code functionality that are used by different models.</p>
</div>
</div>
</section>
<section id="prototype-of-random-forest-model" class="level2">
<h2 class="anchored" data-anchor-id="prototype-of-random-forest-model">3.2 Prototype of Random Forest model</h2>
<p>The prototype uses <strong>randomForest()</strong> of the randomForest package to model the property price index using explanatory variable for forecasting, to make predictions on the subsequent periods based on new / unseen data.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Parameters for user inputs
</div>
</div>
<div class="callout-body-container callout-body">
<p>The following will be made available as user inputs:</p>
<ul>
<li>Variables selection
<ul>
<li>Type of data to use for prediction - Select from possible values of ‘actual’ or ’diff.</li>
<li>Forecast from which year - Select from possible values of 2018 to 2022</li>
<li>Explanatory variables - Select from list of explanatory variables (raw material prices, STI, Bond/bill rates, SORA rate)</li>
<li>Which property price index to forecast - Select from a list of property price indices (refer to 3.1 for list)</li>
</ul></li>
<li>Model parameters
<ul>
<li>Number of trees (mtree) - Select from possible values of 100 to 500</li>
<li>Number of variables sampled for each tree (mtry) - Select from possible values of 2 to 8</li>
<li>Maximal size of terminal nodes in each tree (nodesize) - Select from possible values of 1 to 8</li>
</ul></li>
</ul>
</div>
</div>
<p>The code chunk below simulates the user inputs from the Shiny App:</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set random seed to get consistent result</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># choose whether to model actual values or difference across periods ('actual' or 'diff)</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>data_selected <span class="ot">=</span> data_quarter_diff</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>selected <span class="ot">=</span> <span class="st">"diff"</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># this is cutoff value of year for testing data selection                    </span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>cut_off_year <span class="ot">=</span> <span class="dv">2020</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># to do if/case statement in Shiny for switching between different time series</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>data_selected <span class="ot">&lt;-</span> data_selected <span class="sc">%&gt;%</span> </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dependentVariable =</span> PR_All)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>data_actual_temp <span class="ot">&lt;-</span> data_quarter_actual <span class="sc">%&gt;%</span> </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dependentVariable =</span> PR_All) <span class="sc">%&gt;%</span> </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, dependentVariable)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co"># to store explanatory variables - will be user inputs</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>explanatory <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Cement"</span>, <span class="st">"SteelBar"</span>, <span class="st">"Granite"</span>, <span class="st">"ConcretingSand"</span>, <span class="st">"ReadyMixConcrete"</span>, <span class="st">"Index"</span>, <span class="st">"Bill1Yr"</span>, <span class="st">"Bond2Yr"</span>, <span class="st">"Bond5Yr"</span>, <span class="st">"Bond10Yr"</span>, <span class="st">"Rate"</span>, <span class="st">'PR_All_Lag_1'</span>, <span class="st">'PR_All_Lag_2'</span>, <span class="st">'PR_All_Lag_3'</span>, <span class="st">'PR_All_Lag_4'</span>)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co"># to store dependent variable to model</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>dependent <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PR_All"</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="co"># variable for number of trees - user input (values from 100 - 500)</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>ntree <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co"># number of variables sampled for tree (values from 2 - 8)</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>mtry <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="co"># maximal size of terminal nodes in each tree (values from 1 - 8)</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>nodesize <span class="ot">&lt;-</span> <span class="dv">6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code chunk below shows the preparation of the dataset based on user selected inputs, including the partitioning of the dataset into training and testing datasets based on the user selected year to start forecasting from.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># preparing the dataset based on user selected variables</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>ppi_rf_train <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_selected, <span class="fu">as.numeric</span>(<span class="fu">year</span>(Date)) <span class="sc">&lt;</span> cut_off_year) <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>QuarterLabel) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(explanatory), dependentVariable) <span class="sc">%&gt;%</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>ppi_rf_test <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_selected, <span class="fu">as.numeric</span>(<span class="fu">year</span>(Date)) <span class="sc">&gt;=</span> cut_off_year) <span class="sc">%&gt;%</span> </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>QuarterLabel) <span class="sc">%&gt;%</span> </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(explanatory), dependentVariable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code chunk below uses <strong>randomForest()</strong> to create the model using the training dataset with the user selected model parameters.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># specifying the model based on user selected variables for the model</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>rf_model <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(dependentVariable <span class="sc">~</span> ., <span class="at">data =</span> ppi_rf_train, <span class="at">ntree =</span> ntree, <span class="at">mtry =</span> mtry, <span class="at">nodesize =</span> nodesize, <span class="at">importance =</span> T, <span class="at">na.action =</span> na.omit)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The following code chunks uses the trained model for predictions on the test data, and the results are shown as ggploty plots. The result plots provided are:</p>
<ul>
<li>Tab 1:
<ul>
<li>Predicted vs actual values</li>
<li>Residuals</li>
</ul></li>
<li>Tab 2
<ul>
<li>Variable importance</li>
</ul></li>
<li>Tab 3:
<ul>
<li>Predicted time series</li>
</ul></li>
</ul>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using trained model to predict both training and test dataset and calculate RMSE</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>predictions_train <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_model, <span class="at">newdata =</span> ppi_rf_train)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>rmse_train <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((ppi_rf_train<span class="sc">$</span>dependentVariable <span class="sc">-</span> predictions_train)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>mae_train <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(ppi_rf_train<span class="sc">$</span>dependentVariable <span class="sc">-</span> predictions_train))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_model, <span class="at">newdata =</span> ppi_rf_test)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>rmse_test <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((ppi_rf_test<span class="sc">$</span>dependentVariable <span class="sc">-</span> predictions)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>mae_test <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(ppi_rf_test<span class="sc">$</span>dependentVariable <span class="sc">-</span> predictions))</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>printout <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Error =</span> <span class="fu">c</span>(<span class="st">'RMSE'</span>, <span class="st">'MAE'</span>),</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Train =</span> <span class="fu">c</span>(rmse_train, mae_train),</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Test =</span> <span class="fu">c</span>(rmse_test, mae_test))</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Tab 1 - plot actual vs predicted</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Actual =</span> ppi_rf_test<span class="sc">$</span>dependentVariable, <span class="at">Predicted =</span> predictions, <span class="st">"DataPartition"</span> <span class="ot">=</span> <span class="st">"Test"</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>train_test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Actual =</span> ppi_rf_train<span class="sc">$</span>dependentVariable, <span class="at">Predicted =</span> predictions_train, <span class="st">"DataPartition"</span> <span class="ot">=</span> <span class="st">"Train"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(results)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>x_lim_min <span class="ot">&lt;-</span> <span class="fu">floor</span>(train_test[<span class="st">'Actual'</span>] <span class="sc">%&gt;%</span> <span class="fu">min</span>())</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>y_lim_min <span class="ot">&lt;-</span> <span class="fu">floor</span>(train_test[<span class="st">'Predicted'</span>] <span class="sc">%&gt;%</span> <span class="fu">min</span>())</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>x_lim_max <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(train_test[<span class="st">'Actual'</span>] <span class="sc">%&gt;%</span> <span class="fu">max</span>())</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>y_lim_max <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(train_test[<span class="st">'Predicted'</span>] <span class="sc">%&gt;%</span> <span class="fu">max</span>())</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>p1a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> train_test, </span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Actual, </span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> Predicted, </span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> DataPartition)) <span class="sc">+</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span>  <span class="co"># Add a diagonal line for reference</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Actual"</span>, </span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted"</span>, </span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Actual vs. Predicted Values"</span>) <span class="sc">+</span> </span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(x_lim_min, y_lim_min), <span class="fu">max</span>(x_lim_max, y_lim_max))) <span class="sc">+</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(x_lim_min, y_lim_min), <span class="fu">max</span>(x_lim_max, y_lim_max))) <span class="sc">+</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Tab 1 - to plot residuals</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>train_test<span class="sc">$</span>Residuals <span class="ot">&lt;-</span> train_test<span class="sc">$</span>Actual <span class="sc">-</span> train_test<span class="sc">$</span>Predicted</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>p1b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>train_test, <span class="fu">aes</span>(<span class="at">x=</span>Predicted, <span class="at">y=</span>Residuals, <span class="at">colour =</span> DataPartition)) <span class="sc">+</span> </span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">color =</span> <span class="st">'Red'</span>, <span class="at">linetype =</span> <span class="st">'dashed'</span>) <span class="sc">+</span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Residual Plot"</span>) <span class="sc">+</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Tab 3 - to plot time series of index (with forecasting)</span></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (selected <span class="sc">==</span> <span class="st">"diff"</span>) {</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">recover_actual</span>(results, data_actual_temp<span class="sc">$</span>dependentVariable[<span class="fu">nrow</span>(data_actual_temp) <span class="sc">-</span> <span class="fu">nrow</span>(results)])</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> (data_actual_temp<span class="sc">$</span>Date[(<span class="fu">nrow</span>(data_actual_temp) <span class="sc">-</span> <span class="fu">nrow</span>(results) <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="fu">nrow</span>(data_actual_temp))]))</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>p1c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>data_actual_temp,</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> dependentVariable),</span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">"green"</span>,</span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>results,</span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x=</span>Date, <span class="at">y =</span> Predicted, <span class="at">color =</span> DataPartition),</span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">'dotted'</span>,</span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Price Index"</span>,</span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">'Year'</span>,</span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Time Series of Quarterly Price Index (Actual index in green)"</span>) <span class="sc">+</span></span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The prototype plots are:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Tab 1 - Prediction results using model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Tab 2 - Variable Importance</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Tab 3 - Predicted time series</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p1a) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-6f03232d4fcc1d4440a5" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-6f03232d4fcc1d4440a5">{"x":{"data":[{"x":[-16.550000000000001,17.550000000000001],"y":[-16.550000000000001,17.550000000000001],"text":"intercept: 0<br />slope: 1","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.9765625,0.32873109796186722,0.78636959370905446,2.080624187256169,3.3121019108280185,0.80147965474723271,1.1009174311926675,5.0211736237144482,0.69124423963134629,3.4897025171624678,3.8142620232172497,0.42598509052182265,3.2873806998939643,-0.2053388090349105,0.82304526748970908,2.806122448979592],"y":[0.55858919160525911,-1.237175698879003,-0.44810852255107486,0.70511749203444485,1.680807537034702,2.5528022565580741,1.9264416080798086,1.2708560428629128,4.0753172312768235,2.6152771746635208,1.2654380586338136,1.456818609514567,0.19614499753393239,1.0165908959467298,-0.35559792459986278,0.70705409166719091],"text":["Actual:  -0.97656250<br />Predicted:  0.55858919<br />DataPartition: Test","Actual:   0.32873110<br />Predicted: -1.23717570<br />DataPartition: Test","Actual:   0.78636959<br />Predicted: -0.44810852<br />DataPartition: Test","Actual:   2.08062419<br />Predicted:  0.70511749<br />DataPartition: Test","Actual:   3.31210191<br />Predicted:  1.68080754<br />DataPartition: Test","Actual:   0.80147965<br />Predicted:  2.55280226<br />DataPartition: Test","Actual:   1.10091743<br />Predicted:  1.92644161<br />DataPartition: Test","Actual:   5.02117362<br />Predicted:  1.27085604<br />DataPartition: Test","Actual:   0.69124424<br />Predicted:  4.07531723<br />DataPartition: Test","Actual:   3.48970252<br />Predicted:  2.61527717<br />DataPartition: Test","Actual:   3.81426202<br />Predicted:  1.26543806<br />DataPartition: Test","Actual:   0.42598509<br />Predicted:  1.45681861<br />DataPartition: Test","Actual:   3.28738070<br />Predicted:  0.19614500<br />DataPartition: Test","Actual:  -0.20533881<br />Predicted:  1.01659090<br />DataPartition: Test","Actual:   0.82304527<br />Predicted: -0.35559792<br />DataPartition: Test","Actual:   2.80612245<br />Predicted:  0.70705409<br />DataPartition: Test"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":0.5,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Test","legendgroup":"Test","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2.6345933562428376,3.90625,4.8335123523093451,8.1967213114754109,8.3333333333333446,6.7307692307692211,3.7674037674037741,0.1578531965272319,-2.3640661938534278,-6.053268765133172,-14.089347079037806,-4.7000000000000028,15.739769150052465,7.343608340888494,5.6587837837837736,5.2757793764987966,2.8853454821564251,2.7306273062730542,2.2270114942528898,1.9676739283204374,1.3094417643004863,0.27210884353741888,-0.13568521031208755,0.47554347826088122,0.60851926977688009,1.8145161290322502,0.59405940594059781,1.0498687664041957,0.38961038961038591,-0.90556274256145264,-1.2402088772845805,-1.0575016523463467,-0.7348029392117531,-1.0767160161507365,-1.0204081632653061,-0.89347079037801458,-1.3176144244105252,-0.4919184820801244,-0.70621468926553677,-0.42674253200568585,-1.499999999999996,-0.50761421319798194,-0.3644314868804665,-0.07315288953913264,0.7320644216691069,0.79941860465115866,3.8932948810382166,3.4004163775156178,0.46979865771811313,-0.066800267201065008,-0.66844919786096257,1.4804845222072793,1.3262599469496019,0.52356020942407266],"y":[2.0227573940870189,3.2724226753524661,4.4589959955138019,5.4679276622016681,6.9896719498583657,5.854654421212568,3.150768187698866,1.751105890726028,-1.2409734118669724,-5.6037101126745164,-7.0837050327557627,-3.379326928879169,7.9986152878294163,6.1904860889043967,6.2299288319507218,5.2401130711912511,3.2117124260955645,2.8427338288711392,2.1772065948692747,1.7858704148712574,0.59113546996591249,0.63025851473043548,0.03470230406897603,0.4643046833301106,0.49353980332863934,1.3085421607539351,0.70770479615201243,0.78591449691614768,0.48655085134773185,-0.35889804497444489,-0.41921393366553378,-0.84756934421880881,-0.7847300051372883,-0.91795380168899288,-0.7301513344611692,-0.98641290550916405,-1.3190069433704492,-0.90532966391409786,-0.70384339913443073,-0.28769500891967675,-0.98905970938485532,-0.39822573637650455,-0.35516765751112395,-0.018796203208646278,0.32440439330742793,1.1282200130174034,2.4597487430822351,3.0896973209454428,1.2824190336264445,0.4677901293737774,-0.017081938665930475,0.89356711429514157,1.0437737809318903,0.94517227597529374],"text":["Actual:   2.63459336<br />Predicted:  2.02275739<br />DataPartition: Train","Actual:   3.90625000<br />Predicted:  3.27242268<br />DataPartition: Train","Actual:   4.83351235<br />Predicted:  4.45899600<br />DataPartition: Train","Actual:   8.19672131<br />Predicted:  5.46792766<br />DataPartition: Train","Actual:   8.33333333<br />Predicted:  6.98967195<br />DataPartition: Train","Actual:   6.73076923<br />Predicted:  5.85465442<br />DataPartition: Train","Actual:   3.76740377<br />Predicted:  3.15076819<br />DataPartition: Train","Actual:   0.15785320<br />Predicted:  1.75110589<br />DataPartition: Train","Actual:  -2.36406619<br />Predicted: -1.24097341<br />DataPartition: Train","Actual:  -6.05326877<br />Predicted: -5.60371011<br />DataPartition: Train","Actual: -14.08934708<br />Predicted: -7.08370503<br />DataPartition: Train","Actual:  -4.70000000<br />Predicted: -3.37932693<br />DataPartition: Train","Actual:  15.73976915<br />Predicted:  7.99861529<br />DataPartition: Train","Actual:   7.34360834<br />Predicted:  6.19048609<br />DataPartition: Train","Actual:   5.65878378<br />Predicted:  6.22992883<br />DataPartition: Train","Actual:   5.27577938<br />Predicted:  5.24011307<br />DataPartition: Train","Actual:   2.88534548<br />Predicted:  3.21171243<br />DataPartition: Train","Actual:   2.73062731<br />Predicted:  2.84273383<br />DataPartition: Train","Actual:   2.22701149<br />Predicted:  2.17720659<br />DataPartition: Train","Actual:   1.96767393<br />Predicted:  1.78587041<br />DataPartition: Train","Actual:   1.30944176<br />Predicted:  0.59113547<br />DataPartition: Train","Actual:   0.27210884<br />Predicted:  0.63025851<br />DataPartition: Train","Actual:  -0.13568521<br />Predicted:  0.03470230<br />DataPartition: Train","Actual:   0.47554348<br />Predicted:  0.46430468<br />DataPartition: Train","Actual:   0.60851927<br />Predicted:  0.49353980<br />DataPartition: Train","Actual:   1.81451613<br />Predicted:  1.30854216<br />DataPartition: Train","Actual:   0.59405941<br />Predicted:  0.70770480<br />DataPartition: Train","Actual:   1.04986877<br />Predicted:  0.78591450<br />DataPartition: Train","Actual:   0.38961039<br />Predicted:  0.48655085<br />DataPartition: Train","Actual:  -0.90556274<br />Predicted: -0.35889804<br />DataPartition: Train","Actual:  -1.24020888<br />Predicted: -0.41921393<br />DataPartition: Train","Actual:  -1.05750165<br />Predicted: -0.84756934<br />DataPartition: Train","Actual:  -0.73480294<br />Predicted: -0.78473001<br />DataPartition: Train","Actual:  -1.07671602<br />Predicted: -0.91795380<br />DataPartition: Train","Actual:  -1.02040816<br />Predicted: -0.73015133<br />DataPartition: Train","Actual:  -0.89347079<br />Predicted: -0.98641291<br />DataPartition: Train","Actual:  -1.31761442<br />Predicted: -1.31900694<br />DataPartition: Train","Actual:  -0.49191848<br />Predicted: -0.90532966<br />DataPartition: Train","Actual:  -0.70621469<br />Predicted: -0.70384340<br />DataPartition: Train","Actual:  -0.42674253<br />Predicted: -0.28769501<br />DataPartition: Train","Actual:  -1.50000000<br />Predicted: -0.98905971<br />DataPartition: Train","Actual:  -0.50761421<br />Predicted: -0.39822574<br />DataPartition: Train","Actual:  -0.36443149<br />Predicted: -0.35516766<br />DataPartition: Train","Actual:  -0.07315289<br />Predicted: -0.01879620<br />DataPartition: Train","Actual:   0.73206442<br />Predicted:  0.32440439<br />DataPartition: Train","Actual:   0.79941860<br />Predicted:  1.12822001<br />DataPartition: Train","Actual:   3.89329488<br />Predicted:  2.45974874<br />DataPartition: Train","Actual:   3.40041638<br />Predicted:  3.08969732<br />DataPartition: Train","Actual:   0.46979866<br />Predicted:  1.28241903<br />DataPartition: Train","Actual:  -0.06680027<br />Predicted:  0.46779013<br />DataPartition: Train","Actual:  -0.66844920<br />Predicted: -0.01708194<br />DataPartition: Train","Actual:   1.48048452<br />Predicted:  0.89356711<br />DataPartition: Train","Actual:   1.32625995<br />Predicted:  1.04377378<br />DataPartition: Train","Actual:   0.52356021<br />Predicted:  0.94517228<br />DataPartition: Train"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":0.5,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"Train","legendgroup":"Train","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":43.105022831050235},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Actual vs. Predicted Values","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-16.550000000000001,17.550000000000001],"tickmode":"array","ticktext":["-10","0","10"],"tickvals":[-10,0,10],"categoryorder":"array","categoryarray":["-10","0","10"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Actual","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-16.550000000000001,17.550000000000001],"tickmode":"array","ticktext":["-10","0","10"],"tickvals":[-10,0,10],"categoryorder":"array","categoryarray":["-10","0","10"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Predicted","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"DataPartition","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"51dc3f5d37eb":{"intercept":{},"slope":{},"type":"scatter"},"51dc5602156":{"x":{},"y":{},"colour":{}}},"cur_data":"51dc3f5d37eb","visdat":{"51dc3f5d37eb":["function (y) ","x"],"51dc5602156":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p1b)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-7ac5914ba519924d168b" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-7ac5914ba519924d168b">{"x":{"data":[{"x":[0.55858919160525911,-1.237175698879003,-0.44810852255107486,0.70511749203444485,1.680807537034702,2.5528022565580741,1.9264416080798086,1.2708560428629128,4.0753172312768235,2.6152771746635208,1.2654380586338136,1.456818609514567,0.19614499753393239,1.0165908959467298,-0.35559792459986278,0.70705409166719091],"y":[-1.5351516916052592,1.5659067968408702,1.2344781162601293,1.3755066952217243,1.6312943737933165,-1.7513226018108414,-0.82552417688714108,3.7503175808515357,-3.3840729916454775,0.87442534249894699,2.5488239645834359,-1.0308335189927442,3.0912357023600321,-1.2219297049816402,1.1786431920895719,2.0990683573124009],"text":["Predicted:  0.55858919<br />Residuals: -1.535151692<br />DataPartition: Test","Predicted: -1.23717570<br />Residuals:  1.565906797<br />DataPartition: Test","Predicted: -0.44810852<br />Residuals:  1.234478116<br />DataPartition: Test","Predicted:  0.70511749<br />Residuals:  1.375506695<br />DataPartition: Test","Predicted:  1.68080754<br />Residuals:  1.631294374<br />DataPartition: Test","Predicted:  2.55280226<br />Residuals: -1.751322602<br />DataPartition: Test","Predicted:  1.92644161<br />Residuals: -0.825524177<br />DataPartition: Test","Predicted:  1.27085604<br />Residuals:  3.750317581<br />DataPartition: Test","Predicted:  4.07531723<br />Residuals: -3.384072992<br />DataPartition: Test","Predicted:  2.61527717<br />Residuals:  0.874425342<br />DataPartition: Test","Predicted:  1.26543806<br />Residuals:  2.548823965<br />DataPartition: Test","Predicted:  1.45681861<br />Residuals: -1.030833519<br />DataPartition: Test","Predicted:  0.19614500<br />Residuals:  3.091235702<br />DataPartition: Test","Predicted:  1.01659090<br />Residuals: -1.221929705<br />DataPartition: Test","Predicted: -0.35559792<br />Residuals:  1.178643192<br />DataPartition: Test","Predicted:  0.70705409<br />Residuals:  2.099068357<br />DataPartition: Test"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Test","legendgroup":"Test","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2.0227573940870189,3.2724226753524661,4.4589959955138019,5.4679276622016681,6.9896719498583657,5.854654421212568,3.150768187698866,1.751105890726028,-1.2409734118669724,-5.6037101126745164,-7.0837050327557627,-3.379326928879169,7.9986152878294163,6.1904860889043967,6.2299288319507218,5.2401130711912511,3.2117124260955645,2.8427338288711392,2.1772065948692747,1.7858704148712574,0.59113546996591249,0.63025851473043548,0.03470230406897603,0.4643046833301106,0.49353980332863934,1.3085421607539351,0.70770479615201243,0.78591449691614768,0.48655085134773185,-0.35889804497444489,-0.41921393366553378,-0.84756934421880881,-0.7847300051372883,-0.91795380168899288,-0.7301513344611692,-0.98641290550916405,-1.3190069433704492,-0.90532966391409786,-0.70384339913443073,-0.28769500891967675,-0.98905970938485532,-0.39822573637650455,-0.35516765751112395,-0.018796203208646278,0.32440439330742793,1.1282200130174034,2.4597487430822351,3.0896973209454428,1.2824190336264445,0.4677901293737774,-0.017081938665930475,0.89356711429514157,1.0437737809318903,0.94517227597529374],"y":[0.6118359621558187,0.63382732464753389,0.37451635679554318,2.7287936492737428,1.3436613834749789,0.87611480955665311,0.61663557970490812,-1.5932526941987961,-1.1230927819864553,-0.44955865245865567,-7.005642046282043,-1.3206730711208339,7.7411538622230491,1.1531222519840973,-0.57114504816694822,0.035666305307545443,-0.32636694393913945,-0.11210652259808507,0.049804899383615098,0.18180351344918,0.71830629433457382,-0.35814967119301661,-0.17038751438106359,0.011238794930770624,0.11497946644824075,0.50597396827831509,-0.11364539021141462,0.26395426948804801,-0.09694046173734594,-0.54666469758700775,-0.82099494361904668,-0.20993230812753794,0.049927065925535197,-0.15876221446174366,-0.29025682880413695,0.092942115131149472,0.0013925189599239829,0.41341118183397346,-0.0023712901311060408,-0.13904752308600909,-0.51094029061514068,-0.1093884768214774,-0.0092638293693425577,-0.054356686330486362,0.40766002836167897,-0.32880140836624472,1.4335461379559815,0.31071905657017496,-0.81262037590833136,-0.53459039657484242,-0.65136725919503213,0.58691740791213776,0.28248616601771159,-0.42161206655122108],"text":["Predicted:  2.02275739<br />Residuals:  0.611835962<br />DataPartition: Train","Predicted:  3.27242268<br />Residuals:  0.633827325<br />DataPartition: Train","Predicted:  4.45899600<br />Residuals:  0.374516357<br />DataPartition: Train","Predicted:  5.46792766<br />Residuals:  2.728793649<br />DataPartition: Train","Predicted:  6.98967195<br />Residuals:  1.343661383<br />DataPartition: Train","Predicted:  5.85465442<br />Residuals:  0.876114810<br />DataPartition: Train","Predicted:  3.15076819<br />Residuals:  0.616635580<br />DataPartition: Train","Predicted:  1.75110589<br />Residuals: -1.593252694<br />DataPartition: Train","Predicted: -1.24097341<br />Residuals: -1.123092782<br />DataPartition: Train","Predicted: -5.60371011<br />Residuals: -0.449558652<br />DataPartition: Train","Predicted: -7.08370503<br />Residuals: -7.005642046<br />DataPartition: Train","Predicted: -3.37932693<br />Residuals: -1.320673071<br />DataPartition: Train","Predicted:  7.99861529<br />Residuals:  7.741153862<br />DataPartition: Train","Predicted:  6.19048609<br />Residuals:  1.153122252<br />DataPartition: Train","Predicted:  6.22992883<br />Residuals: -0.571145048<br />DataPartition: Train","Predicted:  5.24011307<br />Residuals:  0.035666305<br />DataPartition: Train","Predicted:  3.21171243<br />Residuals: -0.326366944<br />DataPartition: Train","Predicted:  2.84273383<br />Residuals: -0.112106523<br />DataPartition: Train","Predicted:  2.17720659<br />Residuals:  0.049804899<br />DataPartition: Train","Predicted:  1.78587041<br />Residuals:  0.181803513<br />DataPartition: Train","Predicted:  0.59113547<br />Residuals:  0.718306294<br />DataPartition: Train","Predicted:  0.63025851<br />Residuals: -0.358149671<br />DataPartition: Train","Predicted:  0.03470230<br />Residuals: -0.170387514<br />DataPartition: Train","Predicted:  0.46430468<br />Residuals:  0.011238795<br />DataPartition: Train","Predicted:  0.49353980<br />Residuals:  0.114979466<br />DataPartition: Train","Predicted:  1.30854216<br />Residuals:  0.505973968<br />DataPartition: Train","Predicted:  0.70770480<br />Residuals: -0.113645390<br />DataPartition: Train","Predicted:  0.78591450<br />Residuals:  0.263954269<br />DataPartition: Train","Predicted:  0.48655085<br />Residuals: -0.096940462<br />DataPartition: Train","Predicted: -0.35889804<br />Residuals: -0.546664698<br />DataPartition: Train","Predicted: -0.41921393<br />Residuals: -0.820994944<br />DataPartition: Train","Predicted: -0.84756934<br />Residuals: -0.209932308<br />DataPartition: Train","Predicted: -0.78473001<br />Residuals:  0.049927066<br />DataPartition: Train","Predicted: -0.91795380<br />Residuals: -0.158762214<br />DataPartition: Train","Predicted: -0.73015133<br />Residuals: -0.290256829<br />DataPartition: Train","Predicted: -0.98641291<br />Residuals:  0.092942115<br />DataPartition: Train","Predicted: -1.31900694<br />Residuals:  0.001392519<br />DataPartition: Train","Predicted: -0.90532966<br />Residuals:  0.413411182<br />DataPartition: Train","Predicted: -0.70384340<br />Residuals: -0.002371290<br />DataPartition: Train","Predicted: -0.28769501<br />Residuals: -0.139047523<br />DataPartition: Train","Predicted: -0.98905971<br />Residuals: -0.510940291<br />DataPartition: Train","Predicted: -0.39822574<br />Residuals: -0.109388477<br />DataPartition: Train","Predicted: -0.35516766<br />Residuals: -0.009263829<br />DataPartition: Train","Predicted: -0.01879620<br />Residuals: -0.054356686<br />DataPartition: Train","Predicted:  0.32440439<br />Residuals:  0.407660028<br />DataPartition: Train","Predicted:  1.12822001<br />Residuals: -0.328801408<br />DataPartition: Train","Predicted:  2.45974874<br />Residuals:  1.433546138<br />DataPartition: Train","Predicted:  3.08969732<br />Residuals:  0.310719057<br />DataPartition: Train","Predicted:  1.28241903<br />Residuals: -0.812620376<br />DataPartition: Train","Predicted:  0.46779013<br />Residuals: -0.534590397<br />DataPartition: Train","Predicted: -0.01708194<br />Residuals: -0.651367259<br />DataPartition: Train","Predicted:  0.89356711<br />Residuals:  0.586917408<br />DataPartition: Train","Predicted:  1.04377378<br />Residuals:  0.282486166<br />DataPartition: Train","Predicted:  0.94517228<br />Residuals: -0.421612067<br />DataPartition: Train"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"Train","legendgroup":"Train","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-7.8378210487850222,8.7527313038586758],"y":[0,0],"text":"yintercept: 0","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":37.260273972602747},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Residual Plot","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-7.8378210487850222,8.7527313038586758],"tickmode":"array","ticktext":["-4","0","4","8"],"tickvals":[-4,0,4,8],"categoryorder":"array","categoryarray":["-4","0","4","8"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Predicted","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-7.742981841707298,8.4784936576483041],"tickmode":"array","ticktext":["-4","0","4","8"],"tickvals":[-4,0,4,8],"categoryorder":"array","categoryarray":["-4","0","4","8"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Residuals","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"DataPartition","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"51dc619c7473":{"x":{},"y":{},"colour":{},"type":"scatter"},"51dc471752e5":{"yintercept":{}}},"cur_data":"51dc619c7473","visdat":{"51dc619c7473":["function (y) ","x"],"51dc471752e5":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span> (printout)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Error</th>
<th style="text-align: right;">Train</th>
<th style="text-align: right;">Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">RMSE</td>
<td style="text-align: right;">1.5806412</td>
<td style="text-align: right;">2.020507</td>
</tr>
<tr class="even">
<td style="text-align: left;">MAE</td>
<td style="text-align: right;">0.7478208</td>
<td style="text-align: right;">1.818658</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(rf_model) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex04_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p1c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-d2e3e2111d7cc720f316" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-d2e3e2111d7cc720f316">{"x":{"data":[{"x":[13027,13118,13208,13300,13392,13483,13573,13665,13757,13848,13939,14031,14123,14214,14304,14396,14488,14579,14669,14761,14853,14944,15034,15126,15218,15309,15400,15492,15584,15675,15765,15857,15949,16040,16130,16222,16314,16405,16495,16587,16679,16770,16861,16953,17045,17136,17226,17318,17410,17501,17591,17683,17775,17866,17956,18048,18140,18231,18322,18414,18506,18597,18687,18779,18871,18962,19052,19144,19236,19327,19417,19509,19601,19692],"y":[83.299999999999997,84.5,85.799999999999997,87.299999999999997,89.599999999999994,93.099999999999994,97.599999999999994,105.59999999999999,114.40000000000001,122.09999999999999,126.7,126.90000000000001,123.90000000000001,116.40000000000001,100,95.299999999999997,110.3,118.40000000000001,125.09999999999999,131.69999999999999,135.5,139.19999999999999,142.30000000000001,145.09999999999999,147,147.40000000000001,147.19999999999999,147.90000000000001,148.80000000000001,151.5,152.40000000000001,154,154.59999999999999,153.19999999999999,151.30000000000001,149.69999999999999,148.59999999999999,147,145.5,144.19999999999999,142.30000000000001,141.59999999999999,140.59999999999999,140,137.90000000000001,137.19999999999999,136.69999999999999,136.59999999999999,137.59999999999999,138.69999999999999,144.09999999999999,149,149.69999999999999,149.59999999999999,148.59999999999999,150.80000000000001,152.80000000000001,153.59999999999999,152.09999999999999,152.59999999999999,153.80000000000001,157,162.19999999999999,163.5,165.30000000000001,173.59999999999999,174.80000000000001,180.90000000000001,187.80000000000001,188.59999999999999,194.80000000000001,194.40000000000001,196,201.5],"text":["Date: 2005-09-01<br />dependentVariable:  83.3","Date: 2005-12-01<br />dependentVariable:  84.5","Date: 2006-03-01<br />dependentVariable:  85.8","Date: 2006-06-01<br />dependentVariable:  87.3","Date: 2006-09-01<br />dependentVariable:  89.6","Date: 2006-12-01<br />dependentVariable:  93.1","Date: 2007-03-01<br />dependentVariable:  97.6","Date: 2007-06-01<br />dependentVariable: 105.6","Date: 2007-09-01<br />dependentVariable: 114.4","Date: 2007-12-01<br />dependentVariable: 122.1","Date: 2008-03-01<br />dependentVariable: 126.7","Date: 2008-06-01<br />dependentVariable: 126.9","Date: 2008-09-01<br />dependentVariable: 123.9","Date: 2008-12-01<br />dependentVariable: 116.4","Date: 2009-03-01<br />dependentVariable: 100.0","Date: 2009-06-01<br />dependentVariable:  95.3","Date: 2009-09-01<br />dependentVariable: 110.3","Date: 2009-12-01<br />dependentVariable: 118.4","Date: 2010-03-01<br />dependentVariable: 125.1","Date: 2010-06-01<br />dependentVariable: 131.7","Date: 2010-09-01<br />dependentVariable: 135.5","Date: 2010-12-01<br />dependentVariable: 139.2","Date: 2011-03-01<br />dependentVariable: 142.3","Date: 2011-06-01<br />dependentVariable: 145.1","Date: 2011-09-01<br />dependentVariable: 147.0","Date: 2011-12-01<br />dependentVariable: 147.4","Date: 2012-03-01<br />dependentVariable: 147.2","Date: 2012-06-01<br />dependentVariable: 147.9","Date: 2012-09-01<br />dependentVariable: 148.8","Date: 2012-12-01<br />dependentVariable: 151.5","Date: 2013-03-01<br />dependentVariable: 152.4","Date: 2013-06-01<br />dependentVariable: 154.0","Date: 2013-09-01<br />dependentVariable: 154.6","Date: 2013-12-01<br />dependentVariable: 153.2","Date: 2014-03-01<br />dependentVariable: 151.3","Date: 2014-06-01<br />dependentVariable: 149.7","Date: 2014-09-01<br />dependentVariable: 148.6","Date: 2014-12-01<br />dependentVariable: 147.0","Date: 2015-03-01<br />dependentVariable: 145.5","Date: 2015-06-01<br />dependentVariable: 144.2","Date: 2015-09-01<br />dependentVariable: 142.3","Date: 2015-12-01<br />dependentVariable: 141.6","Date: 2016-03-01<br />dependentVariable: 140.6","Date: 2016-06-01<br />dependentVariable: 140.0","Date: 2016-09-01<br />dependentVariable: 137.9","Date: 2016-12-01<br />dependentVariable: 137.2","Date: 2017-03-01<br />dependentVariable: 136.7","Date: 2017-06-01<br />dependentVariable: 136.6","Date: 2017-09-01<br />dependentVariable: 137.6","Date: 2017-12-01<br />dependentVariable: 138.7","Date: 2018-03-01<br />dependentVariable: 144.1","Date: 2018-06-01<br />dependentVariable: 149.0","Date: 2018-09-01<br />dependentVariable: 149.7","Date: 2018-12-01<br />dependentVariable: 149.6","Date: 2019-03-01<br />dependentVariable: 148.6","Date: 2019-06-01<br />dependentVariable: 150.8","Date: 2019-09-01<br />dependentVariable: 152.8","Date: 2019-12-01<br />dependentVariable: 153.6","Date: 2020-03-01<br />dependentVariable: 152.1","Date: 2020-06-01<br />dependentVariable: 152.6","Date: 2020-09-01<br />dependentVariable: 153.8","Date: 2020-12-01<br />dependentVariable: 157.0","Date: 2021-03-01<br />dependentVariable: 162.2","Date: 2021-06-01<br />dependentVariable: 163.5","Date: 2021-09-01<br />dependentVariable: 165.3","Date: 2021-12-01<br />dependentVariable: 173.6","Date: 2022-03-01<br />dependentVariable: 174.8","Date: 2022-06-01<br />dependentVariable: 180.9","Date: 2022-09-01<br />dependentVariable: 187.8","Date: 2022-12-01<br />dependentVariable: 188.6","Date: 2023-03-01<br />dependentVariable: 194.8","Date: 2023-06-01<br />dependentVariable: 194.4","Date: 2023-09-01<br />dependentVariable: 196.0","Date: 2023-12-01<br />dependentVariable: 201.5"],"type":"scatter","mode":"lines","line":{"width":2.6456692913385824,"color":"rgba(0,255,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[18322,18414,18506,18597,18687,18779,18871,18962,19052,19144,19236,19327,19417,19509,19601,19692],"y":[154.45799299830566,152.54707624395439,151.86349979440274,152.93431589546876,155.50484740375225,159.47457865733242,162.5467632948972,164.61249865870849,171.32098018138217,175.80149867147568,178.02615774331315,180.61967593912149,180.97395239803808,182.8137171221515,182.16363533818128,183.45163077536958],"text":["Date: 2020-03-01<br />Predicted: 154.4580<br />DataPartition: Test","Date: 2020-06-01<br />Predicted: 152.5471<br />DataPartition: Test","Date: 2020-09-01<br />Predicted: 151.8635<br />DataPartition: Test","Date: 2020-12-01<br />Predicted: 152.9343<br />DataPartition: Test","Date: 2021-03-01<br />Predicted: 155.5048<br />DataPartition: Test","Date: 2021-06-01<br />Predicted: 159.4746<br />DataPartition: Test","Date: 2021-09-01<br />Predicted: 162.5468<br />DataPartition: Test","Date: 2021-12-01<br />Predicted: 164.6125<br />DataPartition: Test","Date: 2022-03-01<br />Predicted: 171.3210<br />DataPartition: Test","Date: 2022-06-01<br />Predicted: 175.8015<br />DataPartition: Test","Date: 2022-09-01<br />Predicted: 178.0262<br />DataPartition: Test","Date: 2022-12-01<br />Predicted: 180.6197<br />DataPartition: Test","Date: 2023-03-01<br />Predicted: 180.9740<br />DataPartition: Test","Date: 2023-06-01<br />Predicted: 182.8137<br />DataPartition: Test","Date: 2023-09-01<br />Predicted: 182.1636<br />DataPartition: Test","Date: 2023-12-01<br />Predicted: 183.4516<br />DataPartition: Test"],"type":"scatter","mode":"lines","line":{"width":2.6456692913385824,"color":"rgba(248,118,109,1)","dash":"dot"},"hoveron":"points","name":"Test","legendgroup":"Test","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":43.105022831050235},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Time Series of Quarterly Price Index (Actual index in green)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[12693.75,20025.25],"tickmode":"array","ticktext":["2005","2010","2015","2020"],"tickvals":[12784,14610,16436,18262],"categoryorder":"array","categoryarray":["2005","2010","2015","2020"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[77.390000000000001,207.41],"tickmode":"array","ticktext":["100","125","150","175","200"],"tickvals":[100,125,150,175,200],"categoryorder":"array","categoryarray":["100","125","150","175","200"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Price Index","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"DataPartition","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"51dc797f5ba6":{"x":{},"y":{},"type":"scatter"},"51dc65475bd5":{"x":{},"y":{},"colour":{}}},"cur_data":"51dc797f5ba6","visdat":{"51dc797f5ba6":["function (y) ","x"],"51dc65475bd5":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="prototype-of-gradient-boost-model" class="level2">
<h2 class="anchored" data-anchor-id="prototype-of-gradient-boost-model">3.3 Prototype of Gradient Boost Model</h2>
<p>The prototype uses <strong>gbm()</strong> of the gbm package to model the property price index using explanatory variable for forecasting, to make predictions on the subsequent periods based on new / unseen data.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Parameters for user inputs
</div>
</div>
<div class="callout-body-container callout-body">
<p>The following will be made available as user inputs:</p>
<ul>
<li>Variables selection
<ul>
<li>Type of data to use for prediction - Select from possible values of ‘actual’ or ’diff.</li>
<li>Forecast from which year - Select from possible values of 2018 to 2022</li>
<li>Explanatory variables - Select from list of explanatory variables (raw material prices, STI, Bond/bill rates, SORA rate)</li>
<li>Which property price index to forecast - Select from a list of property price indices (refer to 3.1 for list)</li>
</ul></li>
<li>Model parameters
<ul>
<li>Number of trees (n.trees) - Select from possible values of 100 to 500</li>
<li>Learning rate (shrinkage) - Select from possible values of 0.01 to 0.1</li>
<li>Minimum number of observations in terminal node (n.minobsinnode) - Select from possible values of 5 to 10</li>
<li>Fraction of observations sampled for each tree (bag.fraction) - Select from possible values of 0.5 to 1.0</li>
<li>Distribution to use - Select from ‘gaussian’, ‘laplace’ or ‘tdist’ for regression models</li>
</ul></li>
</ul>
</div>
</div>
<p>The code chunk below simulates the user inputs from the Shiny App:</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set random seed to get consistent result</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># choose whether to model actual values or difference across periods</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>data_selected <span class="ot">&lt;-</span> data_quarter_diff</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>selected <span class="ot">=</span> <span class="st">"diff"</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># this is cutoff value of year for training/testing data selection                </span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>cut_off_year <span class="ot">&lt;-</span> <span class="dv">2020</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># to store explanatory variables - will be user inputs</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>explanatory <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Cement"</span>, <span class="st">"SteelBar"</span>, <span class="st">"Granite"</span>, <span class="st">"ConcretingSand"</span>, <span class="st">"ReadyMixConcrete"</span>, <span class="st">"Index"</span>, <span class="st">"Bill1Yr"</span>, <span class="st">"Bond2Yr"</span>, <span class="st">"Bond5Yr"</span>, <span class="st">"Bond10Yr"</span>, <span class="st">"Rate"</span>, <span class="st">'PR_All_Lag_1'</span>, <span class="st">'PR_All_Lag_2'</span>, <span class="st">'PR_All_Lag_3'</span>, <span class="st">'PR_All_Lag_4'</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co"># to store dependent variable to model</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>dependent <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PR_All"</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co"># to do case stetament in Shiny for switching between different time series</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>data_selected <span class="ot">&lt;-</span> data_selected <span class="sc">%&gt;%</span> </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dependentVariable =</span> PR_All)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>data_actual_temp <span class="ot">&lt;-</span> data_quarter_actual <span class="sc">%&gt;%</span> </span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dependentVariable =</span> PR_All) <span class="sc">%&gt;%</span> </span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, dependentVariable)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="co"># variable for number of trees (values from 100 to 500)</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>n.trees <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co"># learning rate (values from 0.01 to 0.1)</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>shrinkage <span class="ot">=</span> <span class="fl">0.01</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="co"># minimum number of observations required in a terminal node (values 5 to 10)</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>n.minobsinnode <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="co"># fraction of observations sampled without replacement for each tree (values 0.5 to 1.0)</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>bag.fraction <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="co"># select name of distribution to use (values are 'gaussian', 'laplace', 'tdist')</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>distribution <span class="ot">&lt;-</span> <span class="st">'gaussian'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code chunk below shows the preparation of the dataset based on user selected inputs, including the partitioning of the dataset into training and testing datasets based on the user selected year to start forecasting from.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>ppi_gb_train <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_selected, <span class="fu">as.numeric</span>(<span class="fu">year</span>(Date)) <span class="sc">&lt;</span> cut_off_year) <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>QuarterLabel) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(explanatory), dependentVariable) <span class="sc">%&gt;%</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>ppi_gb_test <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_selected, <span class="fu">as.numeric</span>(<span class="fu">year</span>(Date)) <span class="sc">&gt;=</span> cut_off_year) <span class="sc">%&gt;%</span> </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>QuarterLabel) <span class="sc">%&gt;%</span> </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(explanatory), dependentVariable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code chunk below uses <strong>gbm()</strong> to create the model using the training dataset with the user selected model parameters.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>gb_model <span class="ot">&lt;-</span> <span class="fu">gbm</span>(dependentVariable <span class="sc">~</span> ., <span class="at">data =</span> ppi_gb_train, <span class="at">distribution =</span> distribution, <span class="at">n.trees =</span> n.trees, <span class="at">interaction.depth =</span> <span class="dv">10</span>, <span class="at">shrinkage =</span> shrinkage, <span class="at">n.minobsinnode =</span> n.minobsinnode, <span class="at">bag.fraction =</span> bag.fraction, <span class="at">train.fraction =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The following code chunks uses the trained model for predictions on the test data, and the results are shown as ggploty plots. The result plots provided are:</p>
<ul>
<li>Tab 1:
<ul>
<li>Predicted vs actual values</li>
<li>Residuals</li>
</ul></li>
<li>Tab 2:
<ul>
<li>Predicted time series</li>
</ul></li>
</ul>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using trained model to predict both training and test dataset and calculate RMSE</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>predictions_train <span class="ot">&lt;-</span> <span class="fu">predict</span>(gb_model, <span class="at">newdata =</span> ppi_gb_train)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>rmse_train <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((ppi_gb_train<span class="sc">$</span>dependentVariable <span class="sc">-</span> predictions_train)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>mae_train <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(ppi_gb_train<span class="sc">$</span>dependentVariable <span class="sc">-</span> predictions_train))</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gb_model, <span class="at">newdata =</span> ppi_gb_test)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((ppi_gb_test<span class="sc">$</span>dependentVariable <span class="sc">-</span> predictions)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>mae_test <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(ppi_gb_test<span class="sc">$</span>dependentVariable <span class="sc">-</span> predictions))</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>printout <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Error =</span> <span class="fu">c</span>(<span class="st">'RMSE'</span>, <span class="st">'MAE'</span>),</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Train =</span> <span class="fu">c</span>(rmse_train, mae_train),</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Test =</span> <span class="fu">c</span>(rmse_test, mae_test))</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Tab 1 - plot actual vs predicted</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Actual =</span> ppi_gb_test<span class="sc">$</span>dependentVariable, <span class="at">Predicted =</span> predictions, <span class="st">"DataPartition"</span> <span class="ot">=</span> <span class="st">"Test"</span>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>train_test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Actual =</span> ppi_gb_train<span class="sc">$</span>dependentVariable, <span class="at">Predicted =</span> predictions_train, <span class="st">"DataPartition"</span> <span class="ot">=</span> <span class="st">"Train"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(results)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>x_lim_min <span class="ot">&lt;-</span> <span class="fu">floor</span>(train_test[<span class="st">'Actual'</span>] <span class="sc">%&gt;%</span> <span class="fu">min</span>())</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>y_lim_min <span class="ot">&lt;-</span> <span class="fu">floor</span>(train_test[<span class="st">'Predicted'</span>] <span class="sc">%&gt;%</span> <span class="fu">min</span>())</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>x_lim_max <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(train_test[<span class="st">'Actual'</span>] <span class="sc">%&gt;%</span> <span class="fu">max</span>())</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>y_lim_max <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(train_test[<span class="st">'Predicted'</span>] <span class="sc">%&gt;%</span> <span class="fu">max</span>())</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>p2a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> train_test, </span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Actual, </span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> Predicted, </span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> DataPartition)) <span class="sc">+</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span>  <span class="co"># Add a diagonal line for reference</span></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Actual"</span>, </span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted"</span>, </span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Actual vs. Predicted Values"</span>) <span class="sc">+</span> </span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(x_lim_min, y_lim_min), <span class="fu">max</span>(x_lim_max, y_lim_max))) <span class="sc">+</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(x_lim_min, y_lim_min), <span class="fu">max</span>(x_lim_max, y_lim_max))) <span class="sc">+</span></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Tab 1 - to plot residuals</span></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>train_test<span class="sc">$</span>Residuals <span class="ot">&lt;-</span> train_test<span class="sc">$</span>Actual <span class="sc">-</span> train_test<span class="sc">$</span>Predicted</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>p2b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>train_test, <span class="fu">aes</span>(<span class="at">x=</span>Predicted, <span class="at">y=</span>Residuals, <span class="at">colour =</span> DataPartition)) <span class="sc">+</span> </span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">color =</span> <span class="st">'Red'</span>, <span class="at">linetype =</span> <span class="st">'dashed'</span>) <span class="sc">+</span></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Residual Plot"</span>) <span class="sc">+</span></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Tab 2 - to plot time series of index (with forecasting)</span></span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (selected <span class="sc">==</span> <span class="st">"diff"</span>) {</span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">recover_actual</span>(results, data_actual_temp<span class="sc">$</span>dependentVariable[<span class="fu">nrow</span>(data_actual_temp) <span class="sc">-</span> <span class="fu">nrow</span>(results)]) <span class="sc">%&gt;%</span> </span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Date =</span> (data_actual_temp<span class="sc">$</span>Date[(<span class="fu">nrow</span>(data_actual_temp) <span class="sc">-</span> <span class="fu">nrow</span>(results) <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="fu">nrow</span>(data_actual_temp))]))</span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> (data_actual_temp<span class="sc">$</span>Date[(<span class="fu">nrow</span>(data_actual_temp) <span class="sc">-</span> <span class="fu">nrow</span>(results) <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="fu">nrow</span>(data_actual_temp))]))</span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>p2c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>data_actual_temp,</span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> dependentVariable),</span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">"green"</span>,</span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>results,</span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x=</span>Date, <span class="at">y =</span> Predicted, <span class="at">color =</span> DataPartition),</span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">'dotted'</span>,</span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Price Index"</span>,</span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">'Year'</span>,</span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Time Series of Quarterly Price Index (Actual index in green)"</span>) <span class="sc">+</span></span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The prototype plots are:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Tab 1 - Prediction results using model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Tab 2 - Predicted time series</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p2a) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-67ee08dcf15e2a88f6e4" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-67ee08dcf15e2a88f6e4">{"x":{"data":[{"x":[-16.550000000000001,17.550000000000001],"y":[-16.550000000000001,17.550000000000001],"text":"intercept: 0<br />slope: 1","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.9765625,0.32873109796186722,0.78636959370905446,2.080624187256169,3.3121019108280185,0.80147965474723271,1.1009174311926675,5.0211736237144482,0.69124423963134629,3.4897025171624678,3.8142620232172497,0.42598509052182265,3.2873806998939643,-0.2053388090349105,0.82304526748970908,2.806122448979592],"y":[-0.3826317836571545,-1.3970801179950572,-0.25177308483998029,1.892500356270632,3.658273275865727,3.368544018301225,2.0051046902222942,1.1194318057852544,4.3967330489507104,2.082531858142759,0.39235407039477321,0.61711218221263542,-0.17735664879147334,1.2885516988479937,-2.1461976416273321,0.14761606159652935],"text":["Actual:  -0.97656250<br />Predicted: -0.38263178<br />DataPartition: Test","Actual:   0.32873110<br />Predicted: -1.39708012<br />DataPartition: Test","Actual:   0.78636959<br />Predicted: -0.25177308<br />DataPartition: Test","Actual:   2.08062419<br />Predicted:  1.89250036<br />DataPartition: Test","Actual:   3.31210191<br />Predicted:  3.65827328<br />DataPartition: Test","Actual:   0.80147965<br />Predicted:  3.36854402<br />DataPartition: Test","Actual:   1.10091743<br />Predicted:  2.00510469<br />DataPartition: Test","Actual:   5.02117362<br />Predicted:  1.11943181<br />DataPartition: Test","Actual:   0.69124424<br />Predicted:  4.39673305<br />DataPartition: Test","Actual:   3.48970252<br />Predicted:  2.08253186<br />DataPartition: Test","Actual:   3.81426202<br />Predicted:  0.39235407<br />DataPartition: Test","Actual:   0.42598509<br />Predicted:  0.61711218<br />DataPartition: Test","Actual:   3.28738070<br />Predicted: -0.17735665<br />DataPartition: Test","Actual:  -0.20533881<br />Predicted:  1.28855170<br />DataPartition: Test","Actual:   0.82304527<br />Predicted: -2.14619764<br />DataPartition: Test","Actual:   2.80612245<br />Predicted:  0.14761606<br />DataPartition: Test"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":0.5,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Test","legendgroup":"Test","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2.6345933562428376,3.90625,4.8335123523093451,8.1967213114754109,8.3333333333333446,6.7307692307692211,3.7674037674037741,0.1578531965272319,-2.3640661938534278,-6.053268765133172,-14.089347079037806,-4.7000000000000028,15.739769150052465,7.343608340888494,5.6587837837837736,5.2757793764987966,2.8853454821564251,2.7306273062730542,2.2270114942528898,1.9676739283204374,1.3094417643004863,0.27210884353741888,-0.13568521031208755,0.47554347826088122,0.60851926977688009,1.8145161290322502,0.59405940594059781,1.0498687664041957,0.38961038961038591,-0.90556274256145264,-1.2402088772845805,-1.0575016523463467,-0.7348029392117531,-1.0767160161507365,-1.0204081632653061,-0.89347079037801458,-1.3176144244105252,-0.4919184820801244,-0.70621468926553677,-0.42674253200568585,-1.499999999999996,-0.50761421319798194,-0.3644314868804665,-0.07315288953913264,0.7320644216691069,0.79941860465115866,3.8932948810382166,3.4004163775156178,0.46979865771811313,-0.066800267201065008,-0.66844919786096257,1.4804845222072793,1.3262599469496019,0.52356020942407266],"y":[2.1605736274447609,3.8241635566088639,4.9700182013451144,5.9650255771310636,5.6871298802974399,5.2749973950429467,3.1580258203013702,1.8357572663045243,-1.1367040977103033,-5.1650918584533203,-4.4498562881179913,-1.754453338944008,4.29170342400817,6.5306575125203823,5.4130647526794347,5.6838840146399665,2.9847133729853077,2.894238306349016,2.4191934494439318,1.7459976524510827,1.0994876271495875,0.12320646422300585,0.72934966775538679,0.3437724671925616,0.73430920373952269,1.0912666726018212,1.4245642595758179,0.72553743800970427,0.57377953612578847,-0.1872194439266627,-0.68487984595291129,-0.93510955396622253,-1.5613336541854681,-0.70013466480258257,0.035373571101048107,-1.0640821969144934,-1.8786118074668028,-1.3084195484992469,-0.83895008852544684,0.37846642903065941,-1.0888630006415512,-0.57438787300694416,1.0503519548305833,-0.090445352200314105,2.0812874040158524,1.4563699127153433,2.2975924464267181,3.2481039526770896,1.260495125823003,0.066082105354382581,-0.37825397811393058,0.75149260728237177,0.89772326434377736,0.93833474746967682],"text":["Actual:   2.63459336<br />Predicted:  2.16057363<br />DataPartition: Train","Actual:   3.90625000<br />Predicted:  3.82416356<br />DataPartition: Train","Actual:   4.83351235<br />Predicted:  4.97001820<br />DataPartition: Train","Actual:   8.19672131<br />Predicted:  5.96502558<br />DataPartition: Train","Actual:   8.33333333<br />Predicted:  5.68712988<br />DataPartition: Train","Actual:   6.73076923<br />Predicted:  5.27499740<br />DataPartition: Train","Actual:   3.76740377<br />Predicted:  3.15802582<br />DataPartition: Train","Actual:   0.15785320<br />Predicted:  1.83575727<br />DataPartition: Train","Actual:  -2.36406619<br />Predicted: -1.13670410<br />DataPartition: Train","Actual:  -6.05326877<br />Predicted: -5.16509186<br />DataPartition: Train","Actual: -14.08934708<br />Predicted: -4.44985629<br />DataPartition: Train","Actual:  -4.70000000<br />Predicted: -1.75445334<br />DataPartition: Train","Actual:  15.73976915<br />Predicted:  4.29170342<br />DataPartition: Train","Actual:   7.34360834<br />Predicted:  6.53065751<br />DataPartition: Train","Actual:   5.65878378<br />Predicted:  5.41306475<br />DataPartition: Train","Actual:   5.27577938<br />Predicted:  5.68388401<br />DataPartition: Train","Actual:   2.88534548<br />Predicted:  2.98471337<br />DataPartition: Train","Actual:   2.73062731<br />Predicted:  2.89423831<br />DataPartition: Train","Actual:   2.22701149<br />Predicted:  2.41919345<br />DataPartition: Train","Actual:   1.96767393<br />Predicted:  1.74599765<br />DataPartition: Train","Actual:   1.30944176<br />Predicted:  1.09948763<br />DataPartition: Train","Actual:   0.27210884<br />Predicted:  0.12320646<br />DataPartition: Train","Actual:  -0.13568521<br />Predicted:  0.72934967<br />DataPartition: Train","Actual:   0.47554348<br />Predicted:  0.34377247<br />DataPartition: Train","Actual:   0.60851927<br />Predicted:  0.73430920<br />DataPartition: Train","Actual:   1.81451613<br />Predicted:  1.09126667<br />DataPartition: Train","Actual:   0.59405941<br />Predicted:  1.42456426<br />DataPartition: Train","Actual:   1.04986877<br />Predicted:  0.72553744<br />DataPartition: Train","Actual:   0.38961039<br />Predicted:  0.57377954<br />DataPartition: Train","Actual:  -0.90556274<br />Predicted: -0.18721944<br />DataPartition: Train","Actual:  -1.24020888<br />Predicted: -0.68487985<br />DataPartition: Train","Actual:  -1.05750165<br />Predicted: -0.93510955<br />DataPartition: Train","Actual:  -0.73480294<br />Predicted: -1.56133365<br />DataPartition: Train","Actual:  -1.07671602<br />Predicted: -0.70013466<br />DataPartition: Train","Actual:  -1.02040816<br />Predicted:  0.03537357<br />DataPartition: Train","Actual:  -0.89347079<br />Predicted: -1.06408220<br />DataPartition: Train","Actual:  -1.31761442<br />Predicted: -1.87861181<br />DataPartition: Train","Actual:  -0.49191848<br />Predicted: -1.30841955<br />DataPartition: Train","Actual:  -0.70621469<br />Predicted: -0.83895009<br />DataPartition: Train","Actual:  -0.42674253<br />Predicted:  0.37846643<br />DataPartition: Train","Actual:  -1.50000000<br />Predicted: -1.08886300<br />DataPartition: Train","Actual:  -0.50761421<br />Predicted: -0.57438787<br />DataPartition: Train","Actual:  -0.36443149<br />Predicted:  1.05035195<br />DataPartition: Train","Actual:  -0.07315289<br />Predicted: -0.09044535<br />DataPartition: Train","Actual:   0.73206442<br />Predicted:  2.08128740<br />DataPartition: Train","Actual:   0.79941860<br />Predicted:  1.45636991<br />DataPartition: Train","Actual:   3.89329488<br />Predicted:  2.29759245<br />DataPartition: Train","Actual:   3.40041638<br />Predicted:  3.24810395<br />DataPartition: Train","Actual:   0.46979866<br />Predicted:  1.26049513<br />DataPartition: Train","Actual:  -0.06680027<br />Predicted:  0.06608211<br />DataPartition: Train","Actual:  -0.66844920<br />Predicted: -0.37825398<br />DataPartition: Train","Actual:   1.48048452<br />Predicted:  0.75149261<br />DataPartition: Train","Actual:   1.32625995<br />Predicted:  0.89772326<br />DataPartition: Train","Actual:   0.52356021<br />Predicted:  0.93833475<br />DataPartition: Train"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":0.5,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"Train","legendgroup":"Train","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":43.105022831050235},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Actual vs. Predicted Values","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-16.550000000000001,17.550000000000001],"tickmode":"array","ticktext":["-10","0","10"],"tickvals":[-10,0,10],"categoryorder":"array","categoryarray":["-10","0","10"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Actual","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-16.550000000000001,17.550000000000001],"tickmode":"array","ticktext":["-10","0","10"],"tickvals":[-10,0,10],"categoryorder":"array","categoryarray":["-10","0","10"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Predicted","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"DataPartition","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"51dc37822f5d":{"intercept":{},"slope":{},"type":"scatter"},"51dc582e7345":{"x":{},"y":{},"colour":{}}},"cur_data":"51dc37822f5d","visdat":{"51dc37822f5d":["function (y) ","x"],"51dc582e7345":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p2b)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-56bf8363ef5649c0436a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-56bf8363ef5649c0436a">{"x":{"data":[{"x":[-0.3826317836571545,-1.3970801179950572,-0.25177308483998029,1.892500356270632,3.658273275865727,3.368544018301225,2.0051046902222942,1.1194318057852544,4.3967330489507104,2.082531858142759,0.39235407039477321,0.61711218221263542,-0.17735664879147334,1.2885516988479937,-2.1461976416273321,0.14761606159652935],"y":[-0.59393071634284555,1.7258112159569243,1.0381426785490349,0.18812383098553709,-0.34617136503770851,-2.5670643635539925,-0.90418725902962671,3.9017418179291941,-3.7054888093193643,1.4071706590197088,3.4219079528224765,-0.19112709169081277,3.4647373486854378,-1.4938905078829041,2.9692429091170411,2.6585063873830626],"text":["Predicted: -0.38263178<br />Residuals: -0.59393072<br />DataPartition: Test","Predicted: -1.39708012<br />Residuals:  1.72581122<br />DataPartition: Test","Predicted: -0.25177308<br />Residuals:  1.03814268<br />DataPartition: Test","Predicted:  1.89250036<br />Residuals:  0.18812383<br />DataPartition: Test","Predicted:  3.65827328<br />Residuals: -0.34617137<br />DataPartition: Test","Predicted:  3.36854402<br />Residuals: -2.56706436<br />DataPartition: Test","Predicted:  2.00510469<br />Residuals: -0.90418726<br />DataPartition: Test","Predicted:  1.11943181<br />Residuals:  3.90174182<br />DataPartition: Test","Predicted:  4.39673305<br />Residuals: -3.70548881<br />DataPartition: Test","Predicted:  2.08253186<br />Residuals:  1.40717066<br />DataPartition: Test","Predicted:  0.39235407<br />Residuals:  3.42190795<br />DataPartition: Test","Predicted:  0.61711218<br />Residuals: -0.19112709<br />DataPartition: Test","Predicted: -0.17735665<br />Residuals:  3.46473735<br />DataPartition: Test","Predicted:  1.28855170<br />Residuals: -1.49389051<br />DataPartition: Test","Predicted: -2.14619764<br />Residuals:  2.96924291<br />DataPartition: Test","Predicted:  0.14761606<br />Residuals:  2.65850639<br />DataPartition: Test"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Test","legendgroup":"Test","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2.1605736274447609,3.8241635566088639,4.9700182013451144,5.9650255771310636,5.6871298802974399,5.2749973950429467,3.1580258203013702,1.8357572663045243,-1.1367040977103033,-5.1650918584533203,-4.4498562881179913,-1.754453338944008,4.29170342400817,6.5306575125203823,5.4130647526794347,5.6838840146399665,2.9847133729853077,2.894238306349016,2.4191934494439318,1.7459976524510827,1.0994876271495875,0.12320646422300585,0.72934966775538679,0.3437724671925616,0.73430920373952269,1.0912666726018212,1.4245642595758179,0.72553743800970427,0.57377953612578847,-0.1872194439266627,-0.68487984595291129,-0.93510955396622253,-1.5613336541854681,-0.70013466480258257,0.035373571101048107,-1.0640821969144934,-1.8786118074668028,-1.3084195484992469,-0.83895008852544684,0.37846642903065941,-1.0888630006415512,-0.57438787300694416,1.0503519548305833,-0.090445352200314105,2.0812874040158524,1.4563699127153433,2.2975924464267181,3.2481039526770896,1.260495125823003,0.066082105354382581,-0.37825397811393058,0.75149260728237177,0.89772326434377736,0.93833474746967682],"y":[0.47401972879807674,0.082086443391136132,-0.13650584903576934,2.2316957343443473,2.6462034530359047,1.4557718357262743,0.60937794710240389,-1.6779040697772925,-1.2273620961431244,-0.88817690667985172,-9.6394907909198153,-2.9455466610559951,11.448065726044295,0.81295082836811172,0.2457190311043389,-0.40810463814116993,-0.099367890828882643,-0.16361100007596185,-0.19218195519104198,0.22167627586935468,0.20995413715089883,0.14890237931441302,-0.86503487806747437,0.13177101106831962,-0.1257899339626426,0.72324945643042904,-0.83050485363522009,0.32433132839449141,-0.18416914651540256,-0.71834329863478996,-0.55532903133166922,-0.12239209838012421,0.826530714973715,-0.37658135134815396,-1.0557817343663543,0.17061140653647877,0.56099738305627755,0.81650106641912257,0.13273539925991007,-0.80520896103634532,-0.41113699935844483,0.066773659808962216,-1.4147834417110499,0.017292462661181465,-1.3492229823467454,-0.65695130806418467,1.5957024346114985,0.15231242483852814,-0.79069646810488992,-0.1328823725554476,-0.290195219747032,0.72899191492490756,0.42853668260582456,-0.41477453804560416],"text":["Predicted:  2.16057363<br />Residuals:  0.47401973<br />DataPartition: Train","Predicted:  3.82416356<br />Residuals:  0.08208644<br />DataPartition: Train","Predicted:  4.97001820<br />Residuals: -0.13650585<br />DataPartition: Train","Predicted:  5.96502558<br />Residuals:  2.23169573<br />DataPartition: Train","Predicted:  5.68712988<br />Residuals:  2.64620345<br />DataPartition: Train","Predicted:  5.27499740<br />Residuals:  1.45577184<br />DataPartition: Train","Predicted:  3.15802582<br />Residuals:  0.60937795<br />DataPartition: Train","Predicted:  1.83575727<br />Residuals: -1.67790407<br />DataPartition: Train","Predicted: -1.13670410<br />Residuals: -1.22736210<br />DataPartition: Train","Predicted: -5.16509186<br />Residuals: -0.88817691<br />DataPartition: Train","Predicted: -4.44985629<br />Residuals: -9.63949079<br />DataPartition: Train","Predicted: -1.75445334<br />Residuals: -2.94554666<br />DataPartition: Train","Predicted:  4.29170342<br />Residuals: 11.44806573<br />DataPartition: Train","Predicted:  6.53065751<br />Residuals:  0.81295083<br />DataPartition: Train","Predicted:  5.41306475<br />Residuals:  0.24571903<br />DataPartition: Train","Predicted:  5.68388401<br />Residuals: -0.40810464<br />DataPartition: Train","Predicted:  2.98471337<br />Residuals: -0.09936789<br />DataPartition: Train","Predicted:  2.89423831<br />Residuals: -0.16361100<br />DataPartition: Train","Predicted:  2.41919345<br />Residuals: -0.19218196<br />DataPartition: Train","Predicted:  1.74599765<br />Residuals:  0.22167628<br />DataPartition: Train","Predicted:  1.09948763<br />Residuals:  0.20995414<br />DataPartition: Train","Predicted:  0.12320646<br />Residuals:  0.14890238<br />DataPartition: Train","Predicted:  0.72934967<br />Residuals: -0.86503488<br />DataPartition: Train","Predicted:  0.34377247<br />Residuals:  0.13177101<br />DataPartition: Train","Predicted:  0.73430920<br />Residuals: -0.12578993<br />DataPartition: Train","Predicted:  1.09126667<br />Residuals:  0.72324946<br />DataPartition: Train","Predicted:  1.42456426<br />Residuals: -0.83050485<br />DataPartition: Train","Predicted:  0.72553744<br />Residuals:  0.32433133<br />DataPartition: Train","Predicted:  0.57377954<br />Residuals: -0.18416915<br />DataPartition: Train","Predicted: -0.18721944<br />Residuals: -0.71834330<br />DataPartition: Train","Predicted: -0.68487985<br />Residuals: -0.55532903<br />DataPartition: Train","Predicted: -0.93510955<br />Residuals: -0.12239210<br />DataPartition: Train","Predicted: -1.56133365<br />Residuals:  0.82653071<br />DataPartition: Train","Predicted: -0.70013466<br />Residuals: -0.37658135<br />DataPartition: Train","Predicted:  0.03537357<br />Residuals: -1.05578173<br />DataPartition: Train","Predicted: -1.06408220<br />Residuals:  0.17061141<br />DataPartition: Train","Predicted: -1.87861181<br />Residuals:  0.56099738<br />DataPartition: Train","Predicted: -1.30841955<br />Residuals:  0.81650107<br />DataPartition: Train","Predicted: -0.83895009<br />Residuals:  0.13273540<br />DataPartition: Train","Predicted:  0.37846643<br />Residuals: -0.80520896<br />DataPartition: Train","Predicted: -1.08886300<br />Residuals: -0.41113700<br />DataPartition: Train","Predicted: -0.57438787<br />Residuals:  0.06677366<br />DataPartition: Train","Predicted:  1.05035195<br />Residuals: -1.41478344<br />DataPartition: Train","Predicted: -0.09044535<br />Residuals:  0.01729246<br />DataPartition: Train","Predicted:  2.08128740<br />Residuals: -1.34922298<br />DataPartition: Train","Predicted:  1.45636991<br />Residuals: -0.65695131<br />DataPartition: Train","Predicted:  2.29759245<br />Residuals:  1.59570243<br />DataPartition: Train","Predicted:  3.24810395<br />Residuals:  0.15231242<br />DataPartition: Train","Predicted:  1.26049513<br />Residuals: -0.79069647<br />DataPartition: Train","Predicted:  0.06608211<br />Residuals: -0.13288237<br />DataPartition: Train","Predicted: -0.37825398<br />Residuals: -0.29019522<br />DataPartition: Train","Predicted:  0.75149261<br />Residuals:  0.72899191<br />DataPartition: Train","Predicted:  0.89772326<br />Residuals:  0.42853668<br />DataPartition: Train","Predicted:  0.93833475<br />Residuals: -0.41477454<br />DataPartition: Train"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"Train","legendgroup":"Train","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-5.7498793270020059,7.1154449810690679],"y":[0,0],"text":"yintercept: 0","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":43.105022831050235},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Residual Plot","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-5.7498793270020059,7.1154449810690679],"tickmode":"array","ticktext":["-5.0","-2.5","0.0","2.5","5.0"],"tickvals":[-5,-2.4999999999999996,0,2.5,5],"categoryorder":"array","categoryarray":["-5.0","-2.5","0.0","2.5","5.0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Predicted","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-10.693868616768022,12.502443551892501],"tickmode":"array","ticktext":["-10","-5","0","5","10"],"tickvals":[-10,-5,0,5,10],"categoryorder":"array","categoryarray":["-10","-5","0","5","10"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Residuals","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"DataPartition","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"51dc47911b8b":{"x":{},"y":{},"colour":{},"type":"scatter"},"51dc5dab2755":{"yintercept":{}}},"cur_data":"51dc47911b8b","visdat":{"51dc47911b8b":["function (y) ","x"],"51dc5dab2755":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span> (printout)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Error</th>
<th style="text-align: right;">Train</th>
<th style="text-align: right;">Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">RMSE</td>
<td style="text-align: right;">2.230949</td>
<td style="text-align: right;">2.020507</td>
</tr>
<tr class="even">
<td style="text-align: left;">MAE</td>
<td style="text-align: right;">1.032237</td>
<td style="text-align: right;">1.911078</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p2c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-8d46619c198bf0caa430" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-8d46619c198bf0caa430">{"x":{"data":[{"x":[13027,13118,13208,13300,13392,13483,13573,13665,13757,13848,13939,14031,14123,14214,14304,14396,14488,14579,14669,14761,14853,14944,15034,15126,15218,15309,15400,15492,15584,15675,15765,15857,15949,16040,16130,16222,16314,16405,16495,16587,16679,16770,16861,16953,17045,17136,17226,17318,17410,17501,17591,17683,17775,17866,17956,18048,18140,18231,18322,18414,18506,18597,18687,18779,18871,18962,19052,19144,19236,19327,19417,19509,19601,19692],"y":[83.299999999999997,84.5,85.799999999999997,87.299999999999997,89.599999999999994,93.099999999999994,97.599999999999994,105.59999999999999,114.40000000000001,122.09999999999999,126.7,126.90000000000001,123.90000000000001,116.40000000000001,100,95.299999999999997,110.3,118.40000000000001,125.09999999999999,131.69999999999999,135.5,139.19999999999999,142.30000000000001,145.09999999999999,147,147.40000000000001,147.19999999999999,147.90000000000001,148.80000000000001,151.5,152.40000000000001,154,154.59999999999999,153.19999999999999,151.30000000000001,149.69999999999999,148.59999999999999,147,145.5,144.19999999999999,142.30000000000001,141.59999999999999,140.59999999999999,140,137.90000000000001,137.19999999999999,136.69999999999999,136.59999999999999,137.59999999999999,138.69999999999999,144.09999999999999,149,149.69999999999999,149.59999999999999,148.59999999999999,150.80000000000001,152.80000000000001,153.59999999999999,152.09999999999999,152.59999999999999,153.80000000000001,157,162.19999999999999,163.5,165.30000000000001,173.59999999999999,174.80000000000001,180.90000000000001,187.80000000000001,188.59999999999999,194.80000000000001,194.40000000000001,196,201.5],"text":["Date: 2005-09-01<br />dependentVariable:  83.3","Date: 2005-12-01<br />dependentVariable:  84.5","Date: 2006-03-01<br />dependentVariable:  85.8","Date: 2006-06-01<br />dependentVariable:  87.3","Date: 2006-09-01<br />dependentVariable:  89.6","Date: 2006-12-01<br />dependentVariable:  93.1","Date: 2007-03-01<br />dependentVariable:  97.6","Date: 2007-06-01<br />dependentVariable: 105.6","Date: 2007-09-01<br />dependentVariable: 114.4","Date: 2007-12-01<br />dependentVariable: 122.1","Date: 2008-03-01<br />dependentVariable: 126.7","Date: 2008-06-01<br />dependentVariable: 126.9","Date: 2008-09-01<br />dependentVariable: 123.9","Date: 2008-12-01<br />dependentVariable: 116.4","Date: 2009-03-01<br />dependentVariable: 100.0","Date: 2009-06-01<br />dependentVariable:  95.3","Date: 2009-09-01<br />dependentVariable: 110.3","Date: 2009-12-01<br />dependentVariable: 118.4","Date: 2010-03-01<br />dependentVariable: 125.1","Date: 2010-06-01<br />dependentVariable: 131.7","Date: 2010-09-01<br />dependentVariable: 135.5","Date: 2010-12-01<br />dependentVariable: 139.2","Date: 2011-03-01<br />dependentVariable: 142.3","Date: 2011-06-01<br />dependentVariable: 145.1","Date: 2011-09-01<br />dependentVariable: 147.0","Date: 2011-12-01<br />dependentVariable: 147.4","Date: 2012-03-01<br />dependentVariable: 147.2","Date: 2012-06-01<br />dependentVariable: 147.9","Date: 2012-09-01<br />dependentVariable: 148.8","Date: 2012-12-01<br />dependentVariable: 151.5","Date: 2013-03-01<br />dependentVariable: 152.4","Date: 2013-06-01<br />dependentVariable: 154.0","Date: 2013-09-01<br />dependentVariable: 154.6","Date: 2013-12-01<br />dependentVariable: 153.2","Date: 2014-03-01<br />dependentVariable: 151.3","Date: 2014-06-01<br />dependentVariable: 149.7","Date: 2014-09-01<br />dependentVariable: 148.6","Date: 2014-12-01<br />dependentVariable: 147.0","Date: 2015-03-01<br />dependentVariable: 145.5","Date: 2015-06-01<br />dependentVariable: 144.2","Date: 2015-09-01<br />dependentVariable: 142.3","Date: 2015-12-01<br />dependentVariable: 141.6","Date: 2016-03-01<br />dependentVariable: 140.6","Date: 2016-06-01<br />dependentVariable: 140.0","Date: 2016-09-01<br />dependentVariable: 137.9","Date: 2016-12-01<br />dependentVariable: 137.2","Date: 2017-03-01<br />dependentVariable: 136.7","Date: 2017-06-01<br />dependentVariable: 136.6","Date: 2017-09-01<br />dependentVariable: 137.6","Date: 2017-12-01<br />dependentVariable: 138.7","Date: 2018-03-01<br />dependentVariable: 144.1","Date: 2018-06-01<br />dependentVariable: 149.0","Date: 2018-09-01<br />dependentVariable: 149.7","Date: 2018-12-01<br />dependentVariable: 149.6","Date: 2019-03-01<br />dependentVariable: 148.6","Date: 2019-06-01<br />dependentVariable: 150.8","Date: 2019-09-01<br />dependentVariable: 152.8","Date: 2019-12-01<br />dependentVariable: 153.6","Date: 2020-03-01<br />dependentVariable: 152.1","Date: 2020-06-01<br />dependentVariable: 152.6","Date: 2020-09-01<br />dependentVariable: 153.8","Date: 2020-12-01<br />dependentVariable: 157.0","Date: 2021-03-01<br />dependentVariable: 162.2","Date: 2021-06-01<br />dependentVariable: 163.5","Date: 2021-09-01<br />dependentVariable: 165.3","Date: 2021-12-01<br />dependentVariable: 173.6","Date: 2022-03-01<br />dependentVariable: 174.8","Date: 2022-06-01<br />dependentVariable: 180.9","Date: 2022-09-01<br />dependentVariable: 187.8","Date: 2022-12-01<br />dependentVariable: 188.6","Date: 2023-03-01<br />dependentVariable: 194.8","Date: 2023-06-01<br />dependentVariable: 194.4","Date: 2023-09-01<br />dependentVariable: 196.0","Date: 2023-12-01<br />dependentVariable: 201.5"],"type":"scatter","mode":"lines","line":{"width":2.6456692913385824,"color":"rgba(0,255,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[18322,18414,18506,18597,18687,18779,18871,18962,19052,19144,19236,19327,19417,19509,19601,19692],"y":[153.01227758030262,150.8745734721368,150.49471190426684,153.34282486322354,158.95252444565241,164.30691019980523,167.60143576258088,169.47761954145997,176.9290980504143,180.61370288363881,181.32234809859349,182.44131039778389,182.11773860365113,184.464419818332,180.50544879054942,180.77190382502116],"text":["Date: 2020-03-01<br />Predicted: 153.0123<br />DataPartition: Test","Date: 2020-06-01<br />Predicted: 150.8746<br />DataPartition: Test","Date: 2020-09-01<br />Predicted: 150.4947<br />DataPartition: Test","Date: 2020-12-01<br />Predicted: 153.3428<br />DataPartition: Test","Date: 2021-03-01<br />Predicted: 158.9525<br />DataPartition: Test","Date: 2021-06-01<br />Predicted: 164.3069<br />DataPartition: Test","Date: 2021-09-01<br />Predicted: 167.6014<br />DataPartition: Test","Date: 2021-12-01<br />Predicted: 169.4776<br />DataPartition: Test","Date: 2022-03-01<br />Predicted: 176.9291<br />DataPartition: Test","Date: 2022-06-01<br />Predicted: 180.6137<br />DataPartition: Test","Date: 2022-09-01<br />Predicted: 181.3223<br />DataPartition: Test","Date: 2022-12-01<br />Predicted: 182.4413<br />DataPartition: Test","Date: 2023-03-01<br />Predicted: 182.1177<br />DataPartition: Test","Date: 2023-06-01<br />Predicted: 184.4644<br />DataPartition: Test","Date: 2023-09-01<br />Predicted: 180.5054<br />DataPartition: Test","Date: 2023-12-01<br />Predicted: 180.7719<br />DataPartition: Test"],"type":"scatter","mode":"lines","line":{"width":2.6456692913385824,"color":"rgba(248,118,109,1)","dash":"dot"},"hoveron":"points","name":"Test","legendgroup":"Test","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":43.105022831050235},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Time Series of Quarterly Price Index (Actual index in green)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[12693.75,20025.25],"tickmode":"array","ticktext":["2005","2010","2015","2020"],"tickvals":[12784,14610,16436,18262],"categoryorder":"array","categoryarray":["2005","2010","2015","2020"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[77.390000000000001,207.41],"tickmode":"array","ticktext":["100","125","150","175","200"],"tickvals":[100,125,150,175,200],"categoryorder":"array","categoryarray":["100","125","150","175","200"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Price Index","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"DataPartition","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"51dc4f2868c5":{"x":{},"y":{},"type":"scatter"},"51dc22bf4790":{"x":{},"y":{},"colour":{}}},"cur_data":"51dc4f2868c5","visdat":{"51dc4f2868c5":["function (y) ","x"],"51dc22bf4790":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="prototype-of-prophet-model" class="level2">
<h2 class="anchored" data-anchor-id="prototype-of-prophet-model">3.4 Prototype of Prophet Model</h2>
<p>The prototype uses <strong>prophet()</strong> of the Prophet package to model the property price index using explanatory variable for forecasting, to make predictions on the subsequent periods based on new / unseen data.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Parameters for user inputs
</div>
</div>
<div class="callout-body-container callout-body">
<p>The following will be made available as user inputs:</p>
<ul>
<li>Variables selection
<ul>
<li>Type of data to use for prediction - Select from possible values of ‘actual’ or ’diff.</li>
<li>Forecast from which year - Select from possible values of 2018 to 2022</li>
<li>Explanatory variables - Select from list of explanatory variables (raw material prices, STI, Bond/bill rates, SORA rate)</li>
<li>Which property price index to forecast - Select from a list of property price indices (refer to 3.1 for list)</li>
</ul></li>
<li>Model parameters
<ul>
<li>Mode for handling seasonalities (seasonality.mode) - Select from additive’ (default) or ‘multiplicative’</li>
<li>Growth modeling (growth) - Select from ‘linear’, ‘logistic’, ‘flat’</li>
<li>Fit yearly seasonality (yearly.seasonality) - Select from values ‘auto’, TRUE, FALSE</li>
</ul></li>
</ul>
</div>
</div>
<p>The code chunk below simulates the user inputs from the Shiny App:</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose whether to model actual values or difference across periods</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>data_selected <span class="ot">=</span> data_quarter_actual</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>selected <span class="ot">=</span> <span class="st">"actual"</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># this is cutoff value of year for training/testing data selection                </span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>cut_off_year <span class="ot">=</span> <span class="dv">2020</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># to store explanatory variables - will be user inputs</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>explanatory <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Cement"</span>, <span class="st">"SteelBar"</span>, <span class="st">"Granite"</span>, <span class="st">"ConcretingSand"</span>, <span class="st">"ReadyMixConcrete"</span>, <span class="st">"Index"</span>, <span class="st">"Bill1Yr"</span>, <span class="st">"Bond2Yr"</span>, <span class="st">"Bond5Yr"</span>, <span class="st">"Bond10Yr"</span>, <span class="st">"Rate"</span>, <span class="st">'PR_All_Lag_1'</span>, <span class="st">'PR_All_Lag_2'</span>, <span class="st">'PR_All_Lag_3'</span>, <span class="st">'PR_All_Lag_4'</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># to store dependent variable to model</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>dependent <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PR_All"</span>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co"># to do case stetament in Shiny for switching between different time series</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>data_selected <span class="ot">&lt;-</span> data_selected <span class="sc">%&gt;%</span> </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">y =</span> PR_All)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>data_actual_temp <span class="ot">&lt;-</span> data_quarter_actual <span class="sc">%&gt;%</span> </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">y =</span> PR_All) <span class="sc">%&gt;%</span> </span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, y)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="co"># modes for handling seasonalities (Either 'additive' (default) or 'multiplicative')</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>seasonality.mode <span class="ot">=</span> <span class="st">'multiplicative'</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Prophet allows for logistic growth modeling by default but can be adjusted for linear growth (values are 'linear', 'logistic', 'flat')</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>growth <span class="ot">=</span> <span class="st">'linear'</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit yearly seasonality (values are 'auto', TRUE, FALSE)</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>yearly.seasonality <span class="ot">=</span> <span class="st">'auto'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code chunk below shows the preparation of the dataset based on user selected inputs, including the partitioning of the dataset into training and testing datasets based on the user selected year to start forecasting from.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>ppi_pp_train <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_selected, <span class="fu">as.numeric</span>(<span class="fu">year</span>(Date)) <span class="sc">&lt;</span> cut_off_year) <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>QuarterLabel) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, <span class="fu">all_of</span>(explanatory), y) <span class="sc">%&gt;%</span> </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ds =</span> Date) <span class="sc">%&gt;%</span> </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>ppi_pp_test <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_selected, <span class="fu">as.numeric</span>(<span class="fu">year</span>(Date)) <span class="sc">&gt;=</span> cut_off_year) <span class="sc">%&gt;%</span> </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>QuarterLabel) <span class="sc">%&gt;%</span> </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, <span class="fu">all_of</span>(explanatory), y) <span class="sc">%&gt;%</span> </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ds =</span> Date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code chunk below uses <strong>prophet()</strong> to create the model using the training dataset with the user selected model parameters.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>pp_model <span class="ot">&lt;-</span> <span class="fu">prophet</span>(<span class="at">seasonality.mode =</span> seasonality.mode, <span class="at">growth =</span> growth, <span class="at">yearly.seasonality =</span> yearly.seasonality, <span class="at">uncertainty.samples =</span> <span class="dv">500</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># to select regressors based on user inputs</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>pp_model <span class="ot">&lt;-</span> <span class="fu">add_regressor</span>(pp_model, <span class="st">'Cement'</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>pp_model <span class="ot">&lt;-</span> <span class="fu">add_regressor</span>(pp_model, <span class="st">'SteelBar'</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>pp_model <span class="ot">&lt;-</span> <span class="fu">add_regressor</span>(pp_model, <span class="st">'Granite'</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>pp_model <span class="ot">&lt;-</span> <span class="fu">add_regressor</span>(pp_model, <span class="st">'ConcretingSand'</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>pp_model <span class="ot">&lt;-</span> <span class="fu">add_regressor</span>(pp_model, <span class="st">'ReadyMixConcrete'</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>pp_model <span class="ot">&lt;-</span> <span class="fu">add_regressor</span>(pp_model, <span class="st">'PR_All_Lag_1'</span>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>pp_model <span class="ot">&lt;-</span> <span class="fu">add_regressor</span>(pp_model, <span class="st">'PR_All_Lag_2'</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>pp_model <span class="ot">&lt;-</span> <span class="fu">add_regressor</span>(pp_model, <span class="st">'PR_All_Lag_3'</span>)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>pp_model <span class="ot">&lt;-</span> <span class="fu">add_regressor</span>(pp_model, <span class="st">'PR_All_Lag_4'</span>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>pp_model <span class="ot">&lt;-</span> <span class="fu">fit.prophet</span>(pp_model, ppi_pp_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The following code chunks uses the trained model for predictions on the test data, and the results are shown as ggploty plots. The result plots provided are:</p>
<ul>
<li>Tab 1:
<ul>
<li>Predicted vs actual values</li>
<li>Residuals</li>
</ul></li>
<li>Tab 2:
<ul>
<li>Predicted time series</li>
</ul></li>
</ul>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>forecast_train <span class="ot">&lt;-</span> <span class="fu">predict</span>(pp_model, ppi_pp_train)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>forecast <span class="ot">&lt;-</span> <span class="fu">predict</span>(pp_model, ppi_pp_test)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Tab 1 - plot actual vs predicted</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>train_predict <span class="ot">&lt;-</span> forecast_train <span class="sc">%&gt;%</span> </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ds, yhat) <span class="sc">%&gt;%</span> </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"DataPartition"</span> <span class="ot">=</span> <span class="st">"Train"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">'Actual'</span> <span class="ot">=</span> ppi_pp_train<span class="sc">$</span>y) <span class="sc">%&gt;%</span> </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Date=</span>ds, <span class="at">Predicted=</span>yhat)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>test_predict <span class="ot">&lt;-</span> forecast <span class="sc">%&gt;%</span> </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ds, yhat) <span class="sc">%&gt;%</span> </span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"DataPartition"</span> <span class="ot">=</span> <span class="st">"Test"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">'Actual'</span> <span class="ot">=</span> ppi_pp_test<span class="sc">$</span>y) <span class="sc">%&gt;%</span> </span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Date=</span>ds, <span class="at">Predicted=</span>yhat)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>train_test <span class="ot">&lt;-</span> train_predict <span class="sc">%&gt;%</span> </span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(test_predict) </span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="co"># compute RMSE and MAE</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>rmse_train <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((train_predict<span class="sc">$</span>Actual <span class="sc">-</span> train_predict<span class="sc">$</span>Predicted)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>mae_train <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(train_predict<span class="sc">$</span>Actual <span class="sc">-</span> train_predict<span class="sc">$</span>Predicted))</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>rmse_test <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((test_predict<span class="sc">$</span>Actual <span class="sc">-</span> test_predict<span class="sc">$</span>Predicted)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>mae_test <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(test_predict<span class="sc">$</span>Actual <span class="sc">-</span> test_predict<span class="sc">$</span>Predicted))</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>printout <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">Error =</span> <span class="fu">c</span>(<span class="st">'RMSE'</span>, <span class="st">'MAE'</span>),</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">Train =</span> <span class="fu">c</span>(rmse_train, mae_train),</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">Test =</span> <span class="fu">c</span>(rmse_test, mae_test))</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>x_lim_min <span class="ot">&lt;-</span> <span class="fu">floor</span>(train_test[<span class="st">'Actual'</span>] <span class="sc">%&gt;%</span> <span class="fu">min</span>())</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>y_lim_min <span class="ot">&lt;-</span> <span class="fu">floor</span>(train_test[<span class="st">'Predicted'</span>] <span class="sc">%&gt;%</span> <span class="fu">min</span>())</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>x_lim_max <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(train_test[<span class="st">'Actual'</span>] <span class="sc">%&gt;%</span> <span class="fu">max</span>())</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>y_lim_max <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(train_test[<span class="st">'Predicted'</span>] <span class="sc">%&gt;%</span> <span class="fu">max</span>())</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>p3a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> train_test, </span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Actual, </span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> Predicted, </span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> DataPartition)) <span class="sc">+</span></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span>  <span class="co"># Add a diagonal line for reference</span></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Actual"</span>, </span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted"</span>, </span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Actual vs. Predicted Values"</span>) <span class="sc">+</span> </span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(x_lim_min, y_lim_min), <span class="fu">max</span>(x_lim_max, y_lim_max))) <span class="sc">+</span></span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(x_lim_min, y_lim_min), <span class="fu">max</span>(x_lim_max, y_lim_max))) <span class="sc">+</span></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Tab 1 - to plot residuals</span></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>train_test<span class="sc">$</span>Residuals <span class="ot">&lt;-</span> train_test<span class="sc">$</span>Actual <span class="sc">-</span> train_test<span class="sc">$</span>Predicted</span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>p3b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>train_test, <span class="fu">aes</span>(<span class="at">x=</span>Predicted, <span class="at">y=</span>Residuals, <span class="at">colour =</span> DataPartition)) <span class="sc">+</span> </span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">color =</span> <span class="st">'Red'</span>, <span class="at">linetype =</span> <span class="st">'dashed'</span>) <span class="sc">+</span></span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Residual Plot"</span>) <span class="sc">+</span></span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Tab 2 - to plot time series of index (with forecasting)</span></span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> test_predict</span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a>data_actual_temp <span class="ot">&lt;-</span> data_actual_temp <span class="sc">%&gt;%</span> </span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dependentVariable =</span> y)</span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (selected <span class="sc">==</span> <span class="st">"diff"</span>) {</span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">recover_actual</span>(results, data_actual_temp<span class="sc">$</span>dependentVariable[<span class="fu">nrow</span>(data_actual_temp) <span class="sc">-</span> <span class="fu">nrow</span>(results)]) <span class="sc">%&gt;%</span> </span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Date =</span> (data_actual_temp<span class="sc">$</span>Date[(<span class="fu">nrow</span>(data_actual_temp) <span class="sc">-</span> <span class="fu">nrow</span>(results) <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="fu">nrow</span>(data_actual_temp))]))</span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> (data_actual_temp<span class="sc">$</span>Date[(<span class="fu">nrow</span>(data_actual_temp) <span class="sc">-</span> <span class="fu">nrow</span>(results) <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="fu">nrow</span>(data_actual_temp))]))</span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a>p3c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>data_actual_temp,</span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> dependentVariable),</span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">"green"</span>,</span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>results,</span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Predicted, <span class="at">color =</span> DataPartition),</span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">'dotted'</span>,</span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Price Index"</span>,</span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">'Year'</span>,</span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Time Series of Quarterly Price Index (Actual index in green)"</span>) <span class="sc">+</span></span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The prototype plots are:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Tab 1 - Prediction results using model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Tab 2 - Predicted time series</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p3a)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-9be1d664aaef54419a6d" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9be1d664aaef54419a6d">{"x":{"data":[{"x":[83.349999999999994,207.65000000000001],"y":[83.349999999999994,207.65000000000001],"text":"intercept: 0<br />slope: 1","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[152.09999999999999,152.59999999999999,153.80000000000001,157,162.19999999999999,163.5,165.30000000000001,173.59999999999999,174.80000000000001,180.90000000000001,187.80000000000001,188.59999999999999,194.80000000000001,194.40000000000001,196,201.5],"y":[154.48266161073312,152.52611363597083,155.46699504277001,159.41152071199156,161.79765931642123,167.52558015778069,167.56517018439416,170.48749767960032,184.59326818230289,184.49518704032093,191.22939744547594,196.27270786895619,193.32465515949508,200.21027172706465,191.65924584183327,192.38862088522777],"text":["Actual: 152.1<br />Predicted: 154.48266<br />DataPartition: Test","Actual: 152.6<br />Predicted: 152.52611<br />DataPartition: Test","Actual: 153.8<br />Predicted: 155.46700<br />DataPartition: Test","Actual: 157.0<br />Predicted: 159.41152<br />DataPartition: Test","Actual: 162.2<br />Predicted: 161.79766<br />DataPartition: Test","Actual: 163.5<br />Predicted: 167.52558<br />DataPartition: Test","Actual: 165.3<br />Predicted: 167.56517<br />DataPartition: Test","Actual: 173.6<br />Predicted: 170.48750<br />DataPartition: Test","Actual: 174.8<br />Predicted: 184.59327<br />DataPartition: Test","Actual: 180.9<br />Predicted: 184.49519<br />DataPartition: Test","Actual: 187.8<br />Predicted: 191.22940<br />DataPartition: Test","Actual: 188.6<br />Predicted: 196.27271<br />DataPartition: Test","Actual: 194.8<br />Predicted: 193.32466<br />DataPartition: Test","Actual: 194.4<br />Predicted: 200.21027<br />DataPartition: Test","Actual: 196.0<br />Predicted: 191.65925<br />DataPartition: Test","Actual: 201.5<br />Predicted: 192.38862<br />DataPartition: Test"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":0.5,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Test","legendgroup":"Test","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[89.599999999999994,93.099999999999994,97.599999999999994,105.59999999999999,114.40000000000001,122.09999999999999,126.7,126.90000000000001,123.90000000000001,116.40000000000001,100,95.299999999999997,110.3,118.40000000000001,125.09999999999999,131.69999999999999,135.5,139.19999999999999,142.30000000000001,145.09999999999999,147,147.40000000000001,147.19999999999999,147.90000000000001,148.80000000000001,151.5,152.40000000000001,154,154.59999999999999,153.19999999999999,151.30000000000001,149.69999999999999,148.59999999999999,147,145.5,144.19999999999999,142.30000000000001,141.59999999999999,140.59999999999999,140,137.90000000000001,137.19999999999999,136.69999999999999,136.59999999999999,137.59999999999999,138.69999999999999,144.09999999999999,149,149.69999999999999,149.59999999999999,148.59999999999999,150.80000000000001,152.80000000000001,153.59999999999999],"y":[89.767501088133116,92.697186170696625,97.827423637034542,105.41206703943067,114.87384772080379,122.11434624248241,126.1087552182438,127.19546015717896,124.50963403218655,115.02056244862662,100.38279329373451,96.429620999592046,109.55033310654414,118.85801494609511,124.53615641686567,131.90231315259061,135.53073658123373,139.06151286310674,142.11456748773435,145.81411613186813,146.62933957278915,147.30392392370817,147.46825342351755,147.42168801886848,148.97088733383771,151.11399824331482,153.42820610516466,153.714137452534,153.94123064164935,153.54494629740208,151.23501371739505,150.0024911853213,148.39196560309662,146.96615322527776,145.43153545328582,144.16280775412665,142.56942663961192,141.28706840428819,141.07172995159914,139.57281149116903,137.92143000490142,137.40643819133132,136.26863121345548,136.77807359841572,137.25562737086221,140.47579321417646,142.17927884694339,148.93268850492802,150.94876198190056,148.73247236184901,149.97192163208217,149.76210862383078,152.28814196434965,154.03925102496584],"text":["Actual:  89.6<br />Predicted:  89.76750<br />DataPartition: Train","Actual:  93.1<br />Predicted:  92.69719<br />DataPartition: Train","Actual:  97.6<br />Predicted:  97.82742<br />DataPartition: Train","Actual: 105.6<br />Predicted: 105.41207<br />DataPartition: Train","Actual: 114.4<br />Predicted: 114.87385<br />DataPartition: Train","Actual: 122.1<br />Predicted: 122.11435<br />DataPartition: Train","Actual: 126.7<br />Predicted: 126.10876<br />DataPartition: Train","Actual: 126.9<br />Predicted: 127.19546<br />DataPartition: Train","Actual: 123.9<br />Predicted: 124.50963<br />DataPartition: Train","Actual: 116.4<br />Predicted: 115.02056<br />DataPartition: Train","Actual: 100.0<br />Predicted: 100.38279<br />DataPartition: Train","Actual:  95.3<br />Predicted:  96.42962<br />DataPartition: Train","Actual: 110.3<br />Predicted: 109.55033<br />DataPartition: Train","Actual: 118.4<br />Predicted: 118.85801<br />DataPartition: Train","Actual: 125.1<br />Predicted: 124.53616<br />DataPartition: Train","Actual: 131.7<br />Predicted: 131.90231<br />DataPartition: Train","Actual: 135.5<br />Predicted: 135.53074<br />DataPartition: Train","Actual: 139.2<br />Predicted: 139.06151<br />DataPartition: Train","Actual: 142.3<br />Predicted: 142.11457<br />DataPartition: Train","Actual: 145.1<br />Predicted: 145.81412<br />DataPartition: Train","Actual: 147.0<br />Predicted: 146.62934<br />DataPartition: Train","Actual: 147.4<br />Predicted: 147.30392<br />DataPartition: Train","Actual: 147.2<br />Predicted: 147.46825<br />DataPartition: Train","Actual: 147.9<br />Predicted: 147.42169<br />DataPartition: Train","Actual: 148.8<br />Predicted: 148.97089<br />DataPartition: Train","Actual: 151.5<br />Predicted: 151.11400<br />DataPartition: Train","Actual: 152.4<br />Predicted: 153.42821<br />DataPartition: Train","Actual: 154.0<br />Predicted: 153.71414<br />DataPartition: Train","Actual: 154.6<br />Predicted: 153.94123<br />DataPartition: Train","Actual: 153.2<br />Predicted: 153.54495<br />DataPartition: Train","Actual: 151.3<br />Predicted: 151.23501<br />DataPartition: Train","Actual: 149.7<br />Predicted: 150.00249<br />DataPartition: Train","Actual: 148.6<br />Predicted: 148.39197<br />DataPartition: Train","Actual: 147.0<br />Predicted: 146.96615<br />DataPartition: Train","Actual: 145.5<br />Predicted: 145.43154<br />DataPartition: Train","Actual: 144.2<br />Predicted: 144.16281<br />DataPartition: Train","Actual: 142.3<br />Predicted: 142.56943<br />DataPartition: Train","Actual: 141.6<br />Predicted: 141.28707<br />DataPartition: Train","Actual: 140.6<br />Predicted: 141.07173<br />DataPartition: Train","Actual: 140.0<br />Predicted: 139.57281<br />DataPartition: Train","Actual: 137.9<br />Predicted: 137.92143<br />DataPartition: Train","Actual: 137.2<br />Predicted: 137.40644<br />DataPartition: Train","Actual: 136.7<br />Predicted: 136.26863<br />DataPartition: Train","Actual: 136.6<br />Predicted: 136.77807<br />DataPartition: Train","Actual: 137.6<br />Predicted: 137.25563<br />DataPartition: Train","Actual: 138.7<br />Predicted: 140.47579<br />DataPartition: Train","Actual: 144.1<br />Predicted: 142.17928<br />DataPartition: Train","Actual: 149.0<br />Predicted: 148.93269<br />DataPartition: Train","Actual: 149.7<br />Predicted: 150.94876<br />DataPartition: Train","Actual: 149.6<br />Predicted: 148.73247<br />DataPartition: Train","Actual: 148.6<br />Predicted: 149.97192<br />DataPartition: Train","Actual: 150.8<br />Predicted: 149.76211<br />DataPartition: Train","Actual: 152.8<br />Predicted: 152.28814<br />DataPartition: Train","Actual: 153.6<br />Predicted: 154.03925<br />DataPartition: Train"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":0.5,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"Train","legendgroup":"Train","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":43.105022831050235},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Actual vs. Predicted Values","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[83.349999999999994,207.65000000000001],"tickmode":"array","ticktext":["90","120","150","180"],"tickvals":[90,120,150,180],"categoryorder":"array","categoryarray":["90","120","150","180"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Actual","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[83.349999999999994,207.65000000000001],"tickmode":"array","ticktext":["90","120","150","180"],"tickvals":[90,120,150,180],"categoryorder":"array","categoryarray":["90","120","150","180"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Predicted","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"DataPartition","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"51dc662222e6":{"intercept":{},"slope":{},"type":"scatter"},"51dc70737e6d":{"x":{},"y":{},"colour":{}}},"cur_data":"51dc662222e6","visdat":{"51dc662222e6":["function (y) ","x"],"51dc70737e6d":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p3b)   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-08affcb406ca092dc8e1" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-08affcb406ca092dc8e1">{"x":{"data":[{"x":[154.48266161073312,152.52611363597083,155.46699504277001,159.41152071199156,161.79765931642123,167.52558015778069,167.56517018439416,170.48749767960032,184.59326818230289,184.49518704032093,191.22939744547594,196.27270786895619,193.32465515949508,200.21027172706465,191.65924584183327,192.38862088522777],"y":[-2.3826616107331233,0.073886364029164042,-1.6669950427699973,-2.4115207119915567,0.40234068357875685,-4.0255801577806949,-2.265170184394151,3.1125023203996705,-9.7932681823028815,-3.5951870403209227,-3.429397445475928,-7.6727078689561949,1.4753448405049312,-5.8102717270646451,4.3407541581667317,9.1113791147722338],"text":["Predicted: 154.48266<br />Residuals: -2.38266161<br />DataPartition: Test","Predicted: 152.52611<br />Residuals:  0.07388636<br />DataPartition: Test","Predicted: 155.46700<br />Residuals: -1.66699504<br />DataPartition: Test","Predicted: 159.41152<br />Residuals: -2.41152071<br />DataPartition: Test","Predicted: 161.79766<br />Residuals:  0.40234068<br />DataPartition: Test","Predicted: 167.52558<br />Residuals: -4.02558016<br />DataPartition: Test","Predicted: 167.56517<br />Residuals: -2.26517018<br />DataPartition: Test","Predicted: 170.48750<br />Residuals:  3.11250232<br />DataPartition: Test","Predicted: 184.59327<br />Residuals: -9.79326818<br />DataPartition: Test","Predicted: 184.49519<br />Residuals: -3.59518704<br />DataPartition: Test","Predicted: 191.22940<br />Residuals: -3.42939745<br />DataPartition: Test","Predicted: 196.27271<br />Residuals: -7.67270787<br />DataPartition: Test","Predicted: 193.32466<br />Residuals:  1.47534484<br />DataPartition: Test","Predicted: 200.21027<br />Residuals: -5.81027173<br />DataPartition: Test","Predicted: 191.65925<br />Residuals:  4.34075416<br />DataPartition: Test","Predicted: 192.38862<br />Residuals:  9.11137911<br />DataPartition: Test"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Test","legendgroup":"Test","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[89.767501088133116,92.697186170696625,97.827423637034542,105.41206703943067,114.87384772080379,122.11434624248241,126.1087552182438,127.19546015717896,124.50963403218655,115.02056244862662,100.38279329373451,96.429620999592046,109.55033310654414,118.85801494609511,124.53615641686567,131.90231315259061,135.53073658123373,139.06151286310674,142.11456748773435,145.81411613186813,146.62933957278915,147.30392392370817,147.46825342351755,147.42168801886848,148.97088733383771,151.11399824331482,153.42820610516466,153.714137452534,153.94123064164935,153.54494629740208,151.23501371739505,150.0024911853213,148.39196560309662,146.96615322527776,145.43153545328582,144.16280775412665,142.56942663961192,141.28706840428819,141.07172995159914,139.57281149116903,137.92143000490142,137.40643819133132,136.26863121345548,136.77807359841572,137.25562737086221,140.47579321417646,142.17927884694339,148.93268850492802,150.94876198190056,148.73247236184901,149.97192163208217,149.76210862383078,152.28814196434965,154.03925102496584],"y":[-0.16750108813312181,0.40281382930336918,-0.22742363703454771,0.18793296056932718,-0.47384772080378923,-0.014346242482417892,0.59124478175620254,-0.29546015717895102,-0.60963403218654832,1.3794375513733854,-0.38279329373450821,-1.1296209995920492,0.7496668934558528,-0.45801494609510485,0.5638435831343287,-0.20231315259061944,-0.030736581233725246,0.13848713689324654,0.18543251226566326,-0.71411613186813838,0.37066042721085068,0.096076076291836898,-0.26825342351756376,0.47831198113152595,-0.1708873338376975,0.38600175668517522,-1.0282061051646565,0.28586254746599593,0.65876935835063932,-0.34494629740208893,0.064986282604962753,-0.30249118532131547,0.208034396903372,0.033846774722235295,0.068464546714182006,0.037192245873342245,-0.2694266396119076,0.3129315957118024,-0.47172995159914421,0.42718850883096593,-0.021430004901418442,-0.20643819133132979,0.43136878654451039,-0.17807359841572179,0.34437262913778,-1.7757932141764741,1.9207211530566042,0.067311495071976424,-1.2487619819005715,0.86752763815098888,-1.3719216320821772,1.0378913761692274,0.51185803565036281,-0.43925102496584145],"text":["Predicted:  89.76750<br />Residuals: -0.16750109<br />DataPartition: Train","Predicted:  92.69719<br />Residuals:  0.40281383<br />DataPartition: Train","Predicted:  97.82742<br />Residuals: -0.22742364<br />DataPartition: Train","Predicted: 105.41207<br />Residuals:  0.18793296<br />DataPartition: Train","Predicted: 114.87385<br />Residuals: -0.47384772<br />DataPartition: Train","Predicted: 122.11435<br />Residuals: -0.01434624<br />DataPartition: Train","Predicted: 126.10876<br />Residuals:  0.59124478<br />DataPartition: Train","Predicted: 127.19546<br />Residuals: -0.29546016<br />DataPartition: Train","Predicted: 124.50963<br />Residuals: -0.60963403<br />DataPartition: Train","Predicted: 115.02056<br />Residuals:  1.37943755<br />DataPartition: Train","Predicted: 100.38279<br />Residuals: -0.38279329<br />DataPartition: Train","Predicted:  96.42962<br />Residuals: -1.12962100<br />DataPartition: Train","Predicted: 109.55033<br />Residuals:  0.74966689<br />DataPartition: Train","Predicted: 118.85801<br />Residuals: -0.45801495<br />DataPartition: Train","Predicted: 124.53616<br />Residuals:  0.56384358<br />DataPartition: Train","Predicted: 131.90231<br />Residuals: -0.20231315<br />DataPartition: Train","Predicted: 135.53074<br />Residuals: -0.03073658<br />DataPartition: Train","Predicted: 139.06151<br />Residuals:  0.13848714<br />DataPartition: Train","Predicted: 142.11457<br />Residuals:  0.18543251<br />DataPartition: Train","Predicted: 145.81412<br />Residuals: -0.71411613<br />DataPartition: Train","Predicted: 146.62934<br />Residuals:  0.37066043<br />DataPartition: Train","Predicted: 147.30392<br />Residuals:  0.09607608<br />DataPartition: Train","Predicted: 147.46825<br />Residuals: -0.26825342<br />DataPartition: Train","Predicted: 147.42169<br />Residuals:  0.47831198<br />DataPartition: Train","Predicted: 148.97089<br />Residuals: -0.17088733<br />DataPartition: Train","Predicted: 151.11400<br />Residuals:  0.38600176<br />DataPartition: Train","Predicted: 153.42821<br />Residuals: -1.02820611<br />DataPartition: Train","Predicted: 153.71414<br />Residuals:  0.28586255<br />DataPartition: Train","Predicted: 153.94123<br />Residuals:  0.65876936<br />DataPartition: Train","Predicted: 153.54495<br />Residuals: -0.34494630<br />DataPartition: Train","Predicted: 151.23501<br />Residuals:  0.06498628<br />DataPartition: Train","Predicted: 150.00249<br />Residuals: -0.30249119<br />DataPartition: Train","Predicted: 148.39197<br />Residuals:  0.20803440<br />DataPartition: Train","Predicted: 146.96615<br />Residuals:  0.03384677<br />DataPartition: Train","Predicted: 145.43154<br />Residuals:  0.06846455<br />DataPartition: Train","Predicted: 144.16281<br />Residuals:  0.03719225<br />DataPartition: Train","Predicted: 142.56943<br />Residuals: -0.26942664<br />DataPartition: Train","Predicted: 141.28707<br />Residuals:  0.31293160<br />DataPartition: Train","Predicted: 141.07173<br />Residuals: -0.47172995<br />DataPartition: Train","Predicted: 139.57281<br />Residuals:  0.42718851<br />DataPartition: Train","Predicted: 137.92143<br />Residuals: -0.02143000<br />DataPartition: Train","Predicted: 137.40644<br />Residuals: -0.20643819<br />DataPartition: Train","Predicted: 136.26863<br />Residuals:  0.43136879<br />DataPartition: Train","Predicted: 136.77807<br />Residuals: -0.17807360<br />DataPartition: Train","Predicted: 137.25563<br />Residuals:  0.34437263<br />DataPartition: Train","Predicted: 140.47579<br />Residuals: -1.77579321<br />DataPartition: Train","Predicted: 142.17928<br />Residuals:  1.92072115<br />DataPartition: Train","Predicted: 148.93269<br />Residuals:  0.06731150<br />DataPartition: Train","Predicted: 150.94876<br />Residuals: -1.24876198<br />DataPartition: Train","Predicted: 148.73247<br />Residuals:  0.86752764<br />DataPartition: Train","Predicted: 149.97192<br />Residuals: -1.37192163<br />DataPartition: Train","Predicted: 149.76211<br />Residuals:  1.03789138<br />DataPartition: Train","Predicted: 152.28814<br />Residuals:  0.51185804<br />DataPartition: Train","Predicted: 154.03925<br />Residuals: -0.43925102<br />DataPartition: Train"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"Train","legendgroup":"Train","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[84.245362556186535,205.73241025901123],"y":[0,0],"text":"yintercept: 0","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":43.105022831050235},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Residual Plot","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[84.245362556186535,205.73241025901123],"tickmode":"array","ticktext":["90","120","150","180"],"tickvals":[90,120,150,180],"categoryorder":"array","categoryarray":["90","120","150","180"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Predicted","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-10.738500547156637,10.056611479625989],"tickmode":"array","ticktext":["-10","-5","0","5","10"],"tickvals":[-10,-5,0,5,10],"categoryorder":"array","categoryarray":["-10","-5","0","5","10"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Residuals","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"DataPartition","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"51dc1fec1f3f":{"x":{},"y":{},"colour":{},"type":"scatter"},"51dc1a614f60":{"yintercept":{}}},"cur_data":"51dc1fec1f3f","visdat":{"51dc1fec1f3f":["function (y) ","x"],"51dc1a614f60":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span> (printout)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Error</th>
<th style="text-align: right;">Train</th>
<th style="text-align: right;">Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">RMSE</td>
<td style="text-align: right;">0.6429573</td>
<td style="text-align: right;">4.76132</td>
</tr>
<tr class="even">
<td style="text-align: left;">MAE</td>
<td style="text-align: right;">0.4742899</td>
<td style="text-align: right;">3.84806</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p3c)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-1dc1b82509cd26d06e41" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-1dc1b82509cd26d06e41">{"x":{"data":[{"x":[13027,13118,13208,13300,13392,13483,13573,13665,13757,13848,13939,14031,14123,14214,14304,14396,14488,14579,14669,14761,14853,14944,15034,15126,15218,15309,15400,15492,15584,15675,15765,15857,15949,16040,16130,16222,16314,16405,16495,16587,16679,16770,16861,16953,17045,17136,17226,17318,17410,17501,17591,17683,17775,17866,17956,18048,18140,18231,18322,18414,18506,18597,18687,18779,18871,18962,19052,19144,19236,19327,19417,19509,19601,19692],"y":[83.299999999999997,84.5,85.799999999999997,87.299999999999997,89.599999999999994,93.099999999999994,97.599999999999994,105.59999999999999,114.40000000000001,122.09999999999999,126.7,126.90000000000001,123.90000000000001,116.40000000000001,100,95.299999999999997,110.3,118.40000000000001,125.09999999999999,131.69999999999999,135.5,139.19999999999999,142.30000000000001,145.09999999999999,147,147.40000000000001,147.19999999999999,147.90000000000001,148.80000000000001,151.5,152.40000000000001,154,154.59999999999999,153.19999999999999,151.30000000000001,149.69999999999999,148.59999999999999,147,145.5,144.19999999999999,142.30000000000001,141.59999999999999,140.59999999999999,140,137.90000000000001,137.19999999999999,136.69999999999999,136.59999999999999,137.59999999999999,138.69999999999999,144.09999999999999,149,149.69999999999999,149.59999999999999,148.59999999999999,150.80000000000001,152.80000000000001,153.59999999999999,152.09999999999999,152.59999999999999,153.80000000000001,157,162.19999999999999,163.5,165.30000000000001,173.59999999999999,174.80000000000001,180.90000000000001,187.80000000000001,188.59999999999999,194.80000000000001,194.40000000000001,196,201.5],"text":["Date: 2005-09-01<br />dependentVariable:  83.3","Date: 2005-12-01<br />dependentVariable:  84.5","Date: 2006-03-01<br />dependentVariable:  85.8","Date: 2006-06-01<br />dependentVariable:  87.3","Date: 2006-09-01<br />dependentVariable:  89.6","Date: 2006-12-01<br />dependentVariable:  93.1","Date: 2007-03-01<br />dependentVariable:  97.6","Date: 2007-06-01<br />dependentVariable: 105.6","Date: 2007-09-01<br />dependentVariable: 114.4","Date: 2007-12-01<br />dependentVariable: 122.1","Date: 2008-03-01<br />dependentVariable: 126.7","Date: 2008-06-01<br />dependentVariable: 126.9","Date: 2008-09-01<br />dependentVariable: 123.9","Date: 2008-12-01<br />dependentVariable: 116.4","Date: 2009-03-01<br />dependentVariable: 100.0","Date: 2009-06-01<br />dependentVariable:  95.3","Date: 2009-09-01<br />dependentVariable: 110.3","Date: 2009-12-01<br />dependentVariable: 118.4","Date: 2010-03-01<br />dependentVariable: 125.1","Date: 2010-06-01<br />dependentVariable: 131.7","Date: 2010-09-01<br />dependentVariable: 135.5","Date: 2010-12-01<br />dependentVariable: 139.2","Date: 2011-03-01<br />dependentVariable: 142.3","Date: 2011-06-01<br />dependentVariable: 145.1","Date: 2011-09-01<br />dependentVariable: 147.0","Date: 2011-12-01<br />dependentVariable: 147.4","Date: 2012-03-01<br />dependentVariable: 147.2","Date: 2012-06-01<br />dependentVariable: 147.9","Date: 2012-09-01<br />dependentVariable: 148.8","Date: 2012-12-01<br />dependentVariable: 151.5","Date: 2013-03-01<br />dependentVariable: 152.4","Date: 2013-06-01<br />dependentVariable: 154.0","Date: 2013-09-01<br />dependentVariable: 154.6","Date: 2013-12-01<br />dependentVariable: 153.2","Date: 2014-03-01<br />dependentVariable: 151.3","Date: 2014-06-01<br />dependentVariable: 149.7","Date: 2014-09-01<br />dependentVariable: 148.6","Date: 2014-12-01<br />dependentVariable: 147.0","Date: 2015-03-01<br />dependentVariable: 145.5","Date: 2015-06-01<br />dependentVariable: 144.2","Date: 2015-09-01<br />dependentVariable: 142.3","Date: 2015-12-01<br />dependentVariable: 141.6","Date: 2016-03-01<br />dependentVariable: 140.6","Date: 2016-06-01<br />dependentVariable: 140.0","Date: 2016-09-01<br />dependentVariable: 137.9","Date: 2016-12-01<br />dependentVariable: 137.2","Date: 2017-03-01<br />dependentVariable: 136.7","Date: 2017-06-01<br />dependentVariable: 136.6","Date: 2017-09-01<br />dependentVariable: 137.6","Date: 2017-12-01<br />dependentVariable: 138.7","Date: 2018-03-01<br />dependentVariable: 144.1","Date: 2018-06-01<br />dependentVariable: 149.0","Date: 2018-09-01<br />dependentVariable: 149.7","Date: 2018-12-01<br />dependentVariable: 149.6","Date: 2019-03-01<br />dependentVariable: 148.6","Date: 2019-06-01<br />dependentVariable: 150.8","Date: 2019-09-01<br />dependentVariable: 152.8","Date: 2019-12-01<br />dependentVariable: 153.6","Date: 2020-03-01<br />dependentVariable: 152.1","Date: 2020-06-01<br />dependentVariable: 152.6","Date: 2020-09-01<br />dependentVariable: 153.8","Date: 2020-12-01<br />dependentVariable: 157.0","Date: 2021-03-01<br />dependentVariable: 162.2","Date: 2021-06-01<br />dependentVariable: 163.5","Date: 2021-09-01<br />dependentVariable: 165.3","Date: 2021-12-01<br />dependentVariable: 173.6","Date: 2022-03-01<br />dependentVariable: 174.8","Date: 2022-06-01<br />dependentVariable: 180.9","Date: 2022-09-01<br />dependentVariable: 187.8","Date: 2022-12-01<br />dependentVariable: 188.6","Date: 2023-03-01<br />dependentVariable: 194.8","Date: 2023-06-01<br />dependentVariable: 194.4","Date: 2023-09-01<br />dependentVariable: 196.0","Date: 2023-12-01<br />dependentVariable: 201.5"],"type":"scatter","mode":"lines","line":{"width":2.6456692913385824,"color":"rgba(0,255,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[18322,18414,18506,18597,18687,18779,18871,18962,19052,19144,19236,19327,19417,19509,19601,19692],"y":[154.48266161073312,152.52611363597083,155.46699504277001,159.41152071199156,161.79765931642123,167.52558015778069,167.56517018439416,170.48749767960032,184.59326818230289,184.49518704032093,191.22939744547594,196.27270786895619,193.32465515949508,200.21027172706465,191.65924584183327,192.38862088522777],"text":["Date: 2020-03-01<br />Predicted: 154.4827<br />DataPartition: Test","Date: 2020-06-01<br />Predicted: 152.5261<br />DataPartition: Test","Date: 2020-09-01<br />Predicted: 155.4670<br />DataPartition: Test","Date: 2020-12-01<br />Predicted: 159.4115<br />DataPartition: Test","Date: 2021-03-01<br />Predicted: 161.7977<br />DataPartition: Test","Date: 2021-06-01<br />Predicted: 167.5256<br />DataPartition: Test","Date: 2021-09-01<br />Predicted: 167.5652<br />DataPartition: Test","Date: 2021-12-01<br />Predicted: 170.4875<br />DataPartition: Test","Date: 2022-03-01<br />Predicted: 184.5933<br />DataPartition: Test","Date: 2022-06-01<br />Predicted: 184.4952<br />DataPartition: Test","Date: 2022-09-01<br />Predicted: 191.2294<br />DataPartition: Test","Date: 2022-12-01<br />Predicted: 196.2727<br />DataPartition: Test","Date: 2023-03-01<br />Predicted: 193.3247<br />DataPartition: Test","Date: 2023-06-01<br />Predicted: 200.2103<br />DataPartition: Test","Date: 2023-09-01<br />Predicted: 191.6592<br />DataPartition: Test","Date: 2023-12-01<br />Predicted: 192.3886<br />DataPartition: Test"],"type":"scatter","mode":"lines","line":{"width":2.6456692913385824,"color":"rgba(248,118,109,1)","dash":"dot"},"hoveron":"points","name":"Test","legendgroup":"Test","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":43.105022831050235},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Time Series of Quarterly Price Index (Actual index in green)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[12693.75,20025.25],"tickmode":"array","ticktext":["2005","2010","2015","2020"],"tickvals":[12784,14610,16436,18262],"categoryorder":"array","categoryarray":["2005","2010","2015","2020"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[77.390000000000001,207.41],"tickmode":"array","ticktext":["100","125","150","175","200"],"tickvals":[100,125,150,175,200],"categoryorder":"array","categoryarray":["100","125","150","175","200"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Price Index","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"DataPartition","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"51dc7f0d35eb":{"x":{},"y":{},"type":"scatter"},"51dc30f017b7":{"x":{},"y":{},"colour":{}}},"cur_data":"51dc7f0d35eb","visdat":{"51dc7f0d35eb":["function (y) ","x"],"51dc30f017b7":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="ui-design" class="level1">
<h1>4 UI Design</h1>
<section id="storyboard-and-ui-design-for-random-forest-module" class="level2">
<h2 class="anchored" data-anchor-id="storyboard-and-ui-design-for-random-forest-module">4.1 Storyboard and UI Design for Random Forest module</h2>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Selection of Shiny UI components for parameter inputs
</div>
</div>
<div class="callout-body-container callout-body">
<p>UI components for parameter inputs are:</p>
<ul>
<li>Variables selection
<ul>
<li>Type of data to use for prediction - Use <strong>Toggle Input</strong> to toggle between actual indices and derived percentage change</li>
<li>Forecast from which year - Use <strong>Slider Input</strong>, values from 2018 to 2022</li>
<li>Explanatory variables - Use <strong>Select Input</strong> to choose from a pre-defined list</li>
<li>Which property price index to forecast - Use <strong>Select Input</strong> to choose from a pre-defined list</li>
</ul></li>
<li>Model parameters
<ul>
<li>Number of trees (mtree) - Use <strong>Slider Input</strong>, values from 100 to 500</li>
<li>Number of variables sampled for each tree (mtry) - Use <strong>Slider Input,</strong> values from 2 to 8</li>
<li>Maximal size of terminal nodes in each tree (nodesize) - Use <strong>Slider Input,</strong> values from 1 to 8</li>
</ul></li>
<li><strong>Submit Button</strong> for user to run the model with the inputs selected</li>
</ul>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Tab 1 - Model Result</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Tab 2 - Variable Importance</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Tab 3 - Time Series</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p><img src="images/clipboard-4084086158.png" class="img-fluid"></p>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p><img src="images/clipboard-3611799609.png" class="img-fluid"></p>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<p><img src="images/clipboard-3886939445.png" class="img-fluid"></p>
</div>
</div>
</div>
</section>
<section id="storyboard-and-ui-design-for-gradient-boost-module" class="level2">
<h2 class="anchored" data-anchor-id="storyboard-and-ui-design-for-gradient-boost-module">4.2 Storyboard and UI Design for Gradient Boost module</h2>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Selection of Shiny UI components for parameter inputs
</div>
</div>
<div class="callout-body-container callout-body">
<p>UI components for parameter inputs are:</p>
<ul>
<li>Variables selection
<ul>
<li>Type of data to use for prediction - Use <strong>Toggle Input</strong> to toggle between actual indices and derived percentage change</li>
<li>Forecast from which year - Use <strong>Slider Input</strong>, values from 2018 to 2022</li>
<li>Explanatory variables - Use <strong>Select Input</strong> to choose from a pre-defined list</li>
<li>Which property price index to forecast - Use <strong>Select Input</strong> to choose from a pre-defined list</li>
</ul></li>
<li>Model parameters
<ul>
<li>Number of trees (n.trees) - Use <strong>Slider Input</strong>, values from 100 to 500</li>
<li>Learning rate (shrinkage) - Use <strong>Slider Input</strong>, values from 0.01 to 0.1</li>
<li>Minimum number of observations in terminal node (n.minobsinnode) - Use <strong>Slider Input</strong>, values from 5 to 10</li>
<li>Fraction of observations sampled for each tree (bag.fraction) - Use <strong>Slider Input</strong>, values from 0.5 to 1.0</li>
<li>Distribution to use - Use <strong>Select Input</strong> to choose from ‘gaussian’, ‘laplace’ or ‘tdist’ for regression models</li>
</ul></li>
<li><strong>Submit Button</strong> for user to run the model with the inputs selected</li>
</ul>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Tab 1 - Model Result</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Tab 2 - Time Series</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p><img src="images/clipboard-6047130.png" class="img-fluid"></p>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p><img src="images/clipboard-3922706272.png" class="img-fluid">&nbsp;</p>
</div>
</div>
</div>
</section>
<section id="storyboard-and-ui-design-for-prophet-module" class="level2">
<h2 class="anchored" data-anchor-id="storyboard-and-ui-design-for-prophet-module">4.3 Storyboard and UI Design for Prophet module</h2>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Selection of Shiny UI components for parameter inputs
</div>
</div>
<div class="callout-body-container callout-body">
<p>UI components for parameter inputs are:</p>
<ul>
<li>Variables selection
<ul>
<li>Type of data to use for prediction - Use <strong>Toggle Input</strong> to toggle between actual indices and derived percentage change</li>
<li>Forecast from which year - Use <strong>Slider Input</strong>, values from 2018 to 2022</li>
<li>Explanatory variables - Use <strong>Select Input</strong> to choose from a pre-defined list</li>
<li>Which property price index to forecast - Use <strong>Select Input</strong> to choose from a pre-defined list</li>
</ul></li>
<li>Model parameters
<ul>
<li>Mode for handling seasonalities (seasonality.mode) - Use <strong>Select Input</strong> to choose from additive’ (default) or ‘multiplicative’</li>
<li>Growth modeling (growth) - Use <strong>Select Input</strong> to choose from ‘linear’, ‘logistic’, ‘flat’</li>
<li>Fit yearly seasonality (yearly.seasonality) - Use <strong>Select Input</strong> to choose from values ‘auto’, TRUE, FALSE</li>
</ul></li>
<li><strong>Submit Button</strong> for user to run the model with the inputs selected</li>
</ul>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Tab 1 - Model Result</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Tab 2 - Time Series</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p><img src="images/clipboard-3667159418.png" class="img-fluid"></p>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<p><img src="images/clipboard-374491442.png" class="img-fluid"></p>
</div>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level1">
<h1>5 Conclusion</h1>
<p>Through this prototyping exercise, I have managed to identify the necessary R packages needed to build the forecasting models, and used them to build the prototype models. Furthermore, I had also determined the model variables and parameters that will be exposed for users to choose from, as well as identified useful outputs in terms of plots that will be presented to the user on the R Shiny application subsequently. The appropriate Shiny UI components were also identified, following these principles of (1) using a toggle for toggling between 2 values, (2) using a select list where users should choose from a pre-defined list, and (3) using a slider bar for range of numerical values.</p>
<p>All in all, the codes are ready to be integrated into a R Shiny App, and through this, I have experienced the usefulness of prototyping in application development.</p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Copyright 2024</div>
  </div>
</footer>



</body></html>